<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"islet.space","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.7.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>
<meta name="description" content="[TOC] TERMINOLOGY Processors &#x2F; Microcontrollers &#x2F; DSP 以下是ADI官方对Processors、Microcontrollers、DSP 等词的解释：     Harvard Architecture，即哈佛结构，是一种将程序指令存储和数据存储分开的存储器结构。哈佛结构是一种并行体系结构，它的主要特点是将程序和数据存储在不同的存储空间中，即程序存">
<meta property="og:type" content="article">
<meta property="og:title" content="ADI开发笔记">
<meta property="og:url" content="http://islet.space/2021/04/23/Hardware/DSP/2021-04-23-ADI%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="Coder的孤岛">
<meta property="og:description" content="[TOC] TERMINOLOGY Processors &#x2F; Microcontrollers &#x2F; DSP 以下是ADI官方对Processors、Microcontrollers、DSP 等词的解释：     Harvard Architecture，即哈佛结构，是一种将程序指令存储和数据存储分开的存储器结构。哈佛结构是一种并行体系结构，它的主要特点是将程序和数据存储在不同的存储空间中，即程序存">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://pic.islet.space/2021/05/image-20210501094933998.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/image-20210501094947031.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/image-20210501094923111.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/image-20210501095225573.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/20210520135658.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/20210520135659.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/image-20210518114358905.png">
<meta property="og:image" content="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/algorithmpic1.png">
<meta property="og:image" content="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/algorithmpic2.png">
<meta property="og:image" content="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/algorithmpic3.png">
<meta property="og:image" content="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/algorithmpic4.png">
<meta property="og:image" content="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/algorithmpic5.png">
<meta property="og:image" content="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/icon.png">
<meta property="og:image" content="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/wirespic1.png">
<meta property="og:image" content="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/wirespic2.png">
<meta property="og:image" content="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/wirespic3.png">
<meta property="og:image" content="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/wirespic4.png">
<meta property="og:image" content="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/wirespic5.png">
<meta property="og:image" content="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/wirespic6.png">
<meta property="og:image" content="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/wirespic7.png">
<meta property="og:image" content="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/wirespic8.png">
<meta property="og:image" content="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/developmentenvironment/hardwareconfpic1.png">
<meta property="og:image" content="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/developmentenvironment/hardwareconfpic2.png">
<meta property="og:image" content="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/developmentenvironment/hardwareconfpic3.png">
<meta property="og:image" content="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/developmentenvironment/hardwareconfpic4.png">
<meta property="og:image" content="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/developmentenvironment/hardwareconfpic5.png">
<meta property="og:image" content="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/toolbox/io/asrc_input_output_020.jpg">
<meta property="og:image" content="https://pic.islet.space/2021/04/image-20210428152357233.png">
<meta property="og:image" content="https://pic.islet.space/2021/04/image-20210422165857465.png">
<meta property="og:image" content="https://pic.islet.space/2021/04/image-20210422163633005.png">
<meta property="og:image" content="https://pic.islet.space/2021/04/image-20210422163804275.png">
<meta property="og:image" content="https://pic.islet.space/2021/04/image-20210422163228410.png">
<meta property="og:image" content="https://pic.islet.space/2021/04/image-20210422170248954.png">
<meta property="og:image" content="https://pic.islet.space/2021/04/image-20210422170328013.png">
<meta property="og:image" content="https://pic.islet.space/2021/04/048f07ee-e357-4c06-a8e4-1724e62765a4_1.e937ba0bd42739fc09e9ef63602645b8.jpeg">
<meta property="og:image" content="https://pic.islet.space/2021/04/R68f2db356a43d3653db1298ccd26e835">
<meta property="og:image" content="https://pic.islet.space/2021/04/image-20210423102647330.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/image-20210510084234044.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/image-20210510091831286.png">
<meta property="og:image" content="https://pic.islet.space/2021/06/20210601105542.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/image-20210510093228165.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/image-20210510091150821.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/image-20210510085052186.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/image-20210510085331956.png">
<meta property="og:image" content="https://pic.islet.space/2021/06/20210601105550.png">
<meta property="og:image" content="https://pic.islet.space/2021/06/20210601105615.png">
<meta property="og:image" content="https://pic.islet.space/2021/04/image-20210428150645112.png">
<meta property="og:image" content="https://pic.islet.space/2021/04/image-20210427110916316.png">
<meta property="og:image" content="https://pic.islet.space/2021/04/image-20210427162529600.png">
<meta property="og:image" content="https://pic.islet.space/2021/04/image-20210427111013493.png">
<meta property="og:image" content="https://pic.islet.space/2021/04/image-20210427171901213.png">
<meta property="og:image" content="https://pic.islet.space/2021/04/Snipaste_2021-04-27_17-18-01.png">
<meta property="og:image" content="https://pic.islet.space/2021/04/Snipaste_2021-04-27_17-18-18.png">
<meta property="og:image" content="https://pic.islet.space/2021/04/image-20210427152251539.png">
<meta property="og:image" content="https://pic.islet.space/2021/04/image-20210427143628880.png">
<meta property="og:image" content="https://pic.islet.space/2021/04/image-20210427153425633.png">
<meta property="og:image" content="https://pic.islet.space/2021/04/image-20210427152528194.png">
<meta property="og:image" content="https://pic.islet.space/2021/04/image-20210427110159648.png">
<meta property="og:image" content="https://pic.islet.space/2021/04/image-20210427144110884.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/image-20210519104127472.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/20210519110546.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/20210519110551.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/image-20210519105525684.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/20210519111130.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/20210519112440.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/20210520110351.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/20210520110355.png">
<meta property="og:image" content="https://pic.islet.space/2021/06/20210601105459.png">
<meta property="og:image" content="https://pic.islet.space/2021/06/20210612111612.png">
<meta property="og:image" content="https://pic.islet.space/2021/06/20210612111852.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/20210520113348.png">
<meta property="og:image" content="https://pic.islet.space/2021/06/20210611170206.png">
<meta property="og:image" content="https://pic.islet.space/2021/06/20210611170307.png">
<meta property="og:image" content="https://pic.islet.space/2021/06/20210611170344.png">
<meta property="og:image" content="https://pic.islet.space/2021/06/20210611170357.png">
<meta property="og:image" content="https://pic.islet.space/2021/06/20210621154021.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/image-20210428094527305.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/image-20210506150111553.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/image-20210506145903478.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/image-20210506150230833.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/image-20210428095433721.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/image-20210506144919655.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/image-20210506145534521.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/image-20210506150516695.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/image-20210506151533990.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/image-20210513100438475.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/image-20210513100800163.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/image-20210513100908671.png">
<meta property="og:image" content="https://pic.islet.space/2021/05/20210520095649.png">
<meta property="og:image" content="https://pic.islet.space/2021/06/20210623161904.png">
<meta property="og:image" content="https://pic.islet.space/2021/06/20210623161909.png">
<meta property="og:image" content="https://pic.islet.space/2021/06/20210623161911.png">
<meta property="og:image" content="https://pic.islet.space/2021/06/20210623161914.png">
<meta property="article:published_time" content="2021-04-23T15:58:32.000Z">
<meta property="article:modified_time" content="2021-07-08T14:41:04.190Z">
<meta property="article:author" content="Liewzheng">
<meta property="article:tag" content="ADI">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pic.islet.space/2021/05/image-20210501094933998.png">


<link rel="canonical" href="http://islet.space/2021/04/23/Hardware/DSP/2021-04-23-ADI%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://islet.space/2021/04/23/Hardware/DSP/2021-04-23-ADI%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0/","path":"2021/04/23/Hardware/DSP/2021-04-23-ADI开发笔记/","title":"ADI开发笔记"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>ADI开发笔记 | Coder的孤岛</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Coder的孤岛</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">islet of the coder</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-首页"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-文章"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>文章</a></li>
        <li class="menu-item menu-item-目录"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>目录</a></li>
        <li class="menu-item menu-item-标签"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-简历"><a href="/resume/" rel="section"><i class="fa fa-address-card fa-fw"></i>简历</a></li>
        <li class="menu-item menu-item-友链"><a href="/friends/" rel="section"><i class="fa fa-group fa-fw"></i>友链</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#terminology"><span class="nav-number">1.</span> <span class="nav-text">TERMINOLOGY</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#processors-microcontrollers-dsp"><span class="nav-number">1.1.</span> <span class="nav-text">Processors &#x2F; Microcontrollers &#x2F; DSP</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#why-floating-point-dsp"><span class="nav-number">1.1.1.</span> <span class="nav-text">Why Floating-Point DSP?</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#blackfin-sharc"><span class="nav-number">1.2.</span> <span class="nav-text">BLACKFIN &#x2F; SHARC</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#basic-knowledge"><span class="nav-number">2.</span> <span class="nav-text">BASIC KNOWLEDGE</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#usbi"><span class="nav-number">2.1.</span> <span class="nav-text">USBi</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#algorithms-addremove-growreduce"><span class="nav-number">2.2.</span> <span class="nav-text">Algorithms: Add&#x2F;Remove, Grow&#x2F;Reduce</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#wires-and-aliases"><span class="nav-number">2.2.1.</span> <span class="nav-text">Wires and Aliases</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#hardware-configuration-tab"><span class="nav-number">2.2.2.</span> <span class="nav-text">Hardware Configuration Tab</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#digital-attenuator"><span class="nav-number">2.3.</span> <span class="nav-text">Digital Attenuator</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#asrc"><span class="nav-number">2.4.</span> <span class="nav-text">ASRC</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#asrc-inputoutput"><span class="nav-number">2.4.1.</span> <span class="nav-text">ASRC INPUT&#x2F;OUTPUT</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#limiter-%E9%99%90%E5%B9%85%E5%99%A8"><span class="nav-number">2.5.</span> <span class="nav-text">Limiter 限幅器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#lsb-aligned"><span class="nav-number">2.6.</span> <span class="nav-text">LSB-aligned</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#cofficient-write"><span class="nav-number">2.7.</span> <span class="nav-text">Cofficient Write</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#filters"><span class="nav-number">2.8.</span> <span class="nav-text">Filters</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#sigmastudio"><span class="nav-number">3.</span> <span class="nav-text">SigmaStudio</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#capture"><span class="nav-number">3.1.</span> <span class="nav-text">Capture</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#register-control"><span class="nav-number">3.2.</span> <span class="nav-text">Register Control</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#outputserial-port"><span class="nav-number">3.2.1.</span> <span class="nav-text">Output&#x2F;Serial Port</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8B%E5%8E%8B%E5%BC%8F%E9%9F%B3%E9%87%8F%E6%8C%89%E9%94%AE"><span class="nav-number">3.2.1.1.</span> <span class="nav-text">下压式音量按键</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#download-program"><span class="nav-number">3.3.</span> <span class="nav-text">Download Program</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#microphone"><span class="nav-number">3.4.</span> <span class="nav-text">Microphone</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#bias-setting"><span class="nav-number">3.4.1.</span> <span class="nav-text">Bias Setting</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%B1dsp%E5%90%AF%E5%8A%A81772"><span class="nav-number">3.5.</span> <span class="nav-text">由DSP启动1772</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E8%BF%87%E5%AF%BC%E5%87%BA%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6%E7%9A%84%E6%96%B9%E5%BC%8F"><span class="nav-number">3.5.1.</span> <span class="nav-text">通过导出系统文件的方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E8%BF%87%E5%86%99%E5%85%A5%E5%AF%84%E5%AD%98%E5%99%A8%E7%9A%84%E6%96%B9%E5%BC%8F"><span class="nav-number">3.5.2.</span> <span class="nav-text">通过写入寄存器的方式</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#chip-adau1772"><span class="nav-number">4.</span> <span class="nav-text">CHIP-ADAU1772</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#i2s%E5%8F%8Ai2c%E6%8E%A5%E5%8F%A3"><span class="nav-number">4.1.</span> <span class="nav-text">I2S及I2C接口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#usbi-%E4%BB%BF%E7%9C%9F%E5%99%A8"><span class="nav-number">4.2.</span> <span class="nav-text">USBi 仿真器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E8%AF%91%E7%83%A7%E5%BD%95"><span class="nav-number">4.2.1.</span> <span class="nav-text">编译烧录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8A%AF%E7%89%87"><span class="nav-number">4.2.2.</span> <span class="nav-text">芯片</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#u2-eeprom"><span class="nav-number">4.2.2.1.</span> <span class="nav-text">U2: EEPROM</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E6%8E%A7%E5%88%B6"><span class="nav-number">4.3.</span> <span class="nav-text">输入输出控制</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BE%9B%E7%94%B5%E7%94%B5%E5%8E%8B"><span class="nav-number">4.3.1.</span> <span class="nav-text">供电电压</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#hp%E8%BE%93%E5%87%BA"><span class="nav-number">4.4.</span> <span class="nav-text">HP输出</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BE%93%E5%87%BA%E9%9D%99%E9%9F%B3"><span class="nav-number">4.4.1.</span> <span class="nav-text">输出静音</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BE%93%E5%87%BA%E6%96%AD%E7%94%B5"><span class="nav-number">4.4.2.</span> <span class="nav-text">输出断电</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BE%93%E5%87%BA%E9%9F%B3%E9%87%8F%E6%8E%A7%E5%88%B6"><span class="nav-number">4.4.3.</span> <span class="nav-text">输出音量控制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#talkthru-dsp-bypass"><span class="nav-number">4.4.4.</span> <span class="nav-text">TALKTHRU &#x2F; DSP BYPASS</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#chip-adsp21479"><span class="nav-number">5.</span> <span class="nav-text">CHIP-ADSP21479</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%8A%AF%E7%89%87%E5%8F%8A%E8%AF%84%E4%BC%B0%E6%9D%BF%E8%B5%84%E6%96%99"><span class="nav-number">5.1.</span> <span class="nav-text">芯片及评估板资料</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%BF%E7%9C%9F%E5%99%A8%E9%85%8D%E7%BD%AE"><span class="nav-number">5.2.</span> <span class="nav-text">仿真器配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#hpusb-jtag%E6%A8%A1%E5%BC%8F"><span class="nav-number">5.2.1.</span> <span class="nav-text">HPUSB JTAG模式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#i2ctwi%E4%B8%B2%E8%A1%8C%E9%80%9A%E4%BF%A1"><span class="nav-number">5.3.</span> <span class="nav-text">I2C&#x2F;TWI串行通信</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#dai%E6%8E%A5%E5%8F%A3"><span class="nav-number">5.4.</span> <span class="nav-text">DAI接口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#dpi%E6%8E%A5%E5%8F%A3"><span class="nav-number">5.5.</span> <span class="nav-text">DPI接口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sru.h"><span class="nav-number">5.6.</span> <span class="nav-text">SRU.H</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#sru"><span class="nav-number">5.6.1.</span> <span class="nav-text">SRU()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sru_field"><span class="nav-number">5.6.2.</span> <span class="nav-text">sru_field()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sru_mask"><span class="nav-number">5.6.3.</span> <span class="nav-text">sru_mask()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B"><span class="nav-number">5.6.4.</span> <span class="nav-text">示例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9A%E6%97%B6%E5%99%A8"><span class="nav-number">5.7.</span> <span class="nav-text">定时器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E5%AE%9A%E6%97%B6%E5%99%A8"><span class="nav-number">5.7.1.</span> <span class="nav-text">创建定时器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E6%97%B6%E5%99%A8%E4%B8%AD%E6%96%AD%E5%8F%A5%E6%9F%84"><span class="nav-number">5.7.2.</span> <span class="nav-text">定时器中断句柄</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#examples"><span class="nav-number">6.</span> <span class="nav-text">EXAMPLES</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#exp1"><span class="nav-number">6.1.</span> <span class="nav-text">EXP1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#exp2"><span class="nav-number">6.2.</span> <span class="nav-text">EXP2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#exp3"><span class="nav-number">6.3.</span> <span class="nav-text">EXP3</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#arduino%E7%A4%BA%E4%BE%8B"><span class="nav-number">6.3.1.</span> <span class="nav-text">Arduino示例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E5%88%86%E6%9E%90%E4%BB%AA"><span class="nav-number">6.3.2.</span> <span class="nav-text">数字逻辑分析仪</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Liewzheng</p>
  <div class="site-description" itemprop="description">笔记分享的旮旯孤岛而已</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">99</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">183</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="mailto:liewzheng@foxmail.com" title="E-Mail → mailto:liewzheng@foxmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i></a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://islet.space/2021/04/23/Hardware/DSP/2021-04-23-ADI%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liewzheng">
      <meta itemprop="description" content="笔记分享的旮旯孤岛而已">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder的孤岛">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          ADI开发笔记
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">

    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-04-23 23:58:32" itemprop="dateCreated datePublished" datetime="2021-04-23T23:58:32+08:00">2021-04-23</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-07-08 22:41:04" itemprop="dateModified" datetime="2021-07-08T22:41:04+08:00">2021-07-08</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Hardware/" itemprop="url" rel="index"><span itemprop="name">Hardware</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>[TOC]</p>
<h1 id="terminology">TERMINOLOGY</h1>
<h2 id="processors-microcontrollers-dsp">Processors / Microcontrollers / DSP</h2>
<p>以下是ADI官方对Processors、Microcontrollers、DSP 等词的解释：</p>
<p><img src="https://pic.islet.space/2021/05/image-20210501094933998.png" alt="image-20210501094933998" style="zoom: 80%;" /></p>
<p><img src="https://pic.islet.space/2021/05/image-20210501094947031.png" alt="image-20210501094947031" style="zoom: 80%;" /></p>
<p><img src="https://pic.islet.space/2021/05/image-20210501094923111.png" alt="image-20210501094923111" style="zoom: 80%;" /></p>
<p><img src="https://pic.islet.space/2021/05/image-20210501095225573.png" alt="image-20210501095225573" style="zoom: 80%;" /></p>
<p><strong>Harvard Architecture</strong>，即哈佛结构，是一种将程序指令存储和数据存储分开的存储器结构。哈佛结构是一种并行体系结构，它的主要特点是将程序和数据存储在不同的存储空间中，即程序存储器和数据存储器是两个独立的存储器，每个存储器独立编址、独立访问。</p>
<p><strong>Super Harvard Architecture</strong>（超级哈佛架构，SHARC），由ADI开发，具体解释见下方 BLACKFIN / SHARC。</p>
<h3 id="why-floating-point-dsp">Why Floating-Point DSP?</h3>
<blockquote>
<p>A digital signal processor’s data format determines its ability to handle signals of <em>differing precision</em>, <em>dynamic range</em>, and <em>signal-to-noise ratios</em>. Because floating-point DSP math reduces the need for scaling and probability of overflow, <mark>using a floating-point DSP can ease algorithm and software development</mark>. The extent to which this is true depends on the floating-point processor’s architecture.</p>
<p><u>Consistency with IEEE workstation simulations and the elimination of scaling are two clear ease-of-use advantages.</u> High-level language programmability, large address spaces, and wide dynamic range allow system development time to be spent on algorithms and signal processing concerns, rather than assembly language coding, code paging, and error handling.</p>
<p><em>--&lt;ADSP-21160 SHARC® DSP Hardware Reference&gt;</em></p>
</blockquote>
<p>总结一下就是：</p>
<ul>
<li>(The data format is) <strong>Suitable to handle various kind of task</strong> (like <em>differing precision</em>, <em>dynamic range</em>, and <em>signal-to-noise ratios</em>).</li>
<li>(F-P DSP math) <strong>Reduces the need of scaling and probability of overflow.</strong></li>
<li><strong>High-level language programmability, large address spaces, wide dynamic range</strong>.</li>
</ul>
<h2 id="blackfin-sharc">BLACKFIN / SHARC</h2>
<p>以下是ADI官网对BLACKFIN 和 SHARC的描述</p>
<p><strong>BLACKFIN</strong></p>
<blockquote>
<p>Blackfin® 16/32位嵌入式处理器提供软件灵活性和扩展能力，适合融合应用：多格式音频、视频、语音和图像处理、多模式基带和分组处理、控制处理以及实时安全。</p>
</blockquote>
<p><strong>SHARC</strong></p>
<blockquote>
<p>SHARC音频处理器产品系列采用ADI公司的SHARC®和SHARC+®数字信号处理(DSP)内核技术，提供确定性和极低处理延迟以及出色的MIPS/mW性能。SHARC处理器系列在浮点DSP市场占据主导地位，拥有出色的内核和存储器性能以及优异的I/O吞吐能力。SHARC具有多个产品版本和价位，能够为动态范围至关重要的许多应用提供实时浮点处理性能。</p>
<p>许多处理器集成了FIR/IIR硬件加速器，可分流内核的通用数字信号处理算法任务，从而使内核能够并行执行后处理算法，因而非常适合实时音频应用。广泛的SHARC+ SoC产品组合提供高达1GHz的性能可扩展性以及各种片内存储器配置和混合外设。对于以太网和USB等复杂的外设，一些SoC集成了ARM内核以便处理运行堆栈软件和其他微控制器任务。</p>
</blockquote>
<p>以下文字是《ADSP-21479 EZ-Board Evaluation System Manual》全篇唯一出现blackfin关键字（Page28）的地方，但是21479不属于Blackfin系列，应该是错误来的。</p>
<p><img src="https://pic.islet.space/2021/05/20210520135658.png" alt="image-20210520135616863" style="zoom:50%;" /></p>
<figure>
<img src="https://pic.islet.space/2021/05/20210520135659.png" alt="image-20210520135407091" /><figcaption aria-hidden="true">image-20210520135407091</figcaption>
</figure>
<h1 id="basic-knowledge">BASIC KNOWLEDGE</h1>
<p>原理图模块 是指用于构建SigmaStudio设计的模块。每个处理器可用的块显示在“工具箱”和“树形工具箱”窗口中，可以将其拖放到原理图中。</p>
<h2 id="usbi">USBi</h2>
<ul>
<li><p>USBi features a standard Aardvark-compatible programming header.</p></li>
<li><p>USBi can be used for real-time tuning of Sigma-DSP with SigmaStudio</p></li>
</ul>
<p>下图为USBi的功能框架：</p>
<p><img src="https://pic.islet.space/2021/05/image-20210518114358905.png" alt="image-20210518114358905" style="zoom:80%;" /></p>
<blockquote>
<p>USBi在I2C总线上有一个EEPROM，地址为0x50。它用来向PC显示其供应商ID和产品ID，以及启动其内部程序。应该避免在你的系统设计中在这个地址上有任何其他的EEPROMs。</p>
<p>这个EEPROM没有写保护；因此，如果你试图写到地址0x50，你将覆盖USBi的板载EEPROM，USBi将停止工作。如果不把板子还给Analog Devices，就不能对USBi进行重新编程。大多数EEPROM被设置为地址0x50的方法是将其引脚A0 = 1 和A1 = A2 = 0。</p>
</blockquote>
<h2 id="algorithms-addremove-growreduce">Algorithms: Add/Remove, Grow/Reduce</h2>
<p>每个原理图块代表一种或多种信号处理算法。算法的范围从非常简单的<a target="_blank" rel="noopener" href="https://wiki.analog.com/resources/tools-software/sigmastudio/toolbox/basicdsp/signaladd">信号添加</a>（如<a target="_blank" rel="noopener" href="https://wiki.analog.com/resources/tools-software/sigmastudio/toolbox/basicdsp/signaladd">Signal Add</a>）到高级系统组件（如<a target="_blank" rel="noopener" href="https://wiki.analog.com/resources/tools-software/sigmastudio/toolbox/adialgorithms/dynamicbassboost">Dynamic Bass Boost）</a>。您可以从块中添加或删除算法以满足您的特定要求。如下所述，算法也可以增长。</p>
<hr />
<p><strong>添加算法：</strong></p>
<p>您必须添加一种算法-通常与一组I / O引脚关联-才能使块起作用。要将算法添加到块，请<strong>右键单击</strong>该块，然后选择<strong>添加算法&gt; IC＃</strong>，然后选择<strong>算法</strong>的DSP IC。请注意，如果您的项目中有多个处理器（IC / DSP），则可以选择哪个DSP将运行算法，有关更多信息，请参见下文。</p>
<p><a target="_blank" rel="noopener" href="https://wiki.analog.com/_detail/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/algorithmpic1.png?id=resources%3Atools-software%3Asigmastudio%3Ausingsigmastudio%3Abuildingschematics%3Aalgorithms"><img src="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/algorithmpic1.png" alt="img" /></a></p>
<p>此时，如果需要，右键单击块的边界或标签以添加其他算法。（重要的是右键单击边框或标签；如果右键单击中心，则可能会显示用于输入参数值的弹出窗口。）</p>
<p><a target="_blank" rel="noopener" href="https://wiki.analog.com/_detail/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/algorithmpic2.png?id=resources%3Atools-software%3Asigmastudio%3Ausingsigmastudio%3Abuildingschematics%3Aalgorithms"><img src="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/algorithmpic2.png" alt="img" /></a></p>
<p>不包含算法的块将没有控件或引脚，并且您只会看到该块的名称（如下图所示）。必须在空块中添加算法，然后才能在原理图设计中使用它们。</p>
<p><a target="_blank" rel="noopener" href="https://wiki.analog.com/_detail/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/algorithmpic3.png?id=resources%3Atools-software%3Asigmastudio%3Ausingsigmastudio%3Abuildingschematics%3Aalgorithms"><img src="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/algorithmpic3.png" alt="img" /></a></p>
<p><strong>注意</strong>：使用“<a target="_blank" rel="noopener" href="https://wiki.analog.com/resources/tools-software/sigmastudio/developmentenvironment/toolbox">树形工具箱”窗口时</a>，总是为每个插入的块创建一个算法。但是，如果使用传统的“<a target="_blank" rel="noopener" href="https://wiki.analog.com/resources/tools-software/sigmastudio/developmentenvironment/toolbox">工具箱”</a>窗口插入块，则可能还必须添加算法。</p>
<p>添加算法时，不仅要为模块选择计算方法，还要为算法选择特定的DSP关联。如果要连接多个DSP处理器，这一点很重要：通过将算法添加到模块中，可以共享模块和控件，并同时与多个DSP进行通信。</p>
<p><strong>例如</strong>：<a target="_blank" rel="noopener" href="https://wiki.analog.com/resources/tools-software/sigmastudio/volumecontrols/singlevolumecontrol">单个音量控制</a>块具有用于所有算法的单个滑块控件。如果使用2个DSP处理器（IC 1（AD1940）和IC 2（ADAU1701））创建一个项目，然后选择“添加算法”，则系统将提示您要将该算法添加到哪个芯片。</p>
<p><a target="_blank" rel="noopener" href="https://wiki.analog.com/_detail/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/algorithmpic4.png?id=resources%3Atools-software%3Asigmastudio%3Ausingsigmastudio%3Abuildingschematics%3Aalgorithms"><img src="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/algorithmpic4.png" alt="img" /></a></p>
<p>可以将第一种算法分配给IC 1，将第二种算法分配给IC 2，但是它们共享音量块和单个滑块控件。请注意，您不能在不同的处理器之间建立连线，有关更多信息，请参见<a target="_blank" rel="noopener" href="https://wiki.analog.com/resources/tools-software/sigmastudio/usingsigmastudio/wiresandaliases">连线</a>主题。</p>
<hr />
<p><strong>删除算法：</strong></p>
<p>也可以从块中删除算法。要删除算法，请<strong>右键单击</strong>该块，然后选择“<strong>删除算法”</strong>。这将删除最后添加的算法（底部引脚）。如果该块仅包含一种算法，则删除该算法将导致一个空块</p>
<hr />
<p><strong>增长算法：</strong></p>
<p>不断增长的算法意味着在该块的现有算法的基础上，保持相同的算法（在其上进行扩展）和相同的DSP关联（添加算法均不执行）。要增长算法，请<strong>右键单击</strong>该块，然后选择“<strong>增长算法”&gt;“（算法名称）”&gt;“（增长量）”</strong>。请注意，并非所有算法都可以使用增长。</p>
<p>理解添加和增长之间区别的最简单方法是使用混合器块。将交叉混合器（2个输入）拖到工作区中。右键单击并选择“增长算法”，请参见下面的示例。</p>
<ul>
<li>增加混音器会创建更多的混音器输出引脚，实际上，您正在创建共享公共输入的额外混音器输出通道。块中仍然只有一个算法。</li>
<li>添加算法将创建单独的算法，这些算法共享控制窗口，但不共享输入/输出引脚或资源。在混频器示例中，一个附加的输入引脚，输出引脚和一个交叉混频器控件被添加到了该模块中。</li>
</ul>
<hr />
<p><strong>减少算法：</strong></p>
<p>减少与增加相反，减少了由“增加算法”操作创建的多余控件和引脚。像删除算法一样，reduce将删除从底部或最近增长的项目开始的控件/大头针。</p>
<figure>
<img src="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/algorithmpic5.png" alt="img" /><figcaption aria-hidden="true">img</figcaption>
</figure>
<h3 id="wires-and-aliases">Wires and Aliases</h3>
<p>SigmaStudio原理图设计由与“导线”连接在一起的模块构建。导线定义了系统的信号流。</p>
<p><strong>要创建原理图导线：</strong> 将鼠标光标移到块的<a target="_blank" rel="noopener" href="https://wiki.analog.com/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/schematicblocks">引脚上，</a>以便显示导线图标<a target="_blank" rel="noopener" href="https://wiki.analog.com/_detail/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/icon.png?id=resources%3Atools-software%3Asigmastudio%3Ausingsigmastudio%3Abuildingschematics%3Awiresandaliases"><img src="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/icon.png" alt="img" /></a>。接下来，左键单击一个块引脚，然后在按住鼠标按钮的同时，将光标拖到另一个块的相应引脚上。输入引脚只能连接到输出引脚，而输出引脚只能连接到输入引脚。</p>
<p><a target="_blank" rel="noopener" href="https://wiki.analog.com/_detail/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/wirespic1.png?id=resources%3Atools-software%3Asigmastudio%3Ausingsigmastudio%3Abuildingschematics%3Awiresandaliases"><img src="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/wirespic1.png" alt="img" /></a></p>
<p><strong>选择：</strong></p>
<p>要选择一条导线，请用鼠标左键单击它。选定的电线用绿色正方形（点）表示，如下所示。<strong>位置：</strong></p>
<p><a target="_blank" rel="noopener" href="https://wiki.analog.com/_detail/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/wirespic2.png?id=resources%3Atools-software%3Asigmastudio%3Ausingsigmastudio%3Abuildingschematics%3Awiresandaliases"><img src="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/wirespic2.png" alt="img" /></a></p>
<p>要更改导线的位置，请将鼠标光标放在一个点上。接下来，在导线点上<strong>单击</strong>鼠标左键，并在按住鼠标键的同时拖动光标以重新放置导线。</p>
<p><a target="_blank" rel="noopener" href="https://wiki.analog.com/_detail/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/wirespic3.png?id=resources%3Atools-software%3Asigmastudio%3Ausingsigmastudio%3Abuildingschematics%3Awiresandaliases"><img src="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/wirespic3.png" alt="img" /></a></p>
<p><strong>菜单：</strong></p>
<p>右键单击导线以调出导线菜单。该菜单包括以下命令：</p>
<p><a target="_blank" rel="noopener" href="https://wiki.analog.com/_detail/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/wirespic4.png?id=resources%3Atools-software%3Asigmastudio%3Ausingsigmastudio%3Abuildingschematics%3Awiresandaliases"><img src="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/wirespic4.png" alt="img" /></a></p>
<p><strong>电线颜色：</strong></p>
<p>电线根据其关联的DSP处理器进行着色。导线的输入和输出引脚必须与同一DSP关联，否则您将无法在引脚之间建立导线。具有多个处理器IC的项目的每个IC将具有不同的颜色。</p>
<p><a target="_blank" rel="noopener" href="https://wiki.analog.com/_detail/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/wirespic5.png?id=resources%3Atools-software%3Asigmastudio%3Ausingsigmastudio%3Abuildingschematics%3Awiresandaliases"><img src="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/wirespic5.png" alt="img" /></a></p>
<hr />
<p><strong>引脚（导线）备注：</strong></p>
<p>为了直观地组织项目，通常有助于创建备注，以在原理图中的信号流中提供清晰的连接参考（“跳转”）。一个<strong>备注</strong>由一对输入的备注和备注输出块组成。使用备注块可以减少长导线连接所造成的原理图窗口中的视觉混乱。</p>
<p>要创建备注，请<strong>右键单击</strong>块的输出引脚（蓝色引脚），然后从菜单中选择“<strong>备注</strong>”。</p>
<p><a target="_blank" rel="noopener" href="https://wiki.analog.com/_detail/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/wirespic6.png?id=resources%3Atools-software%3Asigmastudio%3Ausingsigmastudio%3Abuildingschematics%3Awiresandaliases"><img src="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/wirespic6.png" alt="img" /></a></p>
<p>当您单击<strong>Alias时</strong>，将出现两个块，分别是输入和输出。备注输入自动连接到源模块的输出引脚。接下来，创建一条从备注输出块（在下面的示例中为备注2）到信号目标的导线。</p>
<p><a target="_blank" rel="noopener" href="https://wiki.analog.com/_detail/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/wirespic7.png?id=resources%3Atools-software%3Asigmastudio%3Ausingsigmastudio%3Abuildingschematics%3Awiresandaliases"><img src="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/wirespic7.png" alt="img" /></a></p>
<p><strong>注意：</strong>使用备注在功能上等同于用电线连接两个引脚。以下示例中的信号流与上面的备注示例相同。</p>
<p><a target="_blank" rel="noopener" href="https://wiki.analog.com/_detail/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/wirespic8.png?id=resources%3Atools-software%3Asigmastudio%3Ausingsigmastudio%3Abuildingschematics%3Awiresandaliases"><img src="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/usingsigmastudio/buildingschematics/wirespic8.png" alt="img" /></a></p>
<h3 id="hardware-configuration-tab">Hardware Configuration Tab</h3>
<p>硬件配置工作区允许您为设计选择一个或多个处理器。它还允许您设置SigmaStudio与硬件之间的通信。</p>
<p>要了解可以在“硬件配置”选项卡中访问的高级操作（包括“输出捕获”，“ Flash / E2Prom下载”，“寄存器控制”窗口和“寄存器读/写”窗口），请参阅“硬件Windows”部分中的主题。</p>
<p><strong>要将处理器（IC / DSP）插入设计中：</strong></p>
<ol type="1">
<li><p>用鼠标左键从工具箱中选择一个“处理器”：</p>
<ol type="1">
<li><a target="_blank" rel="noopener" href="https://wiki.analog.com/_detail/resources/tools-software/sigmastudio/developmentenvironment/hardwareconfpic1.png?id=resources%3Atools-software%3Asigmastudio%3Adevelopmentenvironment%3Ahardwareconfigurationtab"><img src="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/developmentenvironment/hardwareconfpic1.png" alt="img" /></a></li>
</ol></li>
<li><p>将处理器模块拖放到右侧的“硬件配置”窗口中：</p>
<p><a target="_blank" rel="noopener" href="https://wiki.analog.com/_detail/resources/tools-software/sigmastudio/developmentenvironment/hardwareconfpic2.png?id=resources%3Atools-software%3Asigmastudio%3Adevelopmentenvironment%3Ahardwareconfigurationtab"><img src="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/developmentenvironment/hardwareconfpic2.png" alt="img" /></a></p></li>
</ol>
<p><strong>注意：</strong>一旦在“硬件配置”窗口中插入DSP，就会出现“原理图（Schematic）”选项卡。</p>
<p><strong>在DSP处理器和硬件之间建立连接：</strong></p>
<ol type="1">
<li>单击“通信渠道（Communication Channel）”类别（在“工具箱”列的底部）。</li>
<li>从列表中选择评估板或USB设备，并将其拖放到工作区中。</li>
<li>通过在通信通道和处理器模块之间画线来连接两个模块，从蓝色菱形到绿色菱形。对于使用AD1940的USB连接，工作空间中的单元格应如下所示：</li>
</ol>
<p><strong>注意</strong>：“通信通道”菜单列出了带有前缀EvalBoard的名称和板号。这些通信通道将在不使用评估板设置的平台上适用于相同的IC类型。还有通用的通信通道，USBSerialConv和USBi。（有关更多信息，请参见USB串行转换器通信通道或USBi。）</p>
<p><a target="_blank" rel="noopener" href="https://wiki.analog.com/_detail/resources/tools-software/sigmastudio/developmentenvironment/hardwareconfpic3.png?id=resources%3Atools-software%3Asigmastudio%3Adevelopmentenvironment%3Ahardwareconfigurationtab"><img src="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/developmentenvironment/hardwareconfpic3.png" alt="img" /></a></p>
<p>通信模块上USB标签 的颜色表示是否已建立USB通信通道。如果您已正确配置USB硬件，则背景色将为浅橙色或白色。如果未初始化通信，则背景将为红色。请注意，这仅表示USB连接处于活动状态，不能保证与SigmaDSP IC的通信或SigmaDSP硬件已正确配置。</p>
<p><a target="_blank" rel="noopener" href="https://wiki.analog.com/_detail/resources/tools-software/sigmastudio/developmentenvironment/hardwareconfpic4.png?id=resources%3Atools-software%3Asigmastudio%3Adevelopmentenvironment%3Ahardwareconfigurationtab"><img src="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/developmentenvironment/hardwareconfpic4.png" alt="img" /></a></p>
<p>连接所有板卡IC时，“已连接”背景色为白色，而仅连接部分IC（但不是全部）时为“橙色”。例如，ADAU1701评估板包括ADAU1701 IC和E2Prom IC。仅连接ADAU1701时，背景将为浅橙色，但同时连接ADAU1701和E2Prom IC时，背景将为白色。</p>
<p><a target="_blank" rel="noopener" href="https://wiki.analog.com/_detail/resources/tools-software/sigmastudio/developmentenvironment/hardwareconfpic5.png?id=resources%3Atools-software%3Asigmastudio%3Adevelopmentenvironment%3Ahardwareconfigurationtab"><img src="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/developmentenvironment/hardwareconfpic5.png" alt="img" /></a></p>
<p>https://wiki.analog.com/_detail/resources/tools-software/sigmastudio/gettingstarted/usbinterfaces/usbpic4.png?id=resources%3Atools-software%3Asigmastudio%3Agettingstarted%3Ausbinterfaces%3Ausbserialconverter)</p>
<hr />
<p><strong>EVAL-ADUSB1板开关和跳线：</strong></p>
<ul>
<li>S1-将闪存中保存的程序加载到SigmaDSP。</li>
<li>S2-选择当按下S1时将加载八个SigmaDSP程序中的哪一个。</li>
<li>S3-重置USB适配器板。</li>
<li>TP1-+ 5Vdc连接，用于适配器未通过PC的USB端口供电的情况。</li>
<li>TP2-接地，用于适配器未通过PC的USB端口供电的情况。</li>
<li>J3-当该接头连接器上有跳线时，将启用对闪存的写操作（用于存储SigmaDSP程序）。</li>
<li>D4-此LED指示USB板已通电。</li>
</ul>
<p>可以使用SigmaStudio中的Flash Downloader工具将SigmaDSP程序和参数文件保存到USB板上的闪存中。通过将S2设置为适当的设置，然后按下程序加载按钮S1，可以将每个程序加载到SigmaDSP。请参阅Flash Downloader页面。 有关更多信息，请参见EVAL-ADUSB1数据手册，analog.com / sigmadsp。</p>
<h2 id="digital-attenuator">Digital Attenuator</h2>
<p>即数字衰减器， 与可变衰减器不同，数字衰减器在离散和有限衰减状态下切换。该切换通常以二进制步骤实现。数字衰减器采用半导体器件来实现每个衰减步骤。为此目的而使用的一些半导体器件包括：PIN二极管，MOSFET和GaAs MESFET。数字衰减器能够实现与固态开关速度相当的开关速率。数字衰减器使用的最常见逻辑类型 是CMOS逻辑电平和晶体管晶体管逻辑（TTL）。</p>
<p>数字衰减器利用驱动器电路来确定要使用的逻辑类型。驱动器电路的复杂性取决于所使用的位数。复杂度随着位数的增加而增加。通常根据数字衰减器设计提供的衰减状态对其进行分类。使用的位数决定了这些衰减状态。最高有效位提供最大的衰减，而最低有效位提供组件提供的最小衰减。其余位提供中间衰减值。通常，这些产品采用1位，5位，8位和6位数字衰减器。</p>
<p>如果选择了所有位，则数字衰减器旨在提供最大的额定衰减。另一方面，其最小衰减步长仅通过选择最低有效位来实现。数字衰减器在3G和4G蜂窝网络，点对点节点，中继器以及广泛的测试和测量应用中具有广泛的用途。</p>
<p class="italicp" style="font-style: italic; color: #BBB;">
Shop Arrow.com选择了数字RF步进衰减器，数字音频衰减器等。 <a hre="https://www.arrow.com/en/categories/attenuators/fixedvariable-attenuators/digital-attenuators#">&gt;&gt;&gt; read more</a>
</p>
<h2 id="asrc">ASRC</h2>
<p>异步采样速率转换器(ASRC，Asynchronous Sample Rate Converter)是一款可同时用于消费电子和专业应用的音频采样速率转换通用软件模块。 ASRC支持多种不同的采样速率配置。</p>
<p><strong>ASRC软件模块</strong> 可用于以小步长改变采样频率，步长随着时间改变，且在变化过程中不生成任何输出音频干扰。 在许多多媒体系统中，时变采样速率的改变是非常重要的功能，例如能实现多个数据流的精密同步以及服务器和客户端的同步等。</p>
<p>ADI公司的ASRC实施方案经过高度优化，适合在ADI公司的Blackfin系列处理器上运行。它是一个基于ADI专利设计的独立自足软件模块。该模块已经过各种根据音频信号质量分析定义的策略质量测试。</p>
<p>ASRC模块是应用于PCM（脉冲编码调制）上的后处理模块，通过模拟输入、数字输入通道或解码应用的PCM输出接收数据。 ASRC模块能够处理多个通道的输入信息，并能够输出至同样多的通道。 开发的模块支持全面的重入和多实例。 ASRC模块是一个独立的模块，不依赖其他任何模块。 ADRC模块配备一个示例轻型包装器API，将模块插入至整体系统。 这使得该应用的系统集成简单易行。</p>
<h3 id="asrc-inputoutput">ASRC INPUT/OUTPUT</h3>
<p>ASRC输入和输出模块在原理图设计和硬件ASRC（异步采样率转换器）之间路由信号。</p>
<p>使用输入块的复选框来启用或禁用特定输入。使用输出块的下拉列表控件从可用的ASRC中进行选择。</p>
<ul>
<li>每个ASRC输出必须连接其输入，否则编译时将出错。</li>
<li>可以看到，随着将更多的ASRC输出块拖到原理图中，下拉列表中的可用输出数量会减少，因为一次只能由一个块表示。</li>
<li>要更改ASRC <strong>输入采样率</strong>，请右键单击块名称，然后选择“设置采样率”，这将打开“采样率”窗口（默认值为44.1 kHz）。</li>
</ul>
<figure>
<img src="https://wiki.analog.com/_media/resources/tools-software/sigmastudio/toolbox/io/asrc_input_output_020.jpg" alt="img" /><figcaption aria-hidden="true">img</figcaption>
</figure>
<h2 id="limiter-限幅器">Limiter 限幅器</h2>
<p>限幅器（Limiter）是指能按限定的范围削平信号电压波幅的电路，又称削波器。限幅电路的作用是把输出信号幅度限定在一定的范围内，亦即当输入电压超过或低于某一参考值后，输出电压将被限制在某一电平（称作限幅电平），且再不随输入电压变化。</p>
<h2 id="lsb-aligned">LSB-aligned</h2>
<p>LSB(Least Significant Bit)是“最低有效位”。MSB(Most Significant Bit)是“最高有效位”。</p>
<p>最高有效位是指二进制中最高值的比特，如：</p>
<blockquote>
<ol type="1">
<li><p>在16比特的数字音频中，其第1个比特便对16bit的字的数值有最大的影响。</p></li>
<li><p>在十进制的15，389这一数字中，相当于万数那1行（1）的数字便对数值的影响最大。比较与之相反的“最低有效位”（LSB）。</p></li>
<li><p>汇编中，比如8位2进制数10000001，其中第一个1是MSB,第二个1是LSB。<mark>1</mark>（MSB）100 001<mark>1</mark>（LSB）</p></li>
<li><p>在计算时，如果是整数，那么小数点（实际上是没有小数点的，但就把那一位和下一位之间看作有）在LSB后面；如果是小数，小数点在MSB后面；其中MSB在有符号数中又是符号位。</p></li>
</ol>
</blockquote>
<p>在网络通信方面，大家说的更多的是：“<strong>Big-Endian</strong>”和“<strong>Small-Endian</strong>”的问题。指的都是对于多字节的数据类型（比如4字节的32位整数），其多个字节的顺序问题，是最高字节在前（Big-Endian）还是最低字节在前（Small-Endian）。</p>
<p>比如对于123456789这个整数，其16进制为0x075BCD15，那么按照Big-Endian的方式，它在网络上传输（或者在内存里存储）的4个字节依次是：<code>07 4B CD 15</code>，而Small-Endian的顺序正相反，是：<code>15 CD 4B 07</code>。</p>
<p><strong>MSB</strong> 和 <strong>LSB</strong> 虽然跟这个事情看起来有点相似，但不是一回事。</p>
<p>通常，一个芯片的管脚中，对于一个多比特的信号，比如32根的地址线，从低开始按0到31编个号。MSB就是31，LSB就是0。那么如果标记为：ADDR[31:0]就是MSB first的方式，如果标记为ADDR[0:31]就是LSB first的方式。</p>
<p><strong>MSB LSB</strong>：起始地址为最高位， 最后地址为最低位。</p>
<p><strong>LSB MSB</strong>：起始地址为最低位，最后地址为最高位。</p>
<p>比如AD中，8位，最低有效位指D0</p>
<h2 id="cofficient-write">Cofficient Write</h2>
<p>即 <strong>参数写入</strong>，是指对参数中两组 <strong><em>寄存器参数集</em></strong> 的系数写入。当然也可以单独写入某个寄存器的数值。</p>
<p>可写入的参数如：filter coefficients、limiter settings、volume control settings等。</p>
<p>每组 <strong>寄存器参数集</strong> 可写入至多 160个参数（32个过滤器*5个系数）。</p>
<h2 id="filters">Filters</h2>
<p>在ADAU1772的General(2<sup>nd</sup> Order) Filter Setting中有几项过滤器，分别是 Parametric 、 Shelving 、 General HP/LP/BP/BS 、 Butterworth/Bessel 、 Tone Control、IIR Coefficient 、First Order Filters 、All Pass 、Peaking 、Notch 、 Chebyshev 共11中过滤器。</p>
<figure>
<img src="https://pic.islet.space/2021/04/image-20210428152357233.png" alt="image-20210428152357233" /><figcaption aria-hidden="true">image-20210428152357233</figcaption>
</figure>
<h1 id="sigmastudio">SigmaStudio</h1>
<p>以下简称sigma</p>
<h2 id="capture">Capture</h2>
<p>Capture 窗口会捕捉开发者对设置的相关改动记录。</p>
<figure>
<img src="https://pic.islet.space/2021/04/image-20210422165857465.png" alt="image-20210422165857465" /><figcaption aria-hidden="true">image-20210422165857465</figcaption>
</figure>
<h2 id="register-control">Register Control</h2>
<figure>
<img src="https://pic.islet.space/2021/04/image-20210422163633005.png" alt="image-20210422163633005" /><figcaption aria-hidden="true">image-20210422163633005</figcaption>
</figure>
<h3 id="outputserial-port">Output/Serial Port</h3>
<h4 id="下压式音量按键">下压式音量按键</h4>
<p>使用前需要进行跳线，跳线方法如下：</p>
<p><img src="https://pic.islet.space/2021/04/image-20210422163804275.png" alt="image-20210422163804275" style="zoom:50%;" /></p>
<p>控制界面如下：</p>
<figure>
<img src="https://pic.islet.space/2021/04/image-20210422163228410.png" alt="image-20210422163228410" /><figcaption aria-hidden="true">image-20210422163228410</figcaption>
</figure>
<blockquote>
<p>？？ Time</p>
<p>Initial PB Volume 初始化下压式按键的音量值</p>
<p>Gain Step 增益速度</p>
<p>Ramp Speed 增加速度</p>
<p>Converters Controlled by PushButton Volume 被控制的转换器</p>
</blockquote>
<h2 id="download-program">Download Program</h2>
<p><img src="https://pic.islet.space/2021/04/image-20210422170248954.png" alt="image-20210422170248954" style="zoom:67%;" /></p>
<figure>
<img src="https://pic.islet.space/2021/04/image-20210422170328013.png" alt="image-20210422170328013" /><figcaption aria-hidden="true">image-20210422170328013</figcaption>
</figure>
<h2 id="microphone">Microphone</h2>
<p>TRS 1/8-inch mini-plug stereo headphones</p>
<p><img src="https://pic.islet.space/2021/04/048f07ee-e357-4c06-a8e4-1724e62765a4_1.e937ba0bd42739fc09e9ef63602645b8.jpeg" alt="查看源图像" style="zoom:50%;" /></p>
<p>standard 0.100” headers</p>
<p><img src="https://pic.islet.space/2021/04/R68f2db356a43d3653db1298ccd26e835" alt="查看源图像" style="zoom:50%;" /></p>
<h3 id="bias-setting">Bias Setting</h3>
<figure>
<img src="https://pic.islet.space/2021/04/image-20210423102647330.png" alt="image-20210423102647330" /><figcaption aria-hidden="true">image-20210423102647330</figcaption>
</figure>
<p>ADAU1772包括两个麦克风偏置输出：MICBIAS0和MICBIAS1。这些引脚为驻极体模拟麦克风提供电压参考。</p>
<ol type="1">
<li>MICBIASx引脚也可用于为具有独立电源引脚的数字或模拟MEMS麦克风干净地提供电压。</li>
<li>MICBIASx电压在麦克风偏置控制寄存器（地址0x002D）中设置。可以利用这个寄存器对MICBIAS0或MICBIAS1的输出进行启用或禁用。</li>
<li>增益选项提供了两种可能的电压：0.65 × AVDD或0.90 × AVDD。许多应用要求只启用两个偏置输出中的一个。当系统中使用许多传声器时，或者当传声器在PCB上的位置不允许一个引脚对所有传声器进行偏置时，两个偏置输出都应该被启用。</li>
</ol>
<p>dataword byte : 在突发模式（burst mode）中使用。</p>
<p>data byte : 在单字模式（single-word mode）下写入。</p>
<h2 id="由dsp启动1772">由DSP启动1772</h2>
<p>1772启动可以通过以下两种方式执行：</p>
<ol type="1">
<li>通过SPI或I2C协议，将执行代码写入到SRAM的方式来执行</li>
<li>通过将代码写入EEPROM，并设置自启动的方式来读取和执行代码。</li>
</ol>
<p>由DSP启动1772，其实是通过上述第一种方式来进行，其中又可以再分为两种方法：</p>
<ol type="1">
<li>通过在SigmaStudio中导出项目系统文件，并加载至DSP项目工程的方式来执行，具体方法后述。</li>
<li>通过SPI协议，由DSP片选1772后逐各写入寄存器的方式来执行（注意：使用本方法时，单次写入量不可超过128个字节）。</li>
</ol>
<h3 id="通过导出系统文件的方式">通过导出系统文件的方式</h3>
<p>在SigmaStudio中，执行过 <code>Link Compile Downloa</code> 后，可以点击 <code>Export System Files</code> 导出项目工程文件（C格式）</p>
<p><img src="https://pic.islet.space/2021/05/image-20210510084234044.png" alt="image-20210510084234044" style="zoom:80%;" />，并将 <code>.h</code> 、<code>_PARAM.h</code> 及<code>_REG.h</code> 三个类型文件插入到DSP的项目文件中。</p>
<p><strong>注意</strong>：如图所示，所选的三个文件为主IC（1772）的工程文件，另外三个同后缀名的IC_2是另一个芯片（EEPROM）的文件，看情况决定是否使用。</p>
<p><img src="https://pic.islet.space/2021/05/image-20210510091831286.png" alt="image-20210510091831286" style="zoom:67%;" /></p>
<p>其中，<code>_PARAM.h</code> 及<code>_REG.h</code> 提供了对寄存器的定义，<code>.h</code> 文件中提供了唯一的执行方法 <code>default_download_IC_1()</code>，在DSP项目工程文件中执行即可。</p>
<p><img src="https://pic.islet.space/2021/06/20210601105542.png" alt="image-20210510092602442" style="zoom: 50%;" /></p>
<p><strong>注意：</strong>本文件依赖于 <code>SigmaStudioFW.h</code> 头文件，<img src="https://pic.islet.space/2021/05/image-20210510093228165.png" alt="image-20210510093228165" />，可以复制粘贴以下原代码，也可以在SigmaStudio的安装目录下查找。</p>
<p><mark>需要注意的是，以下所有宏定义内容都为空，需要开发者自行编写。</mark></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * File:			SigmaStudioFW.h</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Description:  	SigmaStudio System Framwork macro definitions. These </span></span><br><span class="line"><span class="comment"> *				macros should be implemented for your system&#x27;s software.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * This software is distributed in the hope that it will be useful,</span></span><br><span class="line"><span class="comment"> * but is distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR </span></span><br><span class="line"><span class="comment"> * CONDITIONS OF ANY KIND, without even the implied warranty of</span></span><br><span class="line"><span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * This software may only be used to program products purchased from</span></span><br><span class="line"><span class="comment"> * Analog Devices for incorporation by you into audio products that </span></span><br><span class="line"><span class="comment"> * are intended for resale to audio product end users. This software</span></span><br><span class="line"><span class="comment"> * may not be distributed whole or in any part to third parties.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Copyright � 2008 Analog Devices, Inc. All rights reserved.</span></span><br><span class="line"><span class="comment"> */</span>	</span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> __SIGMASTUDIOFW_H__</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __SIGMASTUDIOFW_H__</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * <span class="doctag">TODO:</span> Update for your system&#x27;s data type</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">short</span> ADI_DATA_U16;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">char</span>  ADI_REG_TYPE;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * Parameter data format</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SIGMASTUDIOTYPE_FIXPOINT 	0</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SIGMASTUDIOTYPE_INTEGER 	1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * Write to a single Device register</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SIGMA_WRITE_REGISTER( devAddress, address, dataLength, data ) &#123;<span class="comment">/*<span class="doctag">TODO:</span> implement macro or define as function*/</span>&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * <span class="doctag">TODO:</span> CUSTOM MACRO IMPLEMENTATION</span></span><br><span class="line"><span class="comment"> * Write to multiple Device registers </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SIGMA_WRITE_REGISTER_BLOCK( devAddress, address, length, pData ) &#123;<span class="comment">/*<span class="doctag">TODO:</span> implement macro or define as function*/</span>&#125; </span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * <span class="doctag">TODO:</span> CUSTOM MACRO IMPLEMENTATION</span></span><br><span class="line"><span class="comment"> * Writes delay (in ms) </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SIGMA_WRITE_DELAY( devAddress, length, pData ) &#123;<span class="comment">/*<span class="doctag">TODO:</span> implement macro or define as function*/</span>&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Read device registers </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SIGMA_READ_REGISTER( devAddress, address, length, pData ) &#123;<span class="comment">/*<span class="doctag">TODO:</span> implement macro or define as function*/</span>&#125; </span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Set a register field&#x27;s value</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SIGMA_SET_REGSITER_FIELD( regVal, fieldVal, fieldMask, fieldShift )  \</span></span><br><span class="line">		&#123; (regVal) = (((regVal) &amp; (~(fieldMask))) | (((fieldVal) &lt;&lt; (fieldShift)) &amp;&amp; (fieldMask))) &#125;</span><br><span class="line">  </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Get the value of a register field</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SIGMA_GET_REGSITER_FIELD( regVal, fieldMask, fieldShift )  \</span></span><br><span class="line">		&#123; ((regVal) &amp; (fieldMask)) &gt;&gt; (fieldShift) &#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * Convert a floating-point value to SigmaDSP (5.23) fixed point format </span></span><br><span class="line"><span class="comment"> *    This optional macro is intended for systems having special implementation</span></span><br><span class="line"><span class="comment"> *    requirements (for example: limited memory size or endianness)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SIGMASTUDIOTYPE_FIXPOINT_CONVERT( _value ) &#123;<span class="comment">/*<span class="doctag">TODO:</span> IMPLEMENT MACRO*/</span>&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * Convert integer data to system compatible format</span></span><br><span class="line"><span class="comment"> *    This optional macro is intended for systems having special implementation</span></span><br><span class="line"><span class="comment"> *    requirements (for example: limited memory size or endianness)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SIGMASTUDIOTYPE_INTEGER_CONVERT( _value ) &#123;<span class="comment">/*<span class="doctag">TODO:</span> IMPLEMENT MACRO*/</span>&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<h3 id="通过写入寄存器的方式">通过写入寄存器的方式</h3>
<p>在 Capture 面板中，对寄存器的所有操作都会以 <strong>参数名</strong>、<strong>地址</strong> 和 <strong>数据</strong> 的方式展现，几乎所有参数名都可以在《ADAU1772》中查询。</p>
<p><img src="https://pic.islet.space/2021/05/image-20210510091150821.png" alt="image-20210510091150821" style="zoom: 67%;" /></p>
<ol type="1">
<li>全选面板中所有的值，可以点选第一个值，按 <code>SHIFT</code> + <code>END</code> 来全选，然后右键选择 <code>Save as Raw Data</code> 下的 <code>Address+Data(Text)...</code> ，会以文本格式 (.txt) 保存。</li>
</ol>
<p><img src="https://pic.islet.space/2021/05/image-20210510085052186.png" alt="image-20210510085052186" style="zoom:67%;" /></p>
<p>保存结果：</p>
<p><img src="https://pic.islet.space/2021/05/image-20210510085331956.png" alt="image-20210510085331956" style="zoom:67%;" /></p>
<ol start="2" type="1">
<li>将地址和值整理到DSP项目文件中进行写入，这种方式不太好操作，需要开发人员自行编写对应的代码，较为不友好。</li>
</ol>
<h1 id="chip-adau1772">CHIP-ADAU1772</h1>
<ul>
<li>ADAU1772以下简称1772</li>
<li>《Evaluation Board User Guide UG-477》以下简称UG</li>
</ul>
<h2 id="i2s及i2c接口">I2S及I2C接口</h2>
<p><img src="https://pic.islet.space/2021/06/20210601105550.png" alt="image-20210513171416187" style="zoom:67%;" /></p>
<p><img src="https://pic.islet.space/2021/06/20210601105615.png" alt="image-20210513171524562" style="zoom:67%;" /></p>
<h2 id="usbi-仿真器">USBi 仿真器</h2>
<ul>
<li>USBi驱动安装：进入设备管理器，安装驱动在SigmaStudio安装目录 <code>\Analog Devices\SigmaStudio 4.6\USB drivers\</code> 下。</li>
<li>连接到USBi未成功时是红色，设备驱动安装且连接成功时，USBi 在sigma中会由红变绿。</li>
<li>USBi作为中间板对1772进行控制，在USBi右键可以控制1772设备开断，开断时板上D1区的VDD指示灯也会通断（见page10）。</li>
<li>如果需要对设备进行实时控制，请务必记得打开设备，否则无法操作。</li>
</ul>
<p><img src="https://pic.islet.space/2021/04/image-20210428150645112.png" alt="image-20210428150645112" style="zoom: 67%;" /></p>
<ul>
<li>USBi将例程down到了板子上ADAU1772的SRAM上，断电就没有了。USBi的这种调试是为了快速验证功能，最终需要把这个例程的代码导出，并通过单片机的 <strong>启动工程集成</strong>，烧写到单片机中，实现单片机启动。</li>
</ul>
<p><img src="https://pic.islet.space/2021/04/image-20210427110916316.png" alt="image-20210427110916316" style="zoom:67%;" /></p>
<h3 id="编译烧录">编译烧录</h3>
<ul>
<li>烧录按键如下：</li>
</ul>
<figure>
<img src="https://pic.islet.space/2021/04/image-20210427162529600.png" alt="image-20210427162529600" /><figcaption aria-hidden="true">image-20210427162529600</figcaption>
</figure>
<ul>
<li>编译完毕后，SS会在右边的output窗体里显示编译结果，如有错误会提示错误信息，用户可据此信息去修改设计；</li>
<li>如成功则会显示资源占用信息，用户可根据百分比来增减模块。</li>
</ul>
<p><img src="https://pic.islet.space/2021/04/image-20210427111013493.png" alt="image-20210427111013493" style="zoom:67%;" /></p>
<h3 id="芯片">芯片</h3>
<p>板上共有4颗芯片，分别是 <strong>DSP</strong>、<strong>EEPROM</strong>、<strong>线性整流芯片</strong> 和 <strong>升压芯片</strong></p>
<p><img src="https://pic.islet.space/2021/04/image-20210427171901213.png" alt="image-20210427171901213" style="zoom:50%;" /></p>
<h4 id="u2-eeprom">U2: EEPROM</h4>
<p>ST官网对M24C32-F串行E2PROM的描述：</p>
<p>容量：32-Kbit</p>
<p>电压：1.7 ~ 5.5V</p>
<p>温差：-40 ~ +85℃</p>
<p><img src="https://pic.islet.space/2021/04/Snipaste_2021-04-27_17-18-01.png" alt="Snipaste_2021-04-27_17-18-01" style="zoom: 67%;" /></p>
<p><img src="https://pic.islet.space/2021/04/Snipaste_2021-04-27_17-18-18.png" alt="Snipaste_2021-04-27_17-18-18" style="zoom:67%;" /></p>
<h2 id="输入输出控制">输入输出控制</h2>
<h3 id="供电电压">供电电压</h3>
<p>以下为实际测量数值</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>USB_5V</th>
<th>SCL/SDA(H)</th>
<th></th>
<th>VDD</th>
<th>IOVDD</th>
<th>AVDD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>接USBi实测电压(V)-3.3V档</td>
<td>3.471</td>
<td>1.961</td>
<td></td>
<td>1.997</td>
<td>1.997</td>
<td>1.988</td>
</tr>
<tr class="even">
<td>接21479实测电压(V)-3.3V档</td>
<td>4.463</td>
<td>3.518</td>
<td></td>
<td>3.518</td>
<td>3.518</td>
<td>3.518</td>
</tr>
<tr class="odd">
<td>接21479实测电压(V)-1.8V档</td>
<td>4.468</td>
<td>2.260</td>
<td></td>
<td>1.934</td>
<td>1.934</td>
<td>1.933</td>
</tr>
<tr class="even">
<td>接21479实测电压(V)-3.3V档</td>
<td>3.3</td>
<td>3.3088</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="hp输出">HP输出</h2>
<p>HP即Headphone缩写，HP输出有两个输出端，分别是DAC0 和 DAC1，分别对应为 EVAL板 上的 OUT R(HP Right) 和 OUT L(HP Left)。</p>
<p><img src="https://pic.islet.space/2021/04/image-20210427152251539.png" alt="image-20210427152251539" style="zoom:50%;" /></p>
<p><img src="https://pic.islet.space/2021/04/image-20210427143628880.png" alt="image-20210427143628880" style="zoom: 33%;" /></p>
<h3 id="输出静音">输出静音</h3>
<p><img src="https://pic.islet.space/2021/04/image-20210427153425633.png" alt="image-20210427153425633" style="zoom:50%;" /></p>
<h3 id="输出断电">输出断电</h3>
<p>关于HP输出的寄存器 <code>HP_EN_R</code> 及 <code>HP_EN_L</code> 说明：</p>
<p><img src="https://pic.islet.space/2021/04/image-20210427152528194.png" alt="image-20210427152528194" style="zoom:50%;" /></p>
<p><code>0x31</code> 即 <code>0011 0001</code> ，最后两位 <code>01</code> 即 <code>HP_PDN_L</code> 中的 <code>01</code> 。</p>
<h3 id="输出音量控制">输出音量控制</h3>
<ul>
<li>对输出音量进行控制需要先对S5、S6进行跳针。</li>
</ul>
<p><img src="https://pic.islet.space/2021/04/image-20210427110159648.png" alt="image-20210427110159648" style="zoom:67%;" /></p>
<h3 id="talkthru-dsp-bypass">TALKTHRU / DSP BYPASS</h3>
<blockquote>
<p>DSP BYPASS MODE When DSP bypass mode is enabled, a direct path from the ADC outputs to the DACs is set up to enable bypassing the core processing to listen to environmental sounds.</p>
<p>This is useful for listening to someone speaking without having to remove the noise cancelling headphones. The DSP bypass path is <strong>enabled by setting an MPx pin low</strong>.</p>
<p>Figure 92 shows the DSP bypass path disabled, and Figure 93 shows the DSP bypass path enabled by pressing the push-button switch.</p>
<figure>
<img src="https://pic.islet.space/2021/04/image-20210427144110884.png" alt="image-20210427144110884" /><figcaption aria-hidden="true">image-20210427144110884</figcaption>
</figure>
<p>The DSP bypass feature works for both analog and digital microphone inputs.</p>
<ul>
<li>Enabled when <strong><em>a switch</em></strong> connected to an MPx pin that is set to DSP bypass mode is closed and the MPx pin signal is pulled low.</li>
</ul>
<p>Pressing and holding the switch closed enables the DSP bypass signal path as defined in the TALKTHRU register (Address 0x002A).</p>
<p>The DAC volume control setting is switched from the default gain setting to the new TALKTHRU_GAINx register setting (Address 0x002B and Address 0x002C).</p>
<ul>
<li>DSP bypass is enabled only on ADC0 and ADC1.</li>
</ul>
<p>The DSP bypass signal path is from the output of ADCx to the input of the DAC(s). When DSP bypass is enabled, the current DAC volume setting is ramped down to −95.625 dB and the DSP bypass volume setting is ramped up to avoid pops when switching paths.</p>
</blockquote>
<h1 id="chip-adsp21479">CHIP-ADSP21479</h1>
<h2 id="芯片及评估板资料">芯片及评估板资料</h2>
<p><strong>关于芯片特性</strong>：《ADSP-21477 / ADSP-21478 / ADSP-21479》</p>
<p><strong>关于评估板</strong>：《ADSP-21479 EZ-Board® Evaluation System Manual》</p>
<h2 id="仿真器配置">仿真器配置</h2>
<p>与《HPUSB, USB, and HPPCI Emulators User’s Guide》所描述的并不完全一致。</p>
<p><img src="https://pic.islet.space/2021/05/image-20210519104127472.png" alt="image-20210519104127472" style="zoom: 50%;" /></p>
<p>下图为实际安装后，查看官方对21479提供的相关仿真器的信息和从设备管理器中可查看到的设备信息。</p>
<figure>
<img src="https://pic.islet.space/2021/05/20210519110546.png" alt="image-20210519104034539" /><figcaption aria-hidden="true">image-20210519104034539</figcaption>
</figure>
<p><img src="https://pic.islet.space/2021/05/20210519110551.png" alt="image-20210519104001549" style="zoom:67%;" /></p>
<p>本评估板提供的仿真器使用的是14针脚的HPPCI JTAG，PCI仿真器支持的<mark>操作模式取决于目标机上</mark>14针JTAG接头<mark>的连接方式</mark>。表1-2显示了目标机JTAG头在传统和自动检测模式下的连接方式。</p>
<p><img src="https://pic.islet.space/2021/05/image-20210519105525684.png" alt="image-20210519105525684" style="zoom:67%;" /></p>
<p><strong>注意</strong>：其中3口是无针脚的防呆设计。</p>
<h3 id="hpusb-jtag模式">HPUSB JTAG模式</h3>
<p>在实际开发中，使用的是HPUSB传统模式。</p>
<p>传统模式用于不提供目标VDDIO输入的旧目标，供仿真器自动检测电压。 在这种模式下，JTAG信号运行的电压是通过配置器工具手动设置的。在配置目标时，配置器工具提供了一个电压选择设置。</p>
<blockquote>
<p>Legacy mode is used for older targets that do not provide a target VDDIO input for automatic voltage detection by the emulator.</p>
<p>In this mode, the voltage at which the JTAG signals run is set manually through the Configurator utility.</p>
<p>The configurator utility provides a voltage selection setting when configuring the target.</p>
</blockquote>
<p><strong>注意</strong>：HPUSB-ICE 和 USB-ICE 仿真器都不支持自动电压检测模式。</p>
<p>以下为JTAG的电路示意：</p>
<p><img src="https://pic.islet.space/2021/05/20210519111130.png" alt="image-20210519111126670" style="zoom:80%;" /></p>
<h2 id="i2ctwi串行通信">I2C/TWI串行通信</h2>
<p>根据文件《ADSP-21477_21478_21479_cn》的描述，可知21479支持TWI接口，进而支持I2C。</p>
<p><img src="https://pic.islet.space/2021/05/20210519112440.png" alt="image-20210519112357298" style="zoom:67%;" /></p>
<p>21479没有针对TWI做专门的驱动，Blackfin系列大部分产品都提供了。</p>
<h2 id="dai接口">DAI接口</h2>
<p><strong>Digital Application Interface</strong>，即数字应用接口。所有数字应用接口都以SRU的方式连接至处理器。</p>
<p><strong>SRU</strong>（Signal Routing Unit），即信号路由单元。SRU是处理器内部的一个提供超大系统信号流的复杂路由系统。通过SRU可以将DAI针脚利用不同组合路由至不同的内部设备。DAI所能连接的设备在每块评估板上都不同。下图展示了DAI接口的针脚、所连接的设备及其网络、所连接的开关和默认设置。</p>
<p><mark>要在扩展II接口上使用DAI，请先用相关开关禁用驱动DAI引脚上的任何信号。</mark></p>
<p><img src="https://pic.islet.space/2021/05/20210520110351.png" alt="image-20210520110207578" style="zoom:67%;" /></p>
<p><img src="https://pic.islet.space/2021/05/20210520110355.png" alt="image-20210520110221920" style="zoom:67%;" /></p>
<h2 id="dpi接口">DPI接口</h2>
<p>Digital Peripheral Interface，即数字外围（设备）接口 或 数字设备接口。DPI连接至第二块信号路由单元（SRU2）。</p>
<p>与SRU相似，SRU2也是一块能将大型系统信号流路由至处理器的复杂路由系统。</p>
<p>同样，每块评估板的DPI所连接的设备也不同。下图同：</p>
<p><img src="https://pic.islet.space/2021/06/20210601105459.png" alt="image-20210520111001486" style="zoom:67%;" /></p>
<p><img src="https://pic.islet.space/2021/06/20210612111612.png" alt="image-20210612111607855" style="zoom:67%;" /></p>
<p><img src="https://pic.islet.space/2021/06/20210612111852.png" alt="image-20210612111848897" style="zoom:67%;" /></p>
<h2 id="sru.h">SRU.H</h2>
<h3 id="sru">SRU()</h3>
<p>以下是 <code>&lt;sru21479.h&gt;</code> 中对 <code>SRU()</code> 的宏定义，<code>SRU2()</code> 与其相同 ：<code>#define SRU2(out,in)   SRU(out,in)</code>。</p>
<p>读取、修改和写回一个特定的SRU寄存器，以改变一个SRU的分配（即选择一个输入到一个输出）。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">** Macro: SRU</span></span><br><span class="line"><span class="comment">** Reads, modifies and writes back a particular SRU register to change a single</span></span><br><span class="line"><span class="comment">** SRU assignment (i.e. selects an input to an output).</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta"># <span class="meta-keyword">ifdef</span> _LANGUAGE_C</span></span><br><span class="line"><span class="meta">#  <span class="meta-keyword">define</span> SRU(out,in)                        \</span></span><br><span class="line">     <span class="keyword">do</span> &#123;                                    \</span><br><span class="line">       *(<span class="keyword">volatile</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> *) in##_REG = \</span><br><span class="line">         ((<span class="keyword">unsigned</span> <span class="keyword">int</span>)sru_field(out,in) |  \</span><br><span class="line">         (* (<span class="keyword">volatile</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> *) in##_REG &amp; (<span class="keyword">unsigned</span> <span class="keyword">int</span>)sru_mask(out,in))); \</span><br><span class="line">     &#125; <span class="keyword">while</span> (<span class="number">0</span>)</span><br><span class="line"><span class="meta"># <span class="meta-keyword">else</span></span></span><br><span class="line"><span class="meta">#  <span class="meta-keyword">define</span> SRU(out,in)        \</span></span><br><span class="line">     r0=dm(in##_REG);        \</span><br><span class="line">     r1=sru_mask(out,in);    \</span><br><span class="line">     r0=r0 <span class="keyword">and</span> r1;           \</span><br><span class="line">     r1=sru_field(out,in);   \</span><br><span class="line">     r0=r0 <span class="keyword">or</span> r1;            \</span><br><span class="line">     dm(in##_REG)=r0;</span><br><span class="line"><span class="meta"># <span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<h3 id="sru_field">sru_field()</h3>
<p>为一个给定的输入和输出信号创建位域（bit field）。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">**   Macro: sru_field</span></span><br><span class="line"><span class="comment">**   Creates the bit field for a given input and output signal.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sru_field(out,in) \</span></span><br><span class="line">    (((in##_GROUP &amp; GROUP_A) &gt;&gt; LOG_GROUP_A) * A_#<span class="meta">#out \</span></span><br><span class="line">    |((in##_GROUP &amp; GROUP_B) &gt;&gt; LOG_GROUP_B) * B_#<span class="meta">#out \</span></span><br><span class="line">    |((in##_GROUP &amp; GROUP_C) &gt;&gt; LOG_GROUP_C) * C_#<span class="meta">#out \</span></span><br><span class="line">    |((in##_GROUP &amp; GROUP_D) &gt;&gt; LOG_GROUP_D) * D_#<span class="meta">#out \</span></span><br><span class="line">    |((in##_GROUP &amp; GROUP_E) &gt;&gt; LOG_GROUP_E) * E_#<span class="meta">#out \</span></span><br><span class="line">    |((in##_GROUP &amp; GROUP_F) &gt;&gt; LOG_GROUP_F) * F_#<span class="meta">#out \</span></span><br><span class="line">    |((in##_GROUP &amp; GROUP_G) &gt;&gt; LOG_GROUP_G) * G_#<span class="meta">#out \</span></span><br><span class="line">    |((in##_GROUP &amp; GROUP_H) &gt;&gt; LOG_GROUP_H) * H_#<span class="meta">#out \</span></span><br><span class="line">    |((in##_GROUP &amp; GROUP_I) &gt;&gt; LOG_GROUP_I) * I_#<span class="meta">#out \</span></span><br><span class="line">    |((in##_GROUP &amp; GROUP_A2)&gt;&gt; LOG_GROUP_A2)* A2_#<span class="meta">#out \</span></span><br><span class="line">    |((in##_GROUP &amp; GROUP_B2)&gt;&gt; LOG_GROUP_B2)* B2_#<span class="meta">#out \</span></span><br><span class="line">    |((in##_GROUP &amp; GROUP_C2)&gt;&gt; LOG_GROUP_C2)* C2_#<span class="meta">#out ) &lt;&lt; in##_SHIFT</span></span><br></pre></td></tr></table></figure>
<h3 id="sru_mask">sru_mask()</h3>
<p>创建一个掩码，可用于清除属于给定输入和输出信号的位域。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">**   Macro: sru_mask </span></span><br><span class="line"><span class="comment">**   Creates a mask which can be used for clearing the bitfield belonging </span></span><br><span class="line"><span class="comment">**   to the given input and output signal.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sru_mask(out,in) \</span></span><br><span class="line">     ~((((in##_GROUP &amp; GROUP_A) &gt;&gt; LOG_GROUP_A) * MASK_A \</span><br><span class="line">       |((in##_GROUP &amp; GROUP_B) &gt;&gt; LOG_GROUP_B) * MASK_B \</span><br><span class="line">       |((in##_GROUP &amp; GROUP_C) &gt;&gt; LOG_GROUP_C) * MASK_C \</span><br><span class="line">       |((in##_GROUP &amp; GROUP_D) &gt;&gt; LOG_GROUP_D) * MASK_D \</span><br><span class="line">       |((in##_GROUP &amp; GROUP_E) &gt;&gt; LOG_GROUP_E) * MASK_E \</span><br><span class="line">       |((in##_GROUP &amp; GROUP_F) &gt;&gt; LOG_GROUP_F) * MASK_F \</span><br><span class="line">       |((in##_GROUP &amp; GROUP_G) &gt;&gt; LOG_GROUP_G) * MASK_G \</span><br><span class="line">       |((in##_GROUP &amp; GROUP_H) &gt;&gt; LOG_GROUP_H) * MASK_H \</span><br><span class="line">       |((in##_GROUP &amp; GROUP_I) &gt;&gt; LOG_GROUP_I) * MASK_I \</span><br><span class="line">       |((in##_GROUP &amp; GROUP_A2)&gt;&gt; LOG_GROUP_A2)* MASK_A2\</span><br><span class="line">       |((in##_GROUP &amp; GROUP_B2)&gt;&gt; LOG_GROUP_B2)* MASK_B2\</span><br><span class="line">       |((in##_GROUP &amp; GROUP_C2)&gt;&gt; LOG_GROUP_C2)* MASK_C2) &lt;&lt; in##_SHIFT)</span><br></pre></td></tr></table></figure>
<h3 id="示例">示例</h3>
<p>如下图所示，1~8的LED灯珠都与一个处理器针脚相连。DPI和DAI在此处并没有严格划分界限，但是用法上仍有些差异，如前三个LED连接的是DPI针脚，其函数<code>SRU()</code>的第一个参数写的是 <code>FLAG</code>，而其他 DAI 的第一个参数是 <code>LOW</code> 。</p>
<p><img src="https://pic.islet.space/2021/05/20210520113348.png" alt="image-20210520113025876" style="zoom:50%;" /></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">void Init_LEDs(void)</span><br><span class="line">&#123;</span><br><span class="line">	&#x2F;* 设置SRU和路由，使标志引脚连接到DPI引脚缓冲区 *&#x2F;</span><br><span class="line"></span><br><span class="line">	&#x2F;* 只使用标志4至15，标志0至3在DPI上不可用。 *&#x2F;</span><br><span class="line"></span><br><span class="line">	SRU(FLAG4_O,DPI_PB06_I);	&#x2F;* 将 Flag4 输出 连接到 DPI_PB06 输入（用于LED1） *&#x2F;</span><br><span class="line">	SRU(FLAG5_O,DPI_PB13_I);	&#x2F;* 将 Flag5 输出 连接到 DPI_PB13 输入（用于LED2） *&#x2F;</span><br><span class="line">	SRU(FLAG6_O,DPI_PB14_I);	&#x2F;* 将 Flag6 输出 连接到 DPI_PB14 输入（用于LED3） *&#x2F;</span><br><span class="line"></span><br><span class="line">	SRU(LOW,DAI_PB03_I);	    &#x2F;* connect Input LOW to LED4 *&#x2F;</span><br><span class="line">	SRU(LOW,DAI_PB04_I);    	&#x2F;* connect Input LOW to LED5 *&#x2F;</span><br><span class="line">	SRU(LOW,DAI_PB15_I);		&#x2F;* connect Input LOW to LED6 *&#x2F;</span><br><span class="line">	SRU(LOW,DAI_PB16_I);		&#x2F;* connect Input LOW to LED7 *&#x2F;</span><br><span class="line">	SRU(LOW,DAI_PB17_I);		&#x2F;* connect Input LOW to LED8 *&#x2F;</span><br><span class="line"></span><br><span class="line">	&#x2F;* 使用以下顺序启用缓冲器：高电平-&gt;输出，低电平-&gt;输入 *&#x2F;</span><br><span class="line"></span><br><span class="line">	SRU(HIGH,DPI_PBEN06_I);		&#x2F;* LED1 *&#x2F;</span><br><span class="line">	SRU(HIGH,DPI_PBEN13_I);		&#x2F;* LED2 *&#x2F;</span><br><span class="line">	SRU(HIGH,DPI_PBEN14_I);		&#x2F;* LED3 *&#x2F;</span><br><span class="line">	SRU(HIGH,PBEN03_I);			&#x2F;* LED4 *&#x2F;</span><br><span class="line">	SRU(HIGH,PBEN04_I);			&#x2F;* LED5 *&#x2F;</span><br><span class="line">	SRU(HIGH,PBEN15_I);			&#x2F;* LED6 *&#x2F;</span><br><span class="line">	SRU(HIGH,PBEN16_I);			&#x2F;* LED7 *&#x2F;</span><br><span class="line">	SRU(HIGH,PBEN17_I);			&#x2F;* LED8 *&#x2F;</span><br><span class="line"></span><br><span class="line">	&#x2F;* 将标志引脚设置为输出 *&#x2F;</span><br><span class="line">	sysreg_bit_set( sysreg_FLAGS, (FLG4O|FLG5O|FLG6O) );</span><br><span class="line"></span><br><span class="line">	&#x2F;* 清除标志引脚 *&#x2F;</span><br><span class="line">	sysreg_bit_clr( sysreg_FLAGS, (FLG4|FLG5|FLG6) );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="定时器">定时器</h2>
<p>《ADSP-21477_21478_21479_cn》</p>
<figure>
<img src="https://pic.islet.space/2021/06/20210611170206.png" alt="image-20210611170204474" /><figcaption aria-hidden="true">image-20210611170204474</figcaption>
</figure>
<figure>
<img src="https://pic.islet.space/2021/06/20210611170307.png" alt="image-20210611170253655" /><figcaption aria-hidden="true">image-20210611170253655</figcaption>
</figure>
<figure>
<img src="https://pic.islet.space/2021/06/20210611170344.png" alt="image-20210611170342735" /><figcaption aria-hidden="true">image-20210611170342735</figcaption>
</figure>
<figure>
<img src="https://pic.islet.space/2021/06/20210611170357.png" alt="image-20210611170355842" /><figcaption aria-hidden="true">image-20210611170355842</figcaption>
</figure>
<h3 id="创建定时器">创建定时器</h3>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Install and enable a handler for the high priority core timer interrupt.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">adi_int_InstallHandler(ADI_CID_TMZHI, <span class="comment">/*iid - high priority core timer */</span></span><br><span class="line">		               timer_isr,     <span class="comment">/*handler*/</span></span><br><span class="line">		               (<span class="keyword">void</span> *)&amp;timer_isr_count1, <span class="comment">/*handler parameter*/</span></span><br><span class="line">		                <span class="literal">true</span>           <span class="comment">/*do enable*/</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="定时器中断句柄">定时器中断句柄</h3>
<p>来自实例《core_timer》:</p>
<ul>
<li>在定时器中断句柄 <code>timer_isr</code> 里面，不能调用标准IO函数，或者更新非volatile全局变量</li>
<li>可以使用处理程序参数来识别被处理的中断 <code>iid</code>，并通过中断特定的回调指针参数 <code>handlerArg</code> 来访问数据。</li>
</ul>
<figure>
<img src="https://pic.islet.space/2021/06/20210621154021.png" alt="image-20210612151008408" /><figcaption aria-hidden="true">image-20210612151008408</figcaption>
</figure>
<h1 id="examples">EXAMPLES</h1>
<h2 id="exp1">EXP1</h2>
<p>本案例使用麦克风采集信号并从前两个通道输入，经过信号增益放大器调整后经过立体声通道输出。</p>
<p>具体步骤如下：</p>
<ol type="1">
<li>从左侧 <strong>树状工具箱</strong>(TreeToolBox)中拖出1772和USBi，并进行连接。</li>
</ol>
<p><img src="https://pic.islet.space/2021/05/image-20210428094527305.png" alt="image-20210428094527305" style="zoom: 67%;" /></p>
<ol start="2" type="1">
<li>在 <strong>原理图（SCHEMATIC)</strong> <img src="https://pic.islet.space/2021/05/image-20210506150111553.png" alt="image-20210506150111553" style="zoom:80%;" />中需要对输入输出路径进行定义，在此处定义的所有图形编程内容都是对 <strong>可编程增益放大器（PGA）</strong>的使用，即此处的输入到输出所有内容都不经过 <strong>信号通路（SIGNAL ROUTING）</strong> 选项卡中的 <strong>音频处理核心（AUDIO PROCESSING CORE）</strong>，是由 <strong>核心输入选择器（CORE INPUT SELECTION）</strong>完成的，<mark>也可以理解为PGA就是在其中，且PGA的设置在原理图中进行。</mark></li>
</ol>
<p><img src="https://pic.islet.space/2021/05/image-20210506145903478.png" alt="image-20210506145903478" style="zoom:67%;" /></p>
<ol start="3" type="1">
<li>在原理图中，从左侧 <img src="https://pic.islet.space/2021/05/image-20210506150230833.png" alt="image-20210506150230833" style="zoom:80%;" /> 拖出组件并连线如下，其中需要用到四个通道中的第1及第2通道，每个通告分别连接到一个 <strong>线性增益器（LINEAR GAIN）</strong>，增益50分贝，将原本的麦克风信号从-60分贝左右提升一下。然后经过 <strong>全通角过滤器（ALL POLE FILTER）</strong>,对1500Hz以下的声音增益10分贝。再经过 <strong>分线器（T CONNECTION）</strong>，将信号分别传输给 <strong>分贝显示器（DISPLAY DBREG）</strong>及 <strong>输出通道（OUTPUT）</strong>。</li>
</ol>
<p><img src="https://pic.islet.space/2021/05/image-20210428095433721.png" alt="image-20210428095433721" style="zoom:80%;" /></p>
<p><img src="https://pic.islet.space/2021/05/image-20210506144919655.png" alt="image-20210506144919655" style="zoom: 80%;" /></p>
<ol start="4" type="1">
<li>另，PGA的设置还需要在 <strong>PGA/ADC</strong> 选项卡中进行设置：</li>
</ol>
<ul>
<li>启用<strong>PGA<sub>x</sub></strong> 及 <strong>PGA<sub>x</sub> Boost</strong></li>
<li>启用 <strong>Mic<sub>x</sub> Bias</strong></li>
<li>调整 各通道的增益大小等</li>
</ul>
<p><img src="https://pic.islet.space/2021/05/image-20210506145534521.png" alt="image-20210506145534521" style="zoom:80%;" /></p>
<ol start="5" type="1">
<li>对 <strong>信号通路</strong> 选项卡进行设置，使信号不经过 <strong>音频处理核心</strong> ，启用 <strong>输出ASRC源选择器（OUTPUT ASRC SOURCE SELECT）</strong> ，信号经流如图示：</li>
</ol>
<p><img src="https://pic.islet.space/2021/05/image-20210506150516695.png" alt="image-20210506150516695" style="zoom: 80%;" /></p>
<ol start="6" type="1">
<li>​ 如果设置芯片使用，可以在 <strong>芯片控制（CHIP CONTROL）</strong>选项卡中设置性能增强模式</li>
</ol>
<p><img src="https://pic.islet.space/2021/05/image-20210506151533990.png" alt="image-20210506151533990" style="zoom:80%;" /></p>
<ol start="7" type="1">
<li>接入正常的TS接口麦克风即可输入正常波形。</li>
</ol>
<h2 id="exp2">EXP2</h2>
<p>本案例为PLL及时钟案例，首先需要明确以下几点：</p>
<ol type="1">
<li>1772的工作频率为12.288兆赫，PLL的输出频率被要求一定是24.576兆赫。</li>
<li>且从MCLKIN输入的频率范围为8至27兆赫，可以通过整数或分数分频来获得1772所需的工作频率（最终必须是12.288兆赫）。</li>
<li>通过设置4个参数 <code>x</code> 、<code>R</code>、<code>N</code> 及 <code>M</code> 对PLL进行参数调整，其中整数倍分频时只有在 <code>MCLKIN = 12.288MHz</code> 或 <code>MCLKIN = 24.576MHz</code> 时可用。</li>
</ol>
<p>已知，MCLK的输入频率16.625MHz，符合输入范围要求，以及最终目标输出频率24.576MHz。</p>
<p>首先启用PLL，点击<img src="https://pic.islet.space/2021/05/image-20210513100438475.png" alt="image-20210513100438475" style="zoom: 67%;" />，然后通过对 <code>PLL M and N Calculator</code> 进行设置，并点击 <code>Load Parameters</code> 进行自动计算和加载即可。</p>
<p>在主时钟源选项（Main Clock Source）中选择经过PLL处理的时钟源，并设置主时钟和核心时钟的分频率为 1/2即可。</p>
<p>从旁边也可以看到自动计算出来的分频系数：<img src="https://pic.islet.space/2021/05/image-20210513100800163.png" alt="image-20210513100800163" /></p>
<figure>
<img src="https://pic.islet.space/2021/05/image-20210513100908671.png" alt="image-20210513100908671" /><figcaption aria-hidden="true">image-20210513100908671</figcaption>
</figure>
<p>除了可以直接应用 SigmaStudio 的 <code>load parameters</code> 直接进行参数计算外，可以参考《在linux上编写求解ADAU1772的PLL系数》文章，自行系数计算。</p>
<h2 id="exp3">EXP3</h2>
<p>本例中主要完成TWI代码的编写，具体可以参见《I2C通信》笔记。以下是一开始的开发思路：</p>
<p>利用ADI官方提供（导出）的C代码，通过I2C协议向ADAU1772 codec芯片写入寄存器值，在ADAU寄存器写入的C代码中，依赖头文件<code>&lt;SigmaStudioFW.h&gt;</code>，其所有宏定义类型的函数都需要用户自行定义。</p>
<figure>
<img src="https://pic.islet.space/2021/05/20210520095649.png" alt="image-20210520095648245" /><figcaption aria-hidden="true">image-20210520095648245</figcaption>
</figure>
<h3 id="arduino示例">Arduino示例</h3>
<p>在Github上的 <strong><a target="_blank" rel="noopener" href="https://github.com/ColeMahlowitz/ADAU1761-Self-Boot-With-Arduino">ADAU1761-Self-Boot-With-Arduino</a></strong> 中，适用于 Arduino 和 ADAU1761 的寄存器块（WRITE_REGISTER_BLOCK）定义实例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">void SIGMA_WRITE_REGISTER_BLOCK(byte IC_address, word subAddress, int dataLength, byte pdata[]) &#123;</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; start I2C transfer</span><br><span class="line">  if (!i2c_start((IC_address)|I2C_WRITE)) &#123; </span><br><span class="line">    Serial.println(&quot;I2C device busy for WRITE REGISTER BLOCK&quot;);</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; write subAddresses. (ADAU1761 needs the 16 bit subAddress written as two 8 bit bytes with an &quot;ACK&quot; inbetween</span><br><span class="line">  uint8_t addressLowByte &#x3D; subAddress &amp; 0xff;</span><br><span class="line">  uint8_t addressHighByte &#x3D; (subAddress &gt;&gt; 8);</span><br><span class="line"></span><br><span class="line">  i2c_write(addressHighByte); </span><br><span class="line">  i2c_write(addressLowByte); </span><br><span class="line"></span><br><span class="line">  if (dataLength &lt; 50 ) &#123;</span><br><span class="line">    for (int i&#x3D;0; i&lt;dataLength; i++) &#123; </span><br><span class="line">      i2c_write(pdata[i]); &#x2F;&#x2F;write data bytes</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  else &#123; </span><br><span class="line">    for (int i&#x3D;0; i&lt;dataLength; i++) &#123;</span><br><span class="line">      i2c_write(pgm_read_byte_near(pdata + i)); &#x2F;&#x2F;write data bytes from PROGMEM (for param and program data)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  i2c_stop(); &#x2F;&#x2F; stop the I2C communication</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在MBED网站中，大量往右对ADAU1701的 <code>&lt;SigmaStudioFW.h&gt;</code> 提供了支持，原网页如：<a target="_blank" rel="noopener" href="https://os.mbed.com/forum/electronics/topic/4784/">ADAU1701</a></p>
<p>将宏定义改为函数形式：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SIGMA_WRITE_REGISTER_BLOCK</span><span class="params">(<span class="keyword">int</span> devAddress, <span class="keyword">int</span> address, <span class="keyword">int</span> length, ADI_REG_TYPE *pData )</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ii = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> zz = <span class="number">0</span>;</span><br><span class="line">    Tx_Idx = <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*----- Transmission Phase -----*/</span></span><br><span class="line">    ThisBufferSize = Address_Length + length; </span><br><span class="line"> </span><br><span class="line">    I2C1_Buffer_Tx[<span class="number">0</span>] =   (address &amp; <span class="number">0xFF00</span>)&gt;&gt;<span class="number">8</span>;</span><br><span class="line">    I2C1_Buffer_Tx[<span class="number">1</span>] =   address &amp; <span class="number">0x00FF</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">for</span>(zz=<span class="number">0</span>;zz&lt;length;zz++)&#123;</span><br><span class="line">    	I2C1_Buffer_Tx [zz + Address_Length] =   pData[zz];</span><br><span class="line">    &#125; </span><br><span class="line">    Tx_Idx = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(ii =<span class="number">0</span>;ii &lt; ThisBufferSize;ii++)&#123;    </span><br><span class="line">        NextBufferEnd =  ThisBufferSize;<span class="comment">//I2C1_numbytes[ii];    </span></span><br><span class="line">        <span class="keyword">if</span>(ii == <span class="number">0</span>)&#123;</span><br><span class="line">            I2C_GenerateSTART(I2C1, ENABLE);</span><br><span class="line">        &#125; </span><br><span class="line">        <span class="comment">/* Send data */</span></span><br><span class="line">        <span class="keyword">while</span>(Tx_Idx &lt; NextBufferEnd)   </span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">        &#125;   </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SIGMA_WRITE_DELAY</span><span class="params">(<span class="keyword">int</span> devAddress, <span class="keyword">int</span> length, ADI_REG_TYPE *pData )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> nCount=<span class="number">0</span>;</span><br><span class="line">    nCount=<span class="number">0xFFFFF</span>;</span><br><span class="line">    <span class="keyword">for</span>(; nCount != <span class="number">0</span>; nCount--);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>具体的代码已经贴在《I2C通信》了，21478和21479支持TWI的寄存器控制，但是更为复杂，官方没有给示例，因此使用了引脚高低高低电平的控制来实现通信。</p>
<h3 id="数字逻辑分析仪">数字逻辑分析仪</h3>
<p>在EXP3中会频繁采集I2C、I2S、SPI等通信协议发过来的数据，因此需要使用数字逻辑分析仪进行数据采集和分析，在本次开发过程中使用了两种数字逻辑分析仪，分别是 <strong><em>USBee Suite</em></strong> 和 <strong><em>Saleae Logic</em></strong> ，推荐使用后者，软件更夹稳定、成熟和易使用。如果采用前者，那么软件经常崩溃。后者在采集I2S等高速通信协议中的电平信号时，需要将采样速率提升一下，24MS/s 的速度仍然能会采样变形。</p>
<figure>
<img src="https://pic.islet.space/2021/06/20210623161904.png" alt="image-20210623134058687" /><figcaption aria-hidden="true">image-20210623134058687</figcaption>
</figure>
<figure>
<img src="https://pic.islet.space/2021/06/20210623161909.png" alt="image-20210623134114244" /><figcaption aria-hidden="true">image-20210623134114244</figcaption>
</figure>
<figure>
<img src="https://pic.islet.space/2021/06/20210623161911.png" alt="image-20210623133953887" /><figcaption aria-hidden="true">image-20210623133953887</figcaption>
</figure>
<p>​</p>
<figure>
<img src="https://pic.islet.space/2021/06/20210623161914.png" alt="image-20210623134006076" /><figcaption aria-hidden="true">image-20210623134006076</figcaption>
</figure>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>感谢您的支持和鼓励</div>
  <button>
    Donate
  </button>
  <div class="post-reward">
      <div>
        <img src="https://photo.islet.space/2021/00/IMG_4588.JPG" alt="Liewzheng WeChat Pay">
        <span>WeChat Pay</span>
      </div>
      <div>
        <img src="https://photo.islet.space/2021/00/IMG_4590.JPG" alt="Liewzheng Alipay">
        <span>Alipay</span>
      </div>

  </div>
</div>

          <div class="post-tags">
              <a href="/tags/ADI/" rel="tag"># ADI</a>
          </div>

        

  <div id="vcomments" style="margin: 1rem 0 0 0;"></div>
  <script>
    new Valine({
      el: '#vcomments',
      appId: 'vRGM12EcYxDSM2lat5qjjSeY-gzGzoHsz',
      appKey: 'WBgAb6NTAFQ7DYtgH0uOPNNh'
    })
  </script>
          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2021/04/22/Linux/System/2021-04-22-Linux%E5%88%86%E5%8C%BA%E5%8F%8A%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/" rel="prev" title="Linux分区及文件系统">
                  <i class="fa fa-chevron-left"></i> Linux分区及文件系统
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2021/04/23/Linux/GCC/2021-04-23-How%20to%20Install%20GCC%20(build-essential)%20on%20Ubuntu%2020.04/" rel="next" title="How to Install GCC (build-essential) on Ubuntu 20.04">
                  How to Install GCC (build-essential) on Ubuntu 20.04 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>







</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">粤ICP备19004822号 </a>
  </div>

<div class="copyright">
  &copy; 2019 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">liewzheng</span>
</div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  





  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":"enable","tags":"none","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
