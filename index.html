<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="next-config" data-name="main" type="application/json">{&quot;hostname&quot;:&quot;islet.space&quot;,&quot;root&quot;:&quot;&#x2F;&quot;,&quot;images&quot;:&quot;&#x2F;images&quot;,&quot;scheme&quot;:&quot;Gemini&quot;,&quot;version&quot;:&quot;8.3.0&quot;,&quot;exturl&quot;:false,&quot;sidebar&quot;:{&quot;position&quot;:&quot;left&quot;,&quot;display&quot;:&quot;post&quot;,&quot;padding&quot;:18,&quot;offset&quot;:12},&quot;copycode&quot;:false,&quot;bookmark&quot;:{&quot;enable&quot;:false,&quot;color&quot;:&quot;#222&quot;,&quot;save&quot;:&quot;auto&quot;},&quot;fancybox&quot;:false,&quot;mediumzoom&quot;:false,&quot;lazyload&quot;:false,&quot;pangu&quot;:false,&quot;comments&quot;:{&quot;style&quot;:&quot;tabs&quot;,&quot;active&quot;:null,&quot;storage&quot;:true,&quot;lazyload&quot;:false,&quot;nav&quot;:null},&quot;motion&quot;:{&quot;enable&quot;:true,&quot;async&quot;:false,&quot;transition&quot;:{&quot;post_block&quot;:&quot;fadeIn&quot;,&quot;post_header&quot;:&quot;fadeInDown&quot;,&quot;post_body&quot;:&quot;fadeInDown&quot;,&quot;coll_header&quot;:&quot;fadeInLeft&quot;,&quot;sidebar&quot;:&quot;fadeInUp&quot;}},&quot;prism&quot;:false,&quot;i18n&quot;:{&quot;placeholder&quot;:&quot;Searching...&quot;,&quot;empty&quot;:&quot;We didn&#39;t find any results for the search: ${query}&quot;,&quot;hits_time&quot;:&quot;${hits} results found in ${time} ms&quot;,&quot;hits&quot;:&quot;${hits} results found&quot;}}</script>
<meta name="description" content="笔记分享的旮旯孤岛而已">
<meta property="og:type" content="website">
<meta property="og:title" content="Coder的孤岛">
<meta property="og:url" content="http://islet.space/index.html">
<meta property="og:site_name" content="Coder的孤岛">
<meta property="og:description" content="笔记分享的旮旯孤岛而已">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Liewzheng">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://islet.space/">



<script class="next-config" data-name="page" type="application/json">{&quot;sidebar&quot;:&quot;&quot;,&quot;isHome&quot;:true,&quot;isPost&quot;:false,&quot;lang&quot;:&quot;en&quot;,&quot;comments&quot;:&quot;&quot;,&quot;permalink&quot;:&quot;&quot;,&quot;path&quot;:&quot;index.html&quot;,&quot;title&quot;:&quot;&quot;}</script>

<script class="next-config" data-name="calendar" type="application/json">&quot;&quot;</script>
<title>Coder的孤岛</title><script src="/js/config.js"></script>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Coder的孤岛</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">islet of the coder</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-文章"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>文章</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Liewzheng</p>
  <div class="site-description" itemprop="description">笔记分享的旮旯孤岛而已</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">56</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">17</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">109</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="mailto:liewzheng@qq.com" title="E-Mail → mailto:liewzheng@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i></a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://islet.space/2021/05/21/Programing/C++/2021-05-21-How-to-Use-the-C-Preprocessors-#error-Directive/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liewzheng">
      <meta itemprop="description" content="笔记分享的旮旯孤岛而已">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder的孤岛">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/05/21/Programing/C++/2021-05-21-How-to-Use-the-C-Preprocessors-#error-Directive/" class="post-title-link" itemprop="url">How to Use the C Preprocessor's error Directive</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-05-21 23:40:32" itemprop="dateCreated datePublished" datetime="2021-05-21T23:40:32+08:00">2021-05-21</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-05-22 00:06:30" itemprop="dateModified" datetime="2021-05-22T00:06:30+08:00">2021-05-22</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Programing/" itemprop="url" rel="index"><span itemprop="name">Programing</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a target="_blank" rel="noopener" href="https://barrgroup.com/embedded-systems/how-to/c-preprocessor-error-directive">barrgroup.com</a></p>
<p>One of the least used but potentially most useful features of the C  preprocessor is the <em><strong>ANSI-specified #error directive</strong></em>. Here’s a look at a couple of clever uses for <code>#error</code> that have proven invaluable in embedded software development.</p>
<p>The syntax of <code>#error</code> is very straightforward:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">error</span> <span class="meta-string">&lt;writer supplied error message&gt;</span>  <span class="comment">//开发者提供的错误信息</span></span></span><br></pre></td></tr></table></figure>

<p><code>&lt;writer supplied error message&gt;</code> 中可包含任何可显示的文本，甚至不需要使用双引号 <code>&quot;&quot;</code> 。</p>
<blockquote>
<p>The <code> &lt;writer supplied error message&gt;</code> can consist of any  printable text. You don’t even have to enclose the text in quotes.  (Technically, the message is optional–though it rarely makes sense to omit it.)</p>
</blockquote>
<p>当C预处理器遇到 <code>#error</code> 语句时，会将停止编译，并将错误信息输出至 <code>stderr</code> 文件。C编译器的典型错误信息如下：</p>
<blockquote>
<p>When the C preprocessor encounters a <code>#error</code> statement, it causes  compilation to terminate and the writer-supplied error message to be  printed to <a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/Standard_streams">stderr (link is external)</a>. A typical error message from a C compiler looks like this:</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Filename(line_number): Error! </span><br><span class="line">Ennnn: &lt;writer supplied error message&gt; </span><br></pre></td></tr></table></figure>

<p>where Filename is the source file name, <code>line_number</code> is the line  number where the <code>#error</code> statement is located, and <code>Ennnn</code> is a  compiler-specific error number. Thus, the <code>#error</code> message is basically  indistinguishable from ordinary compiler error messages.</p>
<p>“Wait a minute,” you might say. “I spend enough time trying to get  code to compile and now he wants me to do something that causes more  compiler errors?” Absolutely! The essential point is that code that compiles but is incorrect is worse than useless. I’ve found three  general areas in which this problem can arise and <code>#error</code> can help. Read  on and see if you agree with me.</p>
<h2 id="Incomplete-code"><a href="#Incomplete-code" class="headerlink" title="Incomplete code"></a>Incomplete code</h2><p>I tend to code using a step-wise refinement approach, so it isn’t  unusual during development for me to have functions that do nothing, for loops that lack a body, and so forth. Consequently, I often have files  that are compilable but lack some essential functionality. Working this  way is fine, until I’m pulled off to work on something else (an  occupational hazard of being in the consulting business). Because these  distractions can occasionally run into weeks, I sometimes return to the  job with my memory a little hazy about what I haven’t completed. In the  worst-case scenario (which has occurred), I perform a make, which runs  happily, and then I attempt to use the code. The program, of course,  crashes and burns, and I’m left wondering where to start.</p>
<p>In the past, I’d comment the file to note what had been done and what was still needed. However, I found this approach to be rather weak  because I then had to read all my comments (and I comment heavily) in  order to find what I was looking for. Now I simply enter something like  the following in an appropriate place in the file:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#error *** Nigel - Function incomplete. Fix before using *** </span><br></pre></td></tr></table></figure>

<p>Thus, if I forget that I haven’t done the necessary work, an  inadvertent attempt to use the file will result in just about the most  meaningful compiler message I’ll ever receive. Furthermore, it saves me  from having to wade through pages of comments, trying to find what work I haven’t finished.</p>
<h2 id="Compiler-dependent-code"><a href="#Compiler-dependent-code" class="headerlink" title="Compiler-dependent code"></a>Compiler-dependent code</h2><p>As much as I strive to write portable code, I often find myself  having to trade off performance for portability - and in the embedded  world, performance tends to win. However, what happens if a few years  later I reuse some code without remembering that the code has <em><strong>compiler-specific peculiarities</strong></em>? The result is a much longer debug  session than is necessary. But a <em><strong>judicious</strong></em> <code>#error</code> statement can prevent a lot of grief. A couple of examples may help.</p>
<h3 id="Example-1"><a href="#Example-1" class="headerlink" title="Example 1"></a>Example 1</h3><p>Some floating-point code requires at least 12 digits of resolution to return the correct results. Accordingly, the various variables are defined as type long double. But <em><strong>ISO C</strong></em> only requires that <em><u>a long double have 10 digits of resolution</u></em>. Thus on certain machines, a long double may be <em><strong>inadequate</strong></em> to do the job. To protect against this, I would  include the following:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;float.h&gt;</span><br><span class="line">#if (LDBL_DIG &lt; 12) </span><br><span class="line">	#error *** long doubles need 12 digit resolution.</span><br><span class="line">	Do not use this compiler! *** </span><br><span class="line">#endif </span><br></pre></td></tr></table></figure>

<p>This approach works by examining the value of an ANSI-mandated constant found in <a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/Float.h">float.h (link is external)</a>.</p>
<h3 id="Example-2"><a href="#Example-2" class="headerlink" title="Example 2"></a>Example 2</h3><p>An amazing amount of code makes invalid assumptions about the  underlying size of the various integer types. If you have code that has to use an int (as opposed to a user-specified data type such as <code>int16</code>),  and the code assumes that an int is 16 bits, you can do the following:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;limits.h&gt;</span><br><span class="line">#if (INT_MAX !&#x3D; 32767) </span><br><span class="line">	#error *** This file only works with 16-bit int.</span><br><span class="line">	Do not use this compiler! *** </span><br><span class="line">#endif </span><br></pre></td></tr></table></figure>

<p>Again, this works by checking the value of an ANSI-mandated constant. This time the constant is found in the file <a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/Limits.h">limits.h (link is external)</a>. This approach is a lot more useful than putting these limitations  inside a big comment that someone may or may not read. After all, you have to read the compiler error messages.</p>
<h2 id="Conditionally-compiled-code"><a href="#Conditionally-compiled-code" class="headerlink" title="Conditionally-compiled code"></a>Conditionally-compiled code</h2><p>Since conditionally compiled code seems to be a necessary evil in embedded programming, it’s common to find code sequences such as the  following:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#if defined OPT_1 </span><br><span class="line">	&#x2F;* Do option_1 *&#x2F; </span><br><span class="line">#else </span><br><span class="line">	&#x2F;* Do option_2 *&#x2F; </span><br><span class="line">#endif </span><br></pre></td></tr></table></figure>

<p>As it is written, this code means the following: if and only if OPT_1 is defined, we will do option_1; otherwise we’ll do option_2. The  problem with this code is that a user of the code doesn’t know (without explicitly examining the code) that OPT_1 is a valid compiler switch.  Instead, the naive user will simply compile the code without defining OPT_1 and get the alternate implementation, irrespective of whether  that is what’s required or not. A more considerate coder might be aware  of this problem, and instead do the following:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#if defined OPT_1 </span><br><span class="line">	&#x2F;* Do option 1 *&#x2F; </span><br><span class="line">#elif defined OPT_2 </span><br><span class="line">	&#x2F;* Do option 2*&#x2F; </span><br><span class="line">#endif </span><br></pre></td></tr></table></figure>

<p>In this case, failure to define either OPT_1 or OPT_2 will typically  result in an obscure compiler error at a point later in the code. The  user of this code will then be stuck with trying to work out what must  be done to get the module to compile. This is where #error comes in.  Consider the following code sequence:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#if defined OPT_1 </span><br><span class="line">	&#x2F;* Do option_1 *&#x2F; </span><br><span class="line">#elif defined OPT_2 </span><br><span class="line">	&#x2F;* Do option_2 *&#x2F; </span><br><span class="line">#else </span><br><span class="line">	#error *** You must define one of OPT_1 or OPT_2 *** </span><br><span class="line">#endif </span><br></pre></td></tr></table></figure>

<p>Now the compilation fails, but at least it tells the user explicitly  what to do to make the module compile. I know that if this procedure had been adopted universally, I would have saved a lot of time over the  years trying to reuse other people’s code.</p>
<p>So there you have it. Now tell me, don’t you agree that <code>#error</code> is a  really useful part of the preprocessor, worthy of your frequent use-and  occasional praise?</p>
<p>​          </p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://islet.space/2021/05/21/Linux/2021-05-21-Equipments_in_debian_linux/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liewzheng">
      <meta itemprop="description" content="笔记分享的旮旯孤岛而已">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder的孤岛">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/05/21/Linux/2021-05-21-Equipments_in_debian_linux/" class="post-title-link" itemprop="url">Equipments in Debian Linux(KALI)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-05-21 20:30:00" itemprop="dateCreated datePublished" datetime="2021-05-21T20:30:00+08:00">2021-05-21</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-05-22 22:07:43" itemprop="dateModified" datetime="2021-05-22T22:07:43+08:00">2021-05-22</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h1><p>作为一个日常开发的程序员，三大平台都在日常使用的软件（生产力工具及娱乐工具）如下：</p>
<ul>
<li>utools</li>
<li>typora</li>
<li>visual studio code</li>
<li>picgo</li>
<li>sogou pinyin</li>
<li>snipaste(win) / flameshot(linux) / ishot(mac)</li>
<li>cosbrowser</li>
<li>nodejs 及 npm</li>
<li>hexo</li>
<li>qqmusic</li>
</ul>
<p>win和mac安装软件都相对简单，linux安装需要使用者自身具有一定的耐心和排除困难的经验，为了更好地体验linux的方便，这里对linux装机后的生产力工具安装做个简单记录，以下安装均在 <strong>KALI</strong> （Kali也属于Debian系Linux）上进行。</p>
<p>使用Linux系统的最大好处是 “一个终端即可解决即可开启大部分软件和解决日常事务，最多再开启一个utools”。</p>
<p>Linux上的软件安装方式通常分为四种方式：</p>
<ul>
<li>通过 <code>dpkg</code> 命令安装 <code>.deb</code> 文件</li>
<li>通过 <code>apt</code> 或其他软件的软件安装命令（如，<code>npm</code> 和 <code>pip</code>）来安装</li>
<li>通过 <code>ln</code> 链接将程序绑定至全局变量来 “安装” 和使用</li>
<li>通过直接调用 <code>AppImage</code> 的方式直接使用软件，此类方式需要一般需要手动双击执行</li>
</ul>
<p>其中前三种方式的困难因系统而异，所说的困难是可能出现所安装的软件依赖不存在，需要使用者自行去定位（包括下载和添加源）和安装，或者链接方式错误等。而Linux源众多，每个节点的速度及其更新情况都不太一样，需要使用者判断。</p>
<h1 id="uTools-amp-Flameshot"><a href="#uTools-amp-Flameshot" class="headerlink" title="uTools &amp; Flameshot"></a>uTools &amp; Flameshot</h1><p><a target="_blank" rel="noopener" href="https://res.u-tools.cn/currentversion/utools_1.3.5_amd64.deb">uTools</a> 使用的是 <code>.deb</code> 安装包安装，flameshot 使用 <code>apt</code> 命令进行安装。</p>
<p><strong>依赖文件</strong>：</p>
<ol>
<li><code>libspdlog1-fmt7</code> 是 flameshot所需文件</li>
<li><code>libappindicator3-1</code> 是 utools所需文件</li>
</ol>
<h2 id="libspdlog1"><a href="#libspdlog1" class="headerlink" title="libspdlog1"></a>libspdlog1</h2><p>尝试安装utools和flameshot后，apt会提示缺少文件。使用 <code>sudo apt-get install libspdlog1-fmt7</code> 来安装 <code>libspdlog1-fmt7</code> 。</p>
<p>如果触发安装破损修复，使用<code>apt --fix-broken install</code> 可以让apt自动修复安装错误，自动补全依赖文件。</p>
<h2 id="libappindicator3"><a href="#libappindicator3" class="headerlink" title="libappindicator3"></a>libappindicator3</h2><p><code>libappindicator3-1</code> 文件需要使用者往 <code>/etc/apt/source.list</code> 中添加debian源，需要使用者掌握基本的 <code>vim</code> 软件使用方法（包括插入、保存和退出）。</p>
<ul>
<li><p>使用 <code>sudo vim /etc/apt/sources.list</code> 命令打开 <code>source.list</code> 。</p>
</li>
<li><p>按 <code>i</code> 进入 <strong>插入模式</strong>，复制粘贴 <code>deb http://ftp.de.debian.org/debian sid main</code> 至空白处，按 <code>ESC</code> 键，再依次输入 <code>:wq</code> 进行保存和退出。</p>
</li>
<li><p>在终端输入 <code>sudo apt-get update</code> 进行源库软件列表更新，再次尝试 <code>sudo apt-get install libappindicator3</code> 来安装</p>
<p> <code>libappindicator3-1</code> and <code>libappindicator3-7</code> 。</p>
</li>
</ul>
<p>最后再次尝试以下两条语句即可成功安装 utools 和 flameshot 。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo dpkg -i utools_1.3.5_amd64.deb</span><br><span class="line">sudo apt-get install flameshot</span><br></pre></td></tr></table></figure>





<h1 id="Typora"><a href="#Typora" class="headerlink" title="Typora"></a>Typora</h1><p><a target="_blank" rel="noopener" href="https://tyopra.io/">TYPORA.IO</a> 官方提供的安装代码如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys BA300B7755AFCFAE</span><br><span class="line">sudo add-apt-repository <span class="string">&#x27;deb https://typora.io/linux ./&#x27;</span></span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install typora</span><br></pre></td></tr></table></figure>



<p>其中，向apt中添加源的第二条语句 <code>add-apt-repository</code> 会因缺乏 <code>PPA</code> 而无法执行，可以参考 <a target="_blank" rel="noopener" href="https://ywnz.com/linuxjc/7953.html#:~:text=%E6%9C%89%E4%BA%9B%E7%94%A8%E6%88%B7%E5%9C%A8UOS%E3%80%81Deepin%E7%AD%89%E6%9F%90%E4%BA%9BLinux%E5%8F%91%E8%A1%8C%E7%89%88%E7%BB%88%E7%AB%AF%E4%B8%AD%E8%BE%93%E5%85%A5PPA%E5%91%BD%E4%BB%A4%E6%97%B6%E4%BC%9A%E6%8F%90%E7%A4%BA%E2%80%9Csudo%3A%20add-apt-repository%EF%BC%9A%E6%89%BE%E4%B8%8D%E5%88%B0%E5%91%BD%E4%BB%A4%EF%BC%88command,not%20found%EF%BC%89%E2%80%9D%EF%BC%8C%E8%BF%99%E6%98%AF%E5%9B%A0%E4%B8%BA%E6%B2%A1%E6%9C%89%E5%AE%89%E8%A3%85PPA%E6%89%80%E8%87%B4%EF%BC%8C%E6%8A%8A%E5%AE%83%E5%AE%89%E8%A3%85%E4%B8%8A%E5%B0%B1%E5%8F%AF%E4%BB%A5%E4%BA%86%EF%BC%8C%E5%8F%AA%E9%9C%80%E8%A6%81%E5%9C%A8%E7%BB%88%E7%AB%AF%E4%B8%AD%E8%BF%90%E8%A1%8C%E4%B8%89%E6%9D%A1%E5%91%BD%E4%BB%A4%E3%80%82">sudo: add-apt-repository：找不到命令的解决方法</a> 进行安装。</p>
<p>也可以参考 <code>libappindicator3</code> 的源添加方法，往 <code>source.list</code> 文件中添加 <code>deb https://typora.io/linux ./</code> 来添加源。</p>
<p>添加成功后即可成功安装tyopra。</p>
<h1 id="Sogou-Pinyin"><a href="#Sogou-Pinyin" class="headerlink" title="Sogou Pinyin"></a>Sogou Pinyin</h1><p> 从搜狗官方下载的 <a target="_blank" rel="noopener" href="https://ime.sogoucdn.com/dl/index/1612260778/sogoupinyin_2.4.0.3469_amd64.deb?st=USANnSZV6afzzi2u6c8J-g&e=1621603885&fn=sogoupinyin_2.4.0.3469_amd64.deb">Sogou</a> 安装包，需要用 <code>sudo dpkg -i sogoupinyin_2.4.0.3469_amd64.deb</code> 命令进行安装，会遇到以下缺乏库的提示，主要是因为缺少 <code>fcitx</code> 的提示。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">dpkg: 依赖关系问题使得 sogoupinyin 的配置工作不能继续：</span><br><span class="line"> sogoupinyin 依赖于 fcitx (&gt;= 1:4.2.8)；然而：</span><br><span class="line">  未安装软件包 fcitx</span><br><span class="line"> sogoupinyin 依赖于 fcitx-frontend-gtk2；然而：</span><br><span class="line">  未安装软件包 fcitx-frontend-gtk2。</span><br><span class="line"> sogoupinyin 依赖于 fcitx-frontend-gtk3；然而：</span><br><span class="line">  未安装软件包 fcitx-frontend-gtk3。</span><br><span class="line"> sogoupinyin 依赖于 fcitx-frontend-qt5；然而：</span><br><span class="line">  未安装软件包 fcitx-frontend-qt5。</span><br><span class="line"> sogoupinyin 依赖于 fcitx-module-kimpanel；然而：</span><br><span class="line">  未安装软件包 fcitx-module-kimpanel。</span><br><span class="line"> sogoupinyin 依赖于 fcitx-module-x11；然而：</span><br><span class="line">  未安装软件包 fcitx-module-x11。</span><br><span class="line"> sogoupinyin 依赖于 im-config；然而：</span><br><span class="line">  未安装软件包 im-config。</span><br><span class="line"> sogoupinyin 依赖于 fcitx-libs | libfcitx-config4；然而：</span><br><span class="line">  未安装软件包 fcitx-libs。</span><br><span class="line">  未安装软件包 libfcitx-config4。</span><br><span class="line"> sogoupinyin 依赖于 fcitx-libs | libfcitx-qt0；然而：</span><br><span class="line">  未安装软件包 fcitx-libs。</span><br><span class="line">  未安装软件包 libfcitx-qt0。</span><br><span class="line"> sogoupinyin 依赖于 fcitx-libs | libfcitx-utils0；然而：</span><br><span class="line">  未安装软件包 fcitx-libs。</span><br><span class="line">  未安装软件包 libfcitx-utils0。</span><br><span class="line"> sogoupinyin 依赖于 fcitx-ui-classic；然而：</span><br><span class="line">  未安装软件包 fcitx-ui-classic。</span><br><span class="line"> sogoupinyin 依赖于 libqt5quickwidgets5；然而：</span><br><span class="line">  未安装软件包 libqt5quickwidgets5。</span><br><span class="line"> sogoupinyin 依赖于 qml-module-qtquick2；然而：</span><br><span class="line">  未安装软件包 qml-module-qtquick2。</span><br></pre></td></tr></table></figure>



<blockquote>
<p>Fcitx[ˈfaɪtɪks]是 (Free Chinese Input Toy for X) 的英文缩写，中文名为小企鹅输入法，是一个以 GPL 方式发布的输入法框架， 编写它的目是为桌面环境提供一个灵活的输入方案，彻底解决在GNU/Linux下没有一个好的中文输入法的问题。</p>
</blockquote>
<h2 id="FCITX"><a href="#FCITX" class="headerlink" title="FCITX"></a>FCITX</h2><p>通过输入 <code>sudo apt-get install fcitx</code> 来尝试安装，会触发 apt fix broken install， 此时只要再次输入 <code>sudo apt --fix-broken install</code> 来修复。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">下列软件包有未满足的依赖关系：</span><br><span class="line"> fcitx : 依赖: fcitx-bin 但是它将不会被安装</span><br><span class="line">         依赖: fcitx-data 但是它将不会被安装</span><br><span class="line">         依赖: fcitx-modules 但是它将不会被安装</span><br><span class="line">         推荐: fcitx-config-gtk 但是它将不会被安装 或</span><br><span class="line">                 kde-config-fcitx 但是它将不会被安装</span><br><span class="line">         推荐: fcitx-frontend-all 但是它将不会被安装 或</span><br><span class="line">                 fcitx-frontend-fbterm 但是它将不会被安装</span><br><span class="line">         推荐: fcitx-ui-classic 但是它将不会被安装 或</span><br><span class="line">                 fcitx-ui-light 但是它将不会被安装</span><br><span class="line">         推荐: im-config (&gt;= 0.5) 但是它将不会被安装</span><br><span class="line"> sogoupinyin : 依赖: fcitx-frontend-gtk2 但是它将不会被安装</span><br><span class="line">               依赖: fcitx-frontend-gtk3 但是它将不会被安装</span><br><span class="line">               依赖: fcitx-frontend-qt5 但是它将不会被安装</span><br><span class="line">               依赖: fcitx-module-kimpanel 但是它将不会被安装</span><br><span class="line">               依赖: fcitx-module-x11 但是它将不会被安装</span><br><span class="line">               依赖: im-config 但是它将不会被安装</span><br><span class="line">               依赖: fcitx-libs 但是它将不会被安装 或</span><br><span class="line">                       libfcitx-config4 但是它将不会被安装</span><br><span class="line">               依赖: fcitx-libs 但是它将不会被安装 或</span><br><span class="line">                       libfcitx-qt0 但无法安装它</span><br><span class="line">               依赖: fcitx-libs 但是它将不会被安装 或</span><br><span class="line">                       libfcitx-utils0 但是它将不会被安装</span><br><span class="line">               依赖: fcitx-ui-classic 但是它将不会被安装</span><br><span class="line">               依赖: libqt5quickwidgets5 但是它将不会被安装</span><br><span class="line">               依赖: qml-module-qtquick2 但是它将不会被安装</span><br><span class="line">E: 有未能满足的依赖关系。请尝试不指明软件包的名字来运行“apt --fix-broken install”(也可以指定一个解决办法)。</span><br></pre></td></tr></table></figure>



<h2 id="安装成功"><a href="#安装成功" class="headerlink" title="安装成功"></a>安装成功</h2><p>FIX-BROKEN 成功后，再次尝试安装 FCITX 就可以提示成功；接着安装sogou即可。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install fcitx                   </span><br><span class="line">正在读取软件包列表... 完成</span><br><span class="line">正在分析软件包的依赖关系树... 完成</span><br><span class="line">正在读取状态信息... 完成                 </span><br><span class="line">fcitx 已经是最新版 (1:4.2.9.8-3)。</span><br><span class="line">fcitx 已设置为手动安装。</span><br><span class="line">升级了 0 个软件包，新安装了 0 个软件包，要卸载 0 个软件包，有 136 个软件包未被升级。</span><br><span class="line"></span><br><span class="line">$ sudo dpkg -i sogoupinyin_2.4.0.3469_amd64.deb</span><br><span class="line">(正在读取数据库 ... 系统当前共安装有 270000 个文件和目录。)</span><br><span class="line">准备解压 sogoupinyin_2.4.0.3469_amd64.deb  ...</span><br><span class="line">正在解压 sogoupinyin (2.4.0.3469) 并覆盖 (2.4.0.3469) ...</span><br><span class="line">正在设置 sogoupinyin (2.4.0.3469) ...</span><br><span class="line">正在处理用于 mailcap (3.69) 的触发器 ...</span><br><span class="line">正在处理用于 desktop-file-utils (0.26-1) 的触发器 ...</span><br><span class="line">正在处理用于 hicolor-icon-theme (0.17-2) 的触发器 ...</span><br></pre></td></tr></table></figure>





<h2 id="依赖库"><a href="#依赖库" class="headerlink" title="依赖库"></a>依赖库</h2><p>sogou输入法依赖库具体如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">下列【新】软件包将被安装：</span><br><span class="line">  dbus-x11 fcitx fcitx-bin fcitx-config-common fcitx-config-gtk fcitx-data</span><br><span class="line">  fcitx-frontend-all fcitx-frontend-gtk2 fcitx-frontend-gtk3</span><br><span class="line">  fcitx-frontend-qt5 fcitx-libs fcitx-module-dbus fcitx-module-kimpanel</span><br><span class="line">  fcitx-module-lua fcitx-module-x11 fcitx-modules fcitx-ui-classic</span><br><span class="line">  fcitx5-module-quickphrase-editor im-config libfcitx-config4</span><br><span class="line">  libfcitx-core0 libfcitx-gclient1 libfcitx-qt5-1 libfcitx-qt5-data</span><br><span class="line">  libfcitx-utils0 libgettextpo0 libpresage-data libpresage1v5</span><br><span class="line">  libqt5qmlworkerscript5 libqt5quickwidgets5 libtinyxml2.6.2v5 presage</span><br><span class="line">  qml-module-qtquick2</span><br></pre></td></tr></table></figure>



<h1 id="NodeJS-amp-Hexo"><a href="#NodeJS-amp-Hexo" class="headerlink" title="NodeJS &amp; Hexo"></a>NodeJS &amp; Hexo</h1><p>使用 <code>sudo apt-get install nodejs</code> 或 <code>sudo apt-get install node.js</code> 均可以实现node.js 的安装，但是只能安装V12版。</p>
<p>可以在官方下载 <a target="_blank" rel="noopener" href="https://nodejs.org/dist/v16.2.0/node-v16.2.0-linux-x64.tar.xz">node-v16.2.0-linux-x64.tar.xz</a> ，并使用以下命令进行解压：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xz -d node-v16.2.0-linux-x64.tar.xz</span><br><span class="line">tar -xvf node-v16.2.0-linux-x64.tar</span><br></pre></td></tr></table></figure>

<p>解压完毕之后，以管理员身份将该文件移动至 <code>/usr/local/node</code> ，以下命令将 <code>node-v16.2.0-linux-x64</code> 拷贝的同时进行了 <strong>重命名</strong> 操作。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mv /home/XXX/downloads/node-v16.2.0-linux-x64 /usr/<span class="built_in">local</span>/node</span><br></pre></td></tr></table></figure>

<p style="color: gray; font-style: italic;">注：XXX是用户名</p>

<p>然后进行软连接：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo ln -s /usr/<span class="built_in">local</span>/node/bin/node /usr/<span class="built_in">local</span>/bin</span><br><span class="line">sudo ln -s /usr/<span class="built_in">local</span>/node/bin/npm /usr/<span class="built_in">local</span>/bin</span><br></pre></td></tr></table></figure>



<blockquote>
<p>Linux ln（英文全拼：link files）命令是一个非常重要命令，它的功能是为某一个文件在另外一个位置建立一个同步的链接。</p>
<p>当我们需要在不同的目录，用到相同的文件时，我们不需要在每一个需要的目录下都放一个必须相同的文件，我们只要在某个固定的目录，放上该文件，然后在 其它的目录下用ln命令链接（link）它就可以，不必重复的占用磁盘空间。</p>
</blockquote>
<p>以上是 <code>ln</code> 链接命令的解释，实际最重要的作用是将某个已下载的软件及其命令定义至全局，在终端的任意一个目录位置都可以使用该软件。</p>
<h2 id="“安装”-成功"><a href="#“安装”-成功" class="headerlink" title="“安装” 成功"></a>“安装” 成功</h2><p>实际上新版的nodejs并不涉及 前述 <code>dpkg</code> 或 <code>apt</code> 命令的安装，但软连接该文件目录至 <code>/usr/local/bin</code> 后，能实现安装效果，使用 <code>node -v</code> 及 <code>npm -v</code> 命令即可进行测试。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ node -v</span><br><span class="line">v16.2.0</span><br><span class="line"></span><br><span class="line">$ npm -v                   </span><br><span class="line">7.14.0</span><br></pre></td></tr></table></figure>



<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><p>对于使用此类安装方式进行安装的 依赖于nodejs的应用如果需要在全局进行使用可能也需要进行软连接，如 hexo。</p>
<p>使用 <code>npm install hexo-cli -g</code> 成功安装hexo后提示如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ whereis hexo</span><br><span class="line">hexo:</span><br></pre></td></tr></table></figure>



<p>此时需要将 <code>/usr/local/node/bin</code> 文件夹下安装的程序也拉到全局变量中 <code>/usr/local/bin</code> 中。再次使用 <code>whereis</code> 命令检测时即可成功。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ sudo ln -s /usr/<span class="built_in">local</span>/node/bin/hexo /usr/<span class="built_in">local</span>/bin/hexo</span><br><span class="line">                                                                             </span><br><span class="line">$ whereis hexo</span><br><span class="line">hexo: /usr/<span class="built_in">local</span>/bin/hexo</span><br></pre></td></tr></table></figure>



<h1 id="Visual-Studio-Code"><a href="#Visual-Studio-Code" class="headerlink" title="Visual Studio Code"></a>Visual Studio Code</h1><p>VS code安装使用 <code>dpkg</code> 命令，最大的问题是微软的源下载太慢，以下提供个人下载点，安装过程不再记录。</p>
<p>个人下载点： <a target="_blank" rel="noopener" href="https://storage.islet.space/02_Softwares/02_Microsoft/VisualStudioCode/Linux/code_1.55.2-1618307277_amd64.deb">Visual Studio Code Linux (deb)</a></p>
<h1 id="PicGo"><a href="#PicGo" class="headerlink" title="PicGo"></a>PicGo</h1><p><a target="_blank" rel="noopener" href="https://support.typora.io/Upload-Image/#picgo-core-command-line-opensource">Typora_Picgo</a> 有 command-line 版 和 app 版，参考 <a target="_blank" rel="noopener" href="https://picgo.github.io/PicGo-Doc/zh/">PicGo官方文档</a> （GFW封锁了<em><strong>github.io</strong></em>域名后缀，需要梯子）进行安装吧。</p>
<h1 id="QQmusic-amp-cosbrowser"><a href="#QQmusic-amp-cosbrowser" class="headerlink" title="QQmusic &amp; cosbrowser"></a>QQmusic &amp; cosbrowser</h1><p>这两个软件都是腾讯家产品，下载、安装和使用都很方便。</p>
<p>其中，QQMusic使用 <code>dpkg</code> 命令进行安装即可， <code>cosbrowser</code> 是 <code>AppImage</code> 格式文件，直接打开即可使用，无需安装。</p>
<p><strong>彩蛋</strong>：<code>sudo apt-get install cmatrix</code></p>
<p>—EOF—</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://islet.space/2021/05/19/Web/2021-05-19-What-is-the-meaning-of--savefor-NPM-install-/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liewzheng">
      <meta itemprop="description" content="笔记分享的旮旯孤岛而已">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder的孤岛">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/05/19/Web/2021-05-19-What-is-the-meaning-of--savefor-NPM-install-/" class="post-title-link" itemprop="url">What is the meaning of '-save' for NPM install ?</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2021-05-19 20:10:00 / Modified: 20:14:41" itemprop="dateCreated datePublished" datetime="2021-05-19T20:10:00+08:00">2021-05-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/web/" itemprop="url" rel="index"><span itemprop="name">web</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a target="_blank" rel="noopener" href="https://www.geeksforgeeks.org/what-is-the-meaning-of-save-for-npm-install/">geeksforgeeks.org</a></p>
<p><strong><a target="_blank" rel="noopener" href="https://www.geeksforgeeks.org/node-js-npm-node-package-manager/">NPM (Node Package Manager)</a></strong> is the default package manager employed in JavaScript runtime environment in Node.js. It has a very frequently used command <strong>npm install [Package Name] –save</strong>. But the fact is there is no difference between <strong>npm install [Package Name]</strong> and <strong>npm install [Package Name] –save</strong> in the later version after npm 5.0.0 onwards.</p>
<p>Before npm 5.0.0, it was necessary to add <code>--save</code> after package name because it will save the installed package to  package.json file in the dependency section. If you are using a recent  version of npm save yourself from unnecessary typing and use <strong>npm install [Package Name]</strong> instead of <strong>npm install [Package Name] <code>--save</code></strong> by default it will add the installed package to the dependency list in the package.json file.</p>
<p><strong>NPM has several commands which are listed below:</strong></p>
<ol>
<li><p>–save or -S:</p>
<p> When the following command is used with npm install this will save all  your installed core packages into the dependency section in the  package.json file. Core dependencies are those packages without which  your application will not give desired results. But as mentioned  earlier, it is an unnecessary feature in the npm 5.0.0 version onwards.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save</span><br></pre></td></tr></table></figure></li>
<li><p>–save-prod or -P:</p>
<p> The following command is introduced in the later version of npm it will perform the same task as the </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--save</span><br></pre></td></tr></table></figure>

<p> command unless any other command such as </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-D</span><br></pre></td></tr></table></figure>

<p> or </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-O</span><br></pre></td></tr></table></figure>

<p> is present.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-prod</span><br></pre></td></tr></table></figure></li>
<li><p>–save-dev or -D:</p>
<p> With </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--save-dev</span><br></pre></td></tr></table></figure>

<p> or </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-D</span><br></pre></td></tr></table></figure>

<p> command your installed packages will be added to devDependency section  of the package.json file. Development dependencies are those packages  which only meant for development purpose it will not affect the  application’s result.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev</span><br></pre></td></tr></table></figure></li>
<li><p>–save-optional or -O:</p>
<p> When this command is used the install the that packages will be listed  under the optional Dependency section of the package.json file. Optional dependencies are those packages which are only used when a particular  feature of the application is used and will not be required if that  functionality isn’t used.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-optional</span><br></pre></td></tr></table></figure></li>
<li><p>–no-save:</p>
<p> When this command is used with npm install it will not allow the  installed packages from being saved into the dependency section.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --no-save</span><br></pre></td></tr></table></figure></li>
</ol>
<p><strong>Note:</strong> NPM provides two additional options to save dependencies into package.json file.</p>
<ol>
<li><p>–save-exact or -E:</p>
<p> This is an additional or optional command provided by the npm that will save the exact version of the installed packages which are configured  at the time of development. It will not download the dependencies from  npm’s default server range operator.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-exact</span><br></pre></td></tr></table></figure></li>
<li><p>–save-bundle or -B:</p>
<p> The following command is also an optional command when </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--save-bundle</span><br></pre></td></tr></table></figure>

<p> or </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-B</span><br></pre></td></tr></table></figure>

<p> is used. This will also add the saved dependencies under the bundleDependency list.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-bundle</span><br></pre></td></tr></table></figure></li>
</ol>
<p>​          </p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://islet.space/2021/05/17/Computer/2021-05-17-%E5%86%85%E5%AD%98%E5%9C%B0%E5%9D%80%E5%AF%B9%E9%BD%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liewzheng">
      <meta itemprop="description" content="笔记分享的旮旯孤岛而已">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder的孤岛">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/05/17/Computer/2021-05-17-%E5%86%85%E5%AD%98%E5%9C%B0%E5%9D%80%E5%AF%B9%E9%BD%90/" class="post-title-link" itemprop="url">内存地址对齐</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2021-05-17 20:10:00 / Modified: 20:32:07" itemprop="dateCreated datePublished" datetime="2021-05-17T20:10:00+08:00">2021-05-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Computer/" itemprop="url" rel="index"><span itemprop="name">Computer</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/mhq-martin/p/11537873.html">cnblogs.com</a></p>
<h1 id="对齐定义"><a href="#对齐定义" class="headerlink" title="对齐定义"></a>对齐定义</h1><p>内存地址对齐，是一种在计算机内存中排列数据、访问数据的一种方式。</p>
<h1 id="对齐分类"><a href="#对齐分类" class="headerlink" title="对齐分类"></a>对齐分类</h1><p>内存地址对齐包含了两种相互独立又相互关联的部分：<strong>基本数据对齐</strong> 和 <strong>结构体数据对齐</strong>。</p>
<p>当今的计算机在计算机内存中读写数据时都是 <mark>按字(word)大小块来进行操作</mark> 的。在32位系统中，数据总线宽度为32位，每次能读取4bytes，地址总线宽度为32，因此最大的寻址空间为2^32^bits=4GB，但是最低2位A[0]、A[1]是不用于寻址，A[2-31]才能存储器相连，因此只能访问4的倍数地址空间，但是总的寻址空间还是2^30^bits字长=4GB，因此在 <mark>内存中所有存放的基本类型数据的首地址的最低两位都是0，除结构体中的成员变量</mark> 。</p>
<blockquote>
<p>基本类型数据对齐就是数据在内存中的 <mark>偏移地址必须等于一个字的倍数</mark>，按这种存储数据的方式，可以提升系统在读取数据时的性能。<mark>为了对齐数据，可能必须在上一个数据结束和下一个数据开始的地方插入一些没有用处字节，这就是结构体数据对齐</mark>。</p>
</blockquote>
<h2 id="基本数据对齐示例"><a href="#基本数据对齐示例" class="headerlink" title="基本数据对齐示例"></a>基本数据对齐示例</h2><p>例如，假设计算机的字大小为4bytes，因此变量在内存中的首地址都是满足4地址对齐，CPU只能对4的倍数的地址进行读取，而每次能读取4个字节大小的数据。</p>
<p>假设有一个整型的数据a的首地址不是4的倍数(如下图所示)，不妨设为 <code>0X00FFFFF3</code>，则该整型数据存储在地址范围为<code>0X00FFFFF3</code> ~`0X00FFFFF6<code>的存储空间中，而CPU每次只能对4的倍数内存地址进行读取，因此想读取a的数据，CPU要分别在 </code>0X00FFFFF0<code>和</code>0X00FFFFF4` 进行两次内存读取，而且还要对两次读取的数据进行处理才能得到a的数据，而一个程序的瓶颈往往不是CPU的速度，而是取决于内存的带宽，因为CPU得处理速度要远大于从内存中读取数据的速度，因此减少对内存空间的访问是提高程序性能的关键。从上例可以看出，采取内存地址对齐策略是提高程序性能的关键。</p>
<p><mark>也就是说，不对齐内存地址的话会造成CPU对内存中数据访问范围的增大，造成性能浪费。</mark></p>
<h2 id="结构体对齐示例"><a href="#结构体对齐示例" class="headerlink" title="结构体对齐示例"></a>结构体对齐示例</h2><p>首先我们先看看下面的C语言的结构体：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">typedef struct MemAlign</span><br><span class="line">&#123;</span><br><span class="line">    int a;</span><br><span class="line">    char b[3];</span><br><span class="line">    int c;</span><br><span class="line">&#125;MemAlign;</span><br></pre></td></tr></table></figure>

<p>以上这个结构体占用内存多少空间呢？</p>
<p>也许你会说，这个简单，计算每个类型的大小，将它们相加就行了，以32bit平台为例，int类型占4bytes，char占用1byte，所以：4 + 3 + 4 =  11bytes，那么这个结构体一共占用11字节空间。</p>
<p>实际上用sizeof运算符来求出这个结构体占用内存空间大小，sizeof(MemAlign)，出乎意料的是，结果居然为12？</p>
<p>是因为这个结构体被优化了，这个优化有个另外一个名字叫“对齐”，那么这个对齐到底做了什么样的优化呢。</p>
<p><img src="https://pic.islet.space/2021/05/1231881-20190917224404418-1265388453.png" alt="img"></p>
<p>相信学过汇编的朋友都很熟悉这张图，这张图就是CPU与内存如何进行数据交换的模型，其中，左边蓝色的方框是CPU，右边绿色的方框是内存，内存上面的0～3是内存地址。</p>
<p>上图以32位CPU作为代表，<mark>32位CPU是以双字（DWORD）为单位进行数据传输的</mark>，因此 <mark>在32位系统中，无论是8位、16位还是32位都是以双字进行数据传输</mark> 。</p>
<h2 id="非32位数据非对齐传输示例"><a href="#非32位数据非对齐传输示例" class="headerlink" title="非32位数据非对齐传输示例"></a>非32位数据非对齐传输示例</h2><p>8位或16位一样可以传输，但是事情并非像我们想象的那么简单。</p>
<p>一个int类型4字节的数据如果放在上图内存地址1开始的位置，那么这个数据占用的内存地址为1～4，那么这个数据就被分为了2个部分，一个部分在地址0～3中，另外一部分在地址4～7中，又由于32位CPU以双字进行传输，所以，CPU会分2次进行读取，一次先读取地址0～3中内容，再一次读取地址4～7中数据，最后CPU提取并组合出正确的int类型数据，舍弃掉无关数据。那么反过来，如果我们把这个int类型4字节的数据放在上图从地址0开始的位置会怎样呢？读到这里，也许你明白了，CPU只要进行一次读取就可以得到这个int类型数据了。没错，就是这样，这次CPU只用了一个周期就得到了数据，由此可见，对内存数据的摆放是多么重要啊，<mark>摆放正确位置可以减少CPU的使用资源</mark>。</p>
<h1 id="对齐原则"><a href="#对齐原则" class="headerlink" title="对齐原则"></a>对齐原则</h1><ul>
<li><p>第一个成员的首地址为0</p>
</li>
<li><p>每个成员的首地址是自身大小的整数倍</p>
<ul>
<li>以4bytes对齐为例，如果自身大小大于4bytes，都以4bytes整数倍为基准对齐。</li>
</ul>
</li>
<li><p>最后以结构总体对齐。</p>
<ul>
<li>以4字节bytes为例，取结构体中最大成员类型倍数，如果超过4字节，都以4字节整数倍为基准对齐。（其中这一条还有个名字叫：“补齐”，补齐的目的就是多个结构变量挨着摆放的时候也满足对齐的要求。）</li>
</ul>
</li>
</ul>
<h2 id="基本数据对齐与结构补齐示例"><a href="#基本数据对齐与结构补齐示例" class="headerlink" title="基本数据对齐与结构补齐示例"></a>基本数据对齐与结构补齐示例</h2><p>上述的三原则听起来还是比较抽象，那么接下来我们通过一个例子来加深对内存对齐概念的理解，下面是一个结构体，我们动手算出下面结构体一共占用多少内存？假设我们以32位平台并且以4字节对齐方式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#pragma pack(4)</span><br><span class="line">typedef struct MemAlign</span><br><span class="line">&#123;</span><br><span class="line">    char a[18];</span><br><span class="line">    double b;    </span><br><span class="line">    char c;</span><br><span class="line">    int d;    </span><br><span class="line">    short e;    </span><br><span class="line">&#125;MemAlign;</span><br></pre></td></tr></table></figure>

<p>下图为对齐后结构如下：</p>
<p><img src="https://pic.islet.space/2021/05/1231881-20190917224631323-2009020349.png" alt="img"></p>
<p>我们就以这个图来讲解是如何对齐的：</p>
<p>第一个成员（char a[18]）：首先，假设我们把它放到内存开始地址为0的位置，由于第一个成员占18个字节，所以第一个成员占用内存地址范围为0～18。</p>
<p>第二个成员（double b）：由于double类型占8字节，又因为8字节大于4字节，所以就以4字节对齐为基准。由于第一个成员结束地址为18，那么地址18并不是4的整数倍，我们需要再加2个字节，也就是从地址20开始摆放第二个成员。</p>
<p>第三个成员（char c）：由于char类型占1字节，任意地址是1字节的整数倍，所以我们就直接将其摆放到紧接第二个成员之后即可。</p>
<p>第四个成员（int d）：由于int类型占4字节，但是地址29并不是4的整数倍，所以我们需要再加3个字节，也就是从地址32开始摆放这个成员。</p>
<p>第五个成员（short e）：由于short类型占2字节，地址36正好是2的整数倍，这样我们就可以直接摆放，无需填充字节,紧跟其后即可。</p>
<p>这样我们内存对齐就完成了。但是离成功还差那么一步，那是什么呢？对，是对整个结构体补齐，接下来我们就补齐整个结构体。那么，先让我们回顾一下补齐的原则：“以4字节对齐为例，取结构体中最大成员类型倍数，如果超过4字节，都以4字节整数倍为基准对齐。”在这个结构体中最大类型为double类型（占8字节），又由于8字节大于4字  节，所以我们还是以4字节补齐为基准，整个结构体结束地址为38，而地址38并不是4的整数倍，所以我们还需要加额外2个字节来填充结构体，如下图红色的就是补齐出来的空间：</p>
<p><img src="https://pic.islet.space/2021/05/1231881-20190917224653471-2076639760.png" alt="img"></p>
<p> 到此为止，我们内存对齐与补齐就完毕了！接下来我们用实验来证明真理，程序如下：</p>
<p><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;memory.h&gt;</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 由于VS2010默认是8字节对齐，我们</span><br><span class="line">&#x2F;&#x2F; 通过预编译来通知编译器我们以4字节对齐</span><br><span class="line">#pragma pack(4)</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; 用于测试的结构体</span><br><span class="line">typedef struct MemAlign</span><br><span class="line">&#123;</span><br><span class="line">    char a[18];    &#x2F;&#x2F; 18 bytes</span><br><span class="line">    double b;    &#x2F;&#x2F; 08 bytes    </span><br><span class="line">    char c;        &#x2F;&#x2F; 01 bytes</span><br><span class="line">    int d;        &#x2F;&#x2F; 04 bytes</span><br><span class="line">    short e;    &#x2F;&#x2F; 02 bytes</span><br><span class="line">&#125;MemAlign;</span><br><span class="line"> </span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;&#x2F; 定义一个结构体变量</span><br><span class="line">    MemAlign m;</span><br><span class="line">    &#x2F;&#x2F; 定义个以指向结构体指针</span><br><span class="line">    MemAlign *p &#x3D; &amp;m;</span><br><span class="line">    &#x2F;&#x2F; 依次对各个成员进行填充，这样我们可以</span><br><span class="line">    &#x2F;&#x2F; 动态观察内存变化情况</span><br><span class="line">    memset( &amp;m.a, 0x11, sizeof(m.a) );</span><br><span class="line">    memset( &amp;m.b, 0x22, sizeof(m.b) );</span><br><span class="line">    memset( &amp;m.c, 0x33, sizeof(m.c) );</span><br><span class="line">    memset( &amp;m.d, 0x44, sizeof(m.d) );</span><br><span class="line">    memset( &amp;m.e, 0x55, sizeof(m.e) );</span><br><span class="line">    &#x2F;&#x2F; 由于有补齐原因，所以我们需要对整个</span><br><span class="line">    &#x2F;&#x2F; 结构体进行填充，补齐对齐剩下的字节</span><br><span class="line">    &#x2F;&#x2F; 以便我们可以观察到变化</span><br><span class="line">    memset( &amp;m, 0x66, sizeof(m) );</span><br><span class="line">    &#x2F;&#x2F; 输出结构体大小</span><br><span class="line">    printf( &quot;sizeof(MemAlign) &#x3D; %d&quot;, sizeof(m) );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></p>
<p>程序运行过程中，查看内存如下：</p>
<p><img src="https://pic.islet.space/2021/05/1231881-20190917225512389-1581088258.png" alt="img"></p>
<p>其中，各种颜色带下划线的代表各个成员变量，蓝色方框的代表为内存对齐时候填补的多余字节，由于这里看不到补齐效果，我们接下来看下图，下图篮框包围的字节就是与上图的交集以外的部分就是补齐所填充的字节。</p>
<p><img src="https://pic.islet.space/2021/05/1231881-20190917225534651-684741719.png" alt="img"></p>
<p> 在最后，我在谈一谈关于补齐的作用，<mark>补齐其实就是为了让这个结构体定义的数组变量时候，数组内部，也同样满足内存对齐的要求</mark>，为了更好的理解这点，我做了一个跟本例子相对照的图：</p>
<p><img src="https://pic.islet.space/2021/05/1231881-20190917225553591-1418591054.png" alt="img"></p>
<h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/donkeylong/article/details/4909720">https://blog.csdn.net/donkeylong/article/details/4909720</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/cyousui/article/details/17655051">https://blog.csdn.net/cyousui/article/details/17655051</a></p>
<p>​          </p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://islet.space/2021/05/17/Computer/2021-05-17-%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liewzheng">
      <meta itemprop="description" content="笔记分享的旮旯孤岛而已">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder的孤岛">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/05/17/Computer/2021-05-17-%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80/" class="post-title-link" itemprop="url">汇编语言</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-05-17 20:00:00" itemprop="dateCreated datePublished" datetime="2021-05-17T20:00:00+08:00">2021-05-17</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-05-20 22:50:31" itemprop="dateModified" datetime="2021-05-20T22:50:31+08:00">2021-05-20</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Computer/" itemprop="url" rel="index"><span itemprop="name">Computer</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="X86指令集介绍"><a href="#X86指令集介绍" class="headerlink" title="X86指令集介绍"></a>X86指令集介绍</h1><h2 id="X86指令集的基本特色"><a href="#X86指令集的基本特色" class="headerlink" title="X86指令集的基本特色"></a>X86指令集的基本特色</h2><ul>
<li>向下兼容</li>
<li>变长指令<ul>
<li>1-15字节，多为2-3字节长度</li>
</ul>
</li>
<li>多种寻址方式（可访问不对齐内存地址）</li>
</ul>
<p><img src="https://pic.islet.space/2021/05/image-20210517203416861.png" alt="image-20210517203416861"></p>
<h2 id="X86寄存器"><a href="#X86寄存器" class="headerlink" title="X86寄存器"></a>X86寄存器</h2><p>指令集的通用寄存器个数有限</p>
<blockquote>
<p>X86-32下指令集通用寄存器数量为8个，x86-64下为16个</p>
</blockquote>
<p>至多只有一个操作数在内存中，另一个操作数为立即数或寄存器</p>
<p><img src="https://pic.islet.space/2021/05/image-20210517204354665.png" alt="image-20210517204354665"></p>
<p><img src="https://pic.islet.space/2021/05/image-20210517204446891.png" alt="image-20210517204446891"></p>
<p><em>源自 网络PDF</em>——<a target="_blank" rel="noopener" href="https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=&cad=rja&uact=8&ved=2ahUKEwimmc7O39DwAhV5yYsBHdS2CHMQFjAAegQIAxAD&url=http://images.china-pub.com/ebook4930001-4935000/4934543/ch02.pdf&usg=AOvVaw0yJuRWmzjtj41FR6ld_Vmm">X86处理器架构</a></p>
<h1 id="SHARC汇编"><a href="#SHARC汇编" class="headerlink" title="SHARC汇编"></a>SHARC汇编</h1><p><a href="">《Assembler and Preprocessor Manual(including the ADSP-BFxxx, ADSP-21xxx, ADSP-TSxxx)》</a></p>
<h2 id="VisualDSP"><a href="#VisualDSP" class="headerlink" title="VisualDSP++"></a>VisualDSP++</h2><p>以下是ADI官网对VisualDSP++（以下简称VDSP）的解释，本质上是个集成软件开发和调试环境（IDDE）。</p>
<p><img src="https://pic.islet.space/2021/05/image-20210520005659254.png" alt="image-20210520005659254"></p>
<p>汇编器的操作取决于两种类型的控制：汇编器指令和汇编器开关。</p>
<blockquote>
<p>Assembler operations depend on two types of controls: <strong>assembler directives</strong> and <strong>assembler switches</strong>.</p>
</blockquote>
<p>VDSP支持以下三种不同的汇编器：</p>
<img src="https://pic.islet.space/2021/05/image-20210520010438229.png" alt="image-20210520010438229" style="zoom: 67%;" />



<p>DSP汇编开发者需要先熟悉以下内容：</p>
<blockquote>
<ul>
<li><p>“<em>Writing Assembly Programs</em>” on page 1-3</p>
</li>
<li><p> “<em>Using Assembler Support for C Structs</em>” on page 1-21</p>
</li>
<li><p> “<em>Preprocessing a Program</em>” on page 1-24</p>
</li>
<li><p>“<em>Using Assembler Feature Macros</em>” on page 1-25</p>
</li>
<li><p>“<em>Generating Make Dependencies</em>” on page 1-37</p>
</li>
<li><p>“<em>Reading a Listing File</em>” on page 1-38</p>
</li>
<li><p>“<em>Enabling Statistical Profiling for Assembly Functions</em>” on page 1-38</p>
</li>
<li><p>“*Specifying Assembler Options in VisualDSP++*” on page 1-173</p>
</li>
</ul>
</blockquote>
<h2 id="总览"><a href="#总览" class="headerlink" title="总览"></a>总览</h2><p>汇编器 将 <strong>汇编源(.asm)<strong>、</strong>数据(.dat)</strong> 和 <strong>头文件(.h)</strong> 三者整理成可执行可链接的格式（ELF），也就是一个标准的 **二进制文件(.doj)**。</p>
<p>另外，汇编器还将生成一个 **列表文件(.lst)**，展示二进制文件和源文件之间的联系。</p>
<p>也就是说，编译成功后，.doj和.lst文件就是其编译结果。</p>
<img src="https://pic.islet.space/2021/05/image-20210520011656751.png" alt="image-20210520011656751" style="zoom:67%;" />

<blockquote>
<p>Figure 1-1 shows a graphical overview of the assembly process. The figure shows the preprocessor processing the assembly source (.asm) and header (.h) files.</p>
<p>By default, the assembler processes an intermediate file to produce a binary object file (.doj) and an optional listing file (.lst). </p>
</blockquote>
<img src="https://pic.islet.space/2021/05/image-20210520012328329.png" alt="image-20210520012328329" style="zoom:67%;" />



<h2 id="编写"><a href="#编写" class="headerlink" title="编写"></a>编写</h2><ul>
<li><p>Assembler directives are coded in assembly source files. </p>
</li>
<li><p>The directives allow you to <strong>define variables</strong>, <strong>set up hardware features</strong>, and <strong>identify program sections</strong> for placement within processor memory. </p>
</li>
<li><p>The assembler uses directives for guidance as it translates a source program into object code. </p>
</li>
</ul>
<p>注意：</p>
<blockquote>
<ul>
<li><p>Do not use a <em><strong>word processor</strong></em> that embeds special control codes in the text. </p>
</li>
<li><p>Use an <code>.asm</code> extension to source file names to identify them as assembly source files.</p>
</li>
</ul>
</blockquote>
<p>可以使用像 <code>batch-file</code> 和 <code>makefile</code> 这样的命令行工具来汇编你的源文件。</p>
<p>列表文件还提供了关于导入的C语言数据结构的信息。</p>
<h2 id="问题解决"><a href="#问题解决" class="headerlink" title="问题解决"></a>问题解决</h2><h3 id="问题一"><a href="#问题一" class="headerlink" title="问题一"></a>问题一</h3><p><strong>现象</strong>：出现如下图所示的头文件缺少</p>
<p><img src="https://pic.islet.space/2021/05/20210520095711.png" alt="image-20210520090023689"></p>
<p><strong>原因</strong>：<code>.boj </code>文件和其所依赖的 <code>.h</code> 头文件相对路径不一致，或项目文件的绝对路径与原来创建时不一致。</p>
<p><strong>例如</strong>：从文件 <code>Debug/system/startup_Idf/app_IVT.doj</code> 中可以看出，该文件的创作者是将其放置在 <code>D:\ADSP\workspace\LED_test\Debug</code> 下的，因此需要改变该项目文件的位置。</p>
<p><strong>解决方法</strong>：在原创作者的绝对路径下放置该项目文件。</p>
<p><img src="https://pic.islet.space/2021/05/20210520095708.png" alt="image-20210520090936369"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://islet.space/2021/05/14/Communication/2021-05-14-I2C%E3%80%81SPI%E3%80%81TDM%E5%8F%8AI2S/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liewzheng">
      <meta itemprop="description" content="笔记分享的旮旯孤岛而已">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder的孤岛">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/05/14/Communication/2021-05-14-I2C%E3%80%81SPI%E3%80%81TDM%E5%8F%8AI2S/" class="post-title-link" itemprop="url">I^2^C、SPI、TDM及I2S</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-05-14 10:55:00" itemprop="dateCreated datePublished" datetime="2021-05-14T10:55:00+08:00">2021-05-14</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-05-22 18:29:45" itemprop="dateModified" datetime="2021-05-22T18:29:45+08:00">2021-05-22</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Signal/" itemprop="url" rel="index"><span itemprop="name">Signal</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="I-2-C"><a href="#I-2-C" class="headerlink" title="I^2^C"></a>I^2^C</h1><p><strong>标准</strong>：<a target="_blank" rel="noopener" href="https://www.nxp.com/docs/en/user-guide/UM10204.pdf">《NXP_UM10204_I^2^C-bus specification and user manual》</a></p>
<blockquote>
<p><em>I^2^C总线是一个事实上的世界标准，现在已经在50多家公司生产的1000多种不同的IC中实施。</em></p>
<p><em>此外，多功能的I^2^C总线被用于各种控制架构，如系统管理总线（SMBus）、电源管理总线（PMBus）、智能平台管理接口（IPMI）、显示数据通道（DDC）和高级电信计算架构（ATCA）。</em></p>
<p><em>本文件帮助设备和系统设计者了解I^2^C总线的工作原理并实现工作应用。描述了各种操作模式。它包含了对I^2^C<strong>总线数据传输</strong>、握手和总线仲裁方案的全面介绍。详细的章节涵盖了I^2^C总线在每种工作模式下的时序和电气规范。</em></p>
<p><em>I^2^C兼容芯片的设计者应将该文件作为参考，并确保新设备满足该文件中规定的所有限制。包含I^2^C器件的系统的设计者应审查本文件，并参考各个组件的数据表。</em></p>
<p>——翻译自标准文件</p>
</blockquote>
<p>I^2^C(Inter－Integrated Circuit)是一种通用的总线协议。它是由Philips(飞利浦)公司，现NXP(恩智浦)半导体开发的一种简单的双向两线制总线协议标准。</p>
<p>对于硬件设计人员来说，只需要2个管脚，极少的连接线和面积，就可以实现芯片间的通讯，对于软件开发者来说，可以使用同一个I^2^C驱动库，来实现实现不同器件的驱动，大大减少了软件的开发时间。极低的工作电流，降低了系统的功耗，完善的应答机制大大增强通讯的可靠性。</p>
<h2 id="术语"><a href="#术语" class="headerlink" title="术语"></a>术语</h2><img src="https://pic.islet.space/2021/05/image-20210514111033910.png" alt="image-20210514111033910" style="zoom: 67%;" />

<table>
<thead>
<tr>
<th>术语</th>
<th>释义</th>
</tr>
</thead>
<tbody><tr>
<td>总线</td>
<td>传输数据的通路</td>
</tr>
<tr>
<td>传送者</td>
<td>传输数据至总线的设备</td>
</tr>
<tr>
<td>接收者</td>
<td>从总线上接受数据的设备</td>
</tr>
<tr>
<td>主（机）</td>
<td>主动开启传输、生成时钟信号 并 主动结束传输的设备</td>
</tr>
<tr>
<td>从（机）</td>
<td>由主机寻址的设备</td>
</tr>
<tr>
<td>多主（机）</td>
<td>在不损坏数据传输的情况下允许多主机可以试图同时控制总线</td>
</tr>
<tr>
<td>仲裁</td>
<td>确保在有多个主机同时试图控制总线的情况下，只允许一个主机这样做，而且仲裁成功的信息不会被（其他设备）破坏的程序。</td>
</tr>
<tr>
<td>同步</td>
<td>确保两个及以上设备其时钟信号的同步</td>
</tr>
</tbody></table>
<p>以下这个图应该可以较好地解释“多主机”的概念，多个主机可以同时向外发出传输数据的申请，也可以主动结束其数据传输。虽然，I^2^C降低了总线复用的成本，但仍需要“仲裁”机制来解决多个主机之间的无序竞争状态。</p>
<img src="https://pic.islet.space/2021/05/image-20210514112114667.png" alt="image-20210514112114667" style="zoom:67%;" />

<h2 id="总线特征"><a href="#总线特征" class="headerlink" title="总线特征"></a>总线特征</h2><h3 id="总线硬件要求"><a href="#总线硬件要求" class="headerlink" title="总线硬件要求"></a>总线硬件要求</h3><p>通过 <strong>串行数据</strong>（SDA，Serial Data）和 <strong>串行时钟</strong>（SCL，Serial Clock）两条线路对设备进行连接。</p>
<p>每个设备都通过自身的通信设备地址进行互相辨别，且每个设备都可以当发送者或接收者，取决于设备自身的功能定义。</p>
<h3 id="标准传输速率"><a href="#标准传输速率" class="headerlink" title="标准传输速率"></a>标准传输速率</h3><p>各模式、速率及其传输方向见下方表格。</p>
<blockquote>
<p>Data on the I^2^C-bus can be transferred at rates of up to 100 kbit/s in the Standard-mode, up to 400 kbit/s in the Fast-mode, up to 1 Mbit/s in Fast-mode Plus, or up to 3.4 Mbit/s in the High-speed mode. </p>
</blockquote>
<table>
<thead>
<tr>
<th>MODE</th>
<th>RATE</th>
<th>TRANSFER DIRECTION</th>
<th>DOWNWARD COMPATIBLE WITH</th>
</tr>
</thead>
<tbody><tr>
<td>STANDARD</td>
<td>100 Kbit/s</td>
<td>bidirectional</td>
<td>/</td>
</tr>
<tr>
<td>FAST</td>
<td>400 Kbit/s</td>
<td>bidirectional</td>
<td>STANDARD</td>
</tr>
<tr>
<td>FAST-PLUS</td>
<td>1 Mbit/s</td>
<td>bidirectional</td>
<td>STANDARD / FAST</td>
</tr>
<tr>
<td>HIGH-SPEED</td>
<td>3.4 Mbit/s</td>
<td>bidirectional</td>
<td>STANDARD / FAST / FAST-PLUS</td>
</tr>
<tr>
<td>ULTRA-FAST</td>
<td>5 Mbit/s</td>
<td>unidirectional</td>
<td>/</td>
</tr>
</tbody></table>
<p><img src="https://pic.islet.space/2021/05/image-20210522182927364.png" alt="image-20210522182927364"></p>
<h2 id="协议要求"><a href="#协议要求" class="headerlink" title="协议要求"></a>协议要求</h2><p>以下协议要求适用于双向通信模式（不包括ULTRA-FAST模式下的单向通信）</p>
<h3 id="逻辑电平规定"><a href="#逻辑电平规定" class="headerlink" title="逻辑电平规定"></a>逻辑电平规定</h3><p>由于I^2^C的接入设备众多（如CMOS、NMOS、Bipolar等），因此逻辑电平0和逻辑电平1（的电压）并不是固定不变的，这取决于VDD的电平。</p>
<p>输入参考电平会被控制在VDD电平的30%<del>70%之间。 V</del>IL~ = 0.3 * V<del>DD</del>；V<del>IH</del> = 0.7 * V<del>DD</del> 。</p>
<p>某些传统设备的输入电平会被固定在1.5V（V<del>IL</del>）和3.0V（V<del>IH</del>），但新设备都要求是 30%V<del>DD</del> 及 70%V<del>DD</del> 。</p>
<p><strong>注意</strong>：V<del>IL</del>、V<del>IH</del>、V<del>OL</del>、V<del>OH</del>都是以参考电压作为基准的，即要达到某个电压的百分之多少时，才能够被认为是 <strong>逻辑电平0</strong> 或 <strong>逻辑电平1</strong> 。例如，可将V<del>IL</del> 视作当V<del>DD</del>下降到只有30%及以下时，为逻辑电平0，30%V<del>DD</del>是其逻辑电平的最高阈值；同理可得 V<del>IH</del> ；超过这个值而未到达70%的中间态则为不确定态。</p>
<blockquote>
<p>Due to the variety of different technology devices (CMOS, NMOS, bipolar) that can be connected to the I^2^C-bus, the levels of the logical ‘0’ (LOW) and ‘1’ (HIGH) are not fixed and depend on the associated level of VDD . Input reference levels are set as 30 % and 70 % of VDD ; VIL is 0.3VDD and VIH is 0.7V DD .</p>
<p>See Figure 38, timing diagram. Some legacy device input levels were fixed at V<del>IL</del> = 1.5 V and V<del>IH</del> = 3.0 V, but all new devices require this 30 %/70 % specification. </p>
</blockquote>
<img src="https://pic.islet.space/2021/05/image-20210514134830615.png" alt="image-20210514134830615" style="zoom: 67%;" />



<h3 id="时序正确性"><a href="#时序正确性" class="headerlink" title="时序正确性"></a>时序正确性</h3><ul>
<li>SDA上的数据必须在SCL高电平期间保持稳定，即不能在SCL高电平期间发生翻转（后见原因），只有在SCL低电平时可以翻转。</li>
<li>时钟脉冲信号生成要先于数据传送。</li>
</ul>
<blockquote>
<p>The data on the SDA line must be stable during the HIGH period of the clock. The HIGH or LOW state of the data line can only change when the clock signal on the SCL line is LOW (see Figure 4). One clock pulse is generated for each data bit transferred.</p>
</blockquote>
<img src="https://pic.islet.space/2021/05/image-20210514141512136.png" alt="image-20210514141512136" style="zoom: 80%;" />



<h3 id="开始及结束标志"><a href="#开始及结束标志" class="headerlink" title="开始及结束标志"></a>开始及结束标志</h3><ul>
<li><p>传输开始时必须以一个 <strong>开始</strong> 信号作为标志，结束时必须以一个 <strong>结束</strong> 信号作为标志。</p>
</li>
<li><p><strong>开始信号 <strong>是以SCL为高电平时的 <strong>SDA电平的由高转低</strong> 作为标志，</strong>结束信号</strong> 是以SCL高电平时的 <strong>SDA电平的由低转高</strong> 作为标志。</p>
</li>
<li><p>开始和结束标志必须由主设备控制。</p>
</li>
</ul>
<blockquote>
<p>All transactions begin with a START (S) and are terminated by a STOP (P) (see Figure 5). A HIGH to LOW transition on the SDA line while SCL is HIGH defines a START condition. A LOW to HIGH transition on the SDA line while SCL is HIGH defines a STOP condition.</p>
</blockquote>
<img src="https://pic.islet.space/2021/05/image-20210514142116674.png" alt="image-20210514142116674" style="zoom: 80%;" />



<h4 id="开始字节"><a href="#开始字节" class="headerlink" title="开始字节"></a>开始字节</h4><img src="https://pic.islet.space/2021/05/image-20210515150526897.png" alt="image-20210515150526897" style="zoom:67%;" />

<blockquote>
<p>dummy acknowledge (HIGH) : 无声确认？？？</p>
</blockquote>
<h3 id="总线状态"><a href="#总线状态" class="headerlink" title="总线状态"></a>总线状态</h3><p>总线具有两种状态，<strong>繁忙</strong>（Busy）和 <strong>空闲</strong>（Free），即 SDA电平 “开始” 后，总线进入繁忙状态， SDA电平 “结束” 后，总线进入空闲状态。</p>
<p><strong>注意</strong>：在总线繁忙期间，发生重复的“开始”状态（而不是“结束”状态），由于“重复开始”和 “开始” 功能相同，为了方便，统称为 “开始”，除非特殊说明为 “重复开始”。</p>
<blockquote>
<p>The bus stays busy if a repeated START (Sr) is generated instead of a STOP condition. In this respect, the START (S) and repeated START (Sr) conditions are functionally identical. For the remainder of this document, therefore, the S symbol is used as a generic term to represent both the START and repeated START conditions, unless Sr is particularly relevant.</p>
</blockquote>
<h3 id="传输比特位"><a href="#传输比特位" class="headerlink" title="传输比特位"></a>传输比特位</h3><ul>
<li>SDA线上的字节传输必须满足8位长度。</li>
<li>每次传输数据的字节数不受限制。</li>
<li>每个字节数后都需要跟一个<strong>确认位（Acknowledge bit）</strong>。</li>
<li>当从机无法完整接收或传输一个完整的数据字节时，例如正在产生内部中断等，除非其完成内部的某些功能，否则该从机将能够一直拉低SCL的电平，<strong>强制让主机一直处于等待状态</strong>。只有当从机准备好接收下一个完整的字节并释放SCL时，数据传输才会继续。</li>
</ul>
<blockquote>
<p>Every byte put on the SDA line must be eight bits long. The number of bytes that can be transmitted per transfer is unrestricted. Each byte must be followed by an Acknowledge bit.</p>
<p><strong>Data is transferred with the Most Significant Bit (MSB) first</strong> (see Figure 6). If a slave cannot receive or transmit another complete byte of data until it has performed some other function, for example servicing an internal interrupt, it can hold the clock line SCL LOW to force the master into a wait state. Data transfer then continues when the slave is ready for another byte of data and releases clock line SCL.</p>
</blockquote>
<img src="https://pic.islet.space/2021/05/image-20210514144620803.png" alt="image-20210514144620803" style="zoom:80%;" />



<h3 id="确认标志"><a href="#确认标志" class="headerlink" title="确认标志"></a>确认标志</h3><ul>
<li>每个字节（8比特）后都跟着一个确认位，即前8位数据，第9位确认。</li>
<li><strong>SCL上的时钟信号由主机产生，包括确认位的的第九个时钟脉冲</strong>。</li>
<li>SDA线并不是由主机一直占有的，每发送完一个完整字节后，主机都会释放SDA线，由从机进行数据确认。</li>
<li>发送者在确认时钟脉冲期间释放SDA线，以便接收者可以将SDA线拉低，并且在该时钟脉冲的高电平期间保持稳定的低电平（见图4）。</li>
<li>对于设置（set-up）和保持（Hold）的时间，都应该依照表10中只针对各种不同模式的要求进行设置。</li>
<li>如果SDA电平在第九个时钟脉冲时仍保持高电平，则被定义为 “未确认状态”。则此时主机可以发送一个“结束”标志来结束当前连接，或发送一个“开始”标志来开启一次新的传送。</li>
</ul>
<img src="/home/kali/.config/Typora/typora-user-images/image-20210514154506246.png" alt="image-20210514154506246" style="zoom: 80%;" />

<blockquote>
<p>The acknowledge takes place after every byte. The acknowledge bit allows the receiver to signal the transmitter that the byte was successfully received and another byte may be sent. The master generates all clock pulses, including the acknowledge ninth clock pulse.</p>
<p>The Acknowledge signal is defined as follows: the transmitter releases the SDA line during the acknowledge clock pulse so the <em><strong>receiver can pull the SDA line LOW</strong></em> and it remains stable LOW during the HIGH period of this clock pulse (see Figure 4). Set-up and hold times (specified in Section 6) must also be taken into account.</p>
<p>When SDA remains HIGH during this ninth clock pulse, this is defined as the Not Acknowledge signal. The master can then generate either a STOP condition to abort the transfer, or a repeated START condition to start a new transfer. </p>
</blockquote>
<p><strong>以下为五种“未确认/未应答”的可能情况</strong>：There are five conditions that lead to the generation of a NACK:</p>
<ol>
<li><strong>传输地址错误</strong>：No receiver is present on the bus with the transmitted address so there is no device to respond with an acknowledge.</li>
<li><strong>实时处理中</strong>：The receiver is unable to receive or transmit because it is performing some real-time function and is not ready to start communication with the master.</li>
<li><strong>数据/代码未定义</strong>：During the transfer, the receiver <strong>gets data or commands that it does not understand.</strong></li>
<li><strong>正在传输中</strong>：During the transfer, the receiver <strong>cannot receive any more data bytes</strong>.</li>
<li><strong>未收到结束信号（收发身份未转换）</strong>：A master-receiver must signal the end of the transfer to the slave transmitter.</li>
</ol>
<h3 id="时钟同步"><a href="#时钟同步" class="headerlink" title="时钟同步"></a>时钟同步</h3><p>任意几个主机都可能同时发起数据传输请求，此时只有一个主机和一个从机可以掌握总线进行通信，此时需要通过 <strong>时间同步</strong> 和 <strong>仲裁</strong> 完成对总线的调配。</p>
<p><strong>在单机系统（Single Master System）中，不需要时钟同步和仲裁。</strong></p>
<p>时钟同步是通过I^2^C接口与SCL线的有线-AND连接进行的。</p>
<p>这意味着SCL线上的高电平到低电平的转换会导致相关的主站开始对其低电平周期进行计数（如图7的CLK<del>2</del>），一旦一个主站时钟 CLK<del>1</del> 变为低电平，它就会将SCL线电平拉低，并保持在这个状态，直到另一个时钟 CLK<del>2</del> 达到高电平状态。</p>
<p>然而，如果时钟 CLK<del>2</del> 仍在其低电平周期内，CLK<del>1</del> 的低电平到高电平转换可能不会改变SCL线的状态。</p>
<p>因为SCL线被具有最长的低电平周期的主站 CLK<del>2</del> 保持为低电平，而在这段时间内，低电平周期较短的主站 CLK<del>1</del> 进入高电平等待状态。</p>
<blockquote>
<p>Clock synchronization is performed using the wired-AND connection of I^2^C interfaces to the SCL line. This means that a HIGH to LOW transition on the SCL line causes the masters concerned to start counting off their LOW period and, once a master clock has gone LOW, it holds the SCL line in that state until the clock HIGH state is reached (see Figure 7). However, if another clock is still within its LOW period, the LOW to HIGH transition of this clock may not change the state of the SCL line. The SCL line is therefore held LOW by the master with the longest LOW period. Masters with  shorter LOW periods enter a HIGH wait-state during this time.</p>
</blockquote>
<p>当所有相关的主控器都结束了他们的低电平周期，时钟线被释放并变成高电平。</p>
<p>然后，在主站时钟和SCL线的状态之间没有差异，所有的主站开始计算他们的高电平周期。</p>
<p><strong>第一个完成其高电平周期的主站再次将SCL线拉到低电平</strong>。这样，就产生了一个<strong>同步的SCL时钟</strong>，<strong>其低电平周期由具有最长时钟低电平周期的主站决定</strong>，<strong>其高电平周期由具有最短时钟高电平周期的主站决定</strong>。</p>
<img src="https://pic.islet.space/2021/05/image-20210514170202184.png" alt="image-20210514170202184" style="zoom: 67%;" />



<h3 id="竞争仲裁"><a href="#竞争仲裁" class="headerlink" title="竞争仲裁"></a>竞争仲裁</h3><p>仲裁和同步一样，是指只有在系统中使用一个以上的主站时才需要的协议的一个部分。注意，从机不参与仲裁程序。</p>
<p>一个主站只有在总线空闲时才可以开始传输。两个主站可以在START条件的最小保持时间（tHD;STA）内产生一个START条件，从而在总线上产生一个有效的START条件。然后需要进行仲裁，以确定哪个主站将完成其传输。</p>
<p>仲裁是逐位进行的。在每个比特期间，当SCL为高电平时，每个主站检查SDA电平是否与其所发送的内容相符，期间可能需要很多比特，只要传输的内容相同，两个主站实际上可以无误地完成整个信息传输过程。</p>
<p><mark>当一个主站第一次试图发送一个高电平，但检测到SDA电平为低电平时，主站知道它已经失去了仲裁，并关闭其SDA输出驱动器</mark>。在其他主站被仲裁过程中，正在传输其信息的主站将继续其传输，没有信息丢失。</p>
<p>失去仲裁的主站可以产生时钟脉冲，直到它失去仲裁的字节结束，并且必须在总线空闲时重新尝试传输。</p>
<p><mark>如果一个主站也包含了一个从站功能，并且它在寻址阶段失去了仲裁，有可能获胜的主站正试图对它进行寻址。因此，失败的主站必须立即切换到其从站模式。</mark></p>
<p>图8显示了两个主站的仲裁程序。可能涉及更多，这取决于有多少个主站连接到总线上。</p>
<p><mark>当产生DATA1的主站的内部数据电平与SDA线上的实际电平有差异时，DATA1的输出被关闭。这并不影响由获胜主站发起的数据传输。</mark></p>
<img src="https://pic.islet.space/2021/05/image-20210515142633906.png" alt="image-20210515142633906" style="zoom: 67%;" />



<h3 id="时间拉伸"><a href="#时间拉伸" class="headerlink" title="时间拉伸"></a>时间拉伸</h3><h3 id="从机地址和读取位"><a href="#从机地址和读取位" class="headerlink" title="从机地址和读取位"></a>从机地址和读取位</h3><h3 id="10位寻址"><a href="#10位寻址" class="headerlink" title="10位寻址"></a>10位寻址</h3><h3 id="反转地址"><a href="#反转地址" class="headerlink" title="反转地址"></a>反转地址</h3><h3 id="通用寻址"><a href="#通用寻址" class="headerlink" title="通用寻址"></a>通用寻址</h3><p><img src="https://pic.islet.space/2021/05/image-20210515172907284.png" alt="image-20210515172907284"></p>
<p><img src="https://pic.islet.space/2021/05/image-20210515172945861.png" alt="image-20210515172945861"></p>
<p><img src="https://pic.islet.space/2021/05/image-20210515172958184.png" alt="image-20210515172958184"></p>
<h3 id="软复位"><a href="#软复位" class="headerlink" title="软复位"></a>软复位</h3><p>在发送general call (0000 0000)后，再发送一个 0000 0110 (06h) ，这样两个具有先后顺序的字节来定义软复位。</p>
<p>首先，这种软复位是可选 ，并不是所有设备都会对软复位指令进行响应。</p>
<p>在收到这2个字节的序列时，所有被设计为响应一般调用地址的设备都会复位，并接收其地址的可编程部分。</p>
<blockquote>
<p>On receiving this 2-byte sequence, all devices designed to respond to the general call address reset and take in the programmable part of their address.</p>
</blockquote>
<p>必须采取预防措施，确保设备在施加电源电压后没有拉低SDA或SCL线，因为这些低电平会阻断总线。</p>
<h3 id="总线复位"><a href="#总线复位" class="headerlink" title="总线复位"></a>总线复位</h3><p>SCK信号一直卡在低电平的事件较少发生。</p>
<ul>
<li>如果I^2^C总线设备拥有硬件复位输入，则可以通过优先程序启用硬件中断复位来重置总线。</li>
<li>如果没有硬件复位输入，则通过给设备循环供电，激活强制性的内部开机复位（POR）电路。</li>
</ul>
<p>SDA信号如果一直卡在低电平。</p>
<ul>
<li><p>则主机应该发送九次SCL时钟脉冲，此时令SDA保持低电平的设备在收到九次脉冲后应主动释放总线。</p>
</li>
<li><p>如果九次脉冲没有用，则启用硬件中断复位或循环供电来清除总线。</p>
</li>
</ul>
<h3 id="设备ID"><a href="#设备ID" class="headerlink" title="设备ID"></a>设备ID</h3><p>可选的3字节只读设备ID编码（an optional 3-byte read-only ）：</p>
<ul>
<li>12位是设备制造商编号，具有独一无二性</li>
<li>9位零件ID，由设备制造商写入</li>
<li>3位模具/晶元版本，由设备制造商写入</li>
</ul>
<img src="https://pic.islet.space/2021/05/image-20210515152141963.png" alt="image-20210515152141963" style="zoom:67%;" />

<ol>
<li><p>启动条件</p>
</li>
<li><p> 主站发送保留设备ID的 I^2^C 总线地址，后面的R/W位设置为<code>0</code>（写）：<code>1111 1000</code>。</p>
</li>
<li><p> 主站发送从属地址。LSB是一个 “不关心”的值，只有一个设备必须确认这个字节（拥有I^2^C总线从属地址的设备）。</p>
</li>
<li><p> 主站发送一个 Re-START 条件。</p>
</li>
</ol>
<blockquote>
<p>备注：在 STOP 条件之后，再加上一个 START 条件，就会重置从属状态机，无法进行设备ID读取。另外，在 STOP 条件或 Re-START 条件之后，对另一个从属设备的访问也会重置从属状态机，无法执行Device ID读取。</p>
</blockquote>
<ol start="5">
<li><p> 主站发送保留设备ID的 I^2^C 总线地址，后面的R/W位设置为 <code>1</code>（读）：<code>1111 1001</code>。</p>
</li>
<li><p> 可以进行设备ID读取，从12个制造商位开始（第一个字节+第二个字节的4个MSB），然后是9个部件识别位（第二个字节的4个LSB+第三个字节的5个MSB），然后是三个芯片修订位（第三个字节的3个LSB）。</p>
</li>
<li><p>主站通过NACKing最后一个字节来结束读取序列，从而重置从属设备的状态机，允许主站发送 STOP 条件。</p>
<blockquote>
<p>备注：设备ID的读取可以随时通过发送NACK来停止。</p>
</blockquote>
</li>
</ol>
<p>如果主站在第三个字节之后继续ACK，从站就会滚回第一个字节，并继续发送设备ID序列，直到检测到 NACK。</p>
<h1 id="SPI"><a href="#SPI" class="headerlink" title="SPI"></a>SPI</h1><p>标准：</p>
<h2 id="术语-1"><a href="#术语-1" class="headerlink" title="术语"></a>术语</h2><h2 id="SPI和I-2-C的对比"><a href="#SPI和I-2-C的对比" class="headerlink" title="SPI和I^2^C的对比"></a>SPI和I^2^C的对比</h2><table>
<thead>
<tr>
<th></th>
<th>SPI</th>
<th>I^2^C</th>
</tr>
</thead>
<tbody><tr>
<td>通信模式</td>
<td>全双工<br><em>（是指单主从设备之间的全双工，从设备之间无法进行通信）</em></td>
<td>半双工<br><em>（任意主从设备可以分时复用同一条通信线路）</em></td>
</tr>
<tr>
<td>主从模式</td>
<td>一主多从</td>
<td>多主多从</td>
</tr>
<tr>
<td>引脚占用</td>
<td>从设备越多，对主机占用的引脚较多<br>主设备占用引脚：3+n<br>从设备占用引脚：4<br><em>（n为从设备数）</em></td>
<td>主从设备均占用：2</td>
</tr>
<tr>
<td>应答响应</td>
<td>无</td>
<td>有</td>
</tr>
<tr>
<td>传输速率</td>
<td>最高：</td>
<td>最高：3.4Mbps</td>
</tr>
<tr>
<td>从机选择</td>
<td>通过 <strong>CS(SS)选择引脚</strong> 来选择</td>
<td>通过 <strong>器件地址</strong> 来选择</td>
</tr>
<tr>
<td>数据采样</td>
<td>在SCLK边沿采样</td>
<td>在SCL高电平采样</td>
</tr>
<tr>
<td>通信距离</td>
<td>短</td>
<td>短</td>
</tr>
</tbody></table>
<h1 id="UART"><a href="#UART" class="headerlink" title="UART"></a>UART</h1><p>标准：</p>
<h1 id="TDM"><a href="#TDM" class="headerlink" title="TDM"></a>TDM</h1><p>标准：</p>
<h1 id="I-2-S"><a href="#I-2-S" class="headerlink" title="I^2^S"></a>I^2^S</h1><p>标准：</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://islet.space/2021/05/13/Linux/Firewalld/2021-05-13-Firewalld%E9%98%B2%E7%81%AB%E5%A2%99%E8%AF%A6%E8%A7%A3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liewzheng">
      <meta itemprop="description" content="笔记分享的旮旯孤岛而已">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder的孤岛">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/05/13/Linux/Firewalld/2021-05-13-Firewalld%E9%98%B2%E7%81%AB%E5%A2%99%E8%AF%A6%E8%A7%A3/" class="post-title-link" itemprop="url">Firewalld防火墙详解</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-05-13 14:10:00" itemprop="dateCreated datePublished" datetime="2021-05-13T14:10:00+08:00">2021-05-13</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-05-14 19:47:48" itemprop="dateModified" datetime="2021-05-14T19:47:48+08:00">2021-05-14</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a target="_blank" rel="noopener" href="https://blog.51cto.com/andyxu/2137046">blog.51cto.com</a></p>
<p>众所周知，在RHEL7系统中，firewalld防火墙取代了iptables防火墙。我们都知道iptables的防火墙策略是交由内核层面的netfilter网络过滤器来处理的，而firewalld则是交由内核层面的nftables包过滤框架来处理。<br>相较于iptables防火墙而言，firewalld支持动态更新技术并加入了区域（zone）的概念。简单来说，区域就是firewalld预先准备了几套防火墙策略集合（策略模板），用户可以根据生产场景的不同而选择合适的策略集合，从而实现防火墙策略之间的快速切换。</p>
<blockquote>
<p>Firewalld provides a dynamically managed firewall with support for network/firewall zones to define the trust level of network connections or interfaces. It has support for IPv4, IPv6 firewall settings and for ethernet bridges and has <strong>a separation of runtime and permanent configuration options.</strong> It also supports an interface for services or applications to add firewall rules directly.</p>
</blockquote>
<h1 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h1><h2 id="区域"><a href="#区域" class="headerlink" title="区域"></a>区域</h2><p><strong>表1：firewalld中常用的区域名称及策略规则</strong></p>
<table>
<thead>
<tr>
<th>区域（zone）</th>
<th>默认策略规则</th>
</tr>
</thead>
<tbody><tr>
<td>trusted</td>
<td>允许所有的数据包进出</td>
</tr>
<tr>
<td>home</td>
<td>拒绝进入的流量，除非与出去的流量相关；而如果流量与ssh、mdns、ipp-client、amba-client与dhcpv6-client服务相关，则允许进入</td>
</tr>
<tr>
<td>Internal</td>
<td>等同于home区域</td>
</tr>
<tr>
<td>work</td>
<td>拒绝进入的流量，除非与出去的流量相关；而如果流量与ssh、ipp-client与dhcpv6-client服务相关，则允许进入</td>
</tr>
<tr>
<td>public</td>
<td>拒绝进入的流量，除非与出去的流量相关；而如果流量与ssh、dhcpv6-client服务相关，则允许进入</td>
</tr>
<tr>
<td>external</td>
<td>拒绝进入的流量，除非与出去的流量相关；而如果流量与ssh服务相关，则允许进入</td>
</tr>
<tr>
<td>dmz</td>
<td>拒绝进入的流量，除非与出去的流量相关；而如果流量与ssh服务相关，则允许进入</td>
</tr>
<tr>
<td>block</td>
<td>拒绝进入的流量，除非与出去的流量相关</td>
</tr>
<tr>
<td>drop</td>
<td>拒绝进入的流量，除非与出去的流量相关</td>
</tr>
</tbody></table>
<blockquote>
<p>These are the zones provided by firewalld sorted according to the default trust level of the zones <strong>from untrusted to trusted</strong>:</p>
<p><strong>drop</strong> : Any incoming network packets are dropped, there is no reply. Only outgoing network connections are possible.</p>
<p><strong>block</strong> : Any incoming network connections are rejected with an icmp-host-prohibited message for IPv4 and icmp6-adm-prohibited for IPv6. Only network connections initiated within this system are possible.</p>
<p><strong>public</strong> : For use in public areas. You do not trust the other computers on networks to not harm your computer. Only selected incoming connections are accepted.</p>
<p><strong>external</strong> : For use on external networks with masquerading enabled especially for routers. You do not trust the other computers on networks to not harm your computer. Only selected incoming connections are accepted.</p>
<p><strong>dmz</strong> : For computers in your demilitarized zone that are publicly-accessible with limited access to your internal network. Only selected incoming connections are accepted.</p>
<p><strong>work</strong> : For use in work areas. You mostly trust the other computers on networks to not harm your computer. Only selected incoming connections are accepted.</p>
<p><strong>home</strong> : For use in home areas. You mostly trust the other computers on networks to not harm your computer. Only selected incoming connections are accepted.</p>
<p><strong>internal</strong> : For use on internal networks. You mostly trust the other computers on the networks to not harm your computer. Only selected incoming connections are accepted.</p>
<p><strong>trusted</strong> : All network connections are accepted.</p>
</blockquote>
<p><strong>动静态更新技术之间的区别</strong>：iptables每一个更改都需要先清除所有旧有的规则，然后重新加载所有的规则（包括新的和修改后的规则）；<mark>而firewalld任何规则的变更都不需要对整个防火墙规则重新加载</mark>。</p>
<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>firewalld服务的主配置文件是firewalld.conf，防火墙策略的配置文件是以xml格式为主，存放在以下两个目录里。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/etc/firewalld   # 用户配置文件</span><br><span class="line">/usr/lib/firewalld    #系统配置文件，预定义配置文件</span><br></pre></td></tr></table></figure>


<p>firewalld有基于CLI（命令行界面）和基于GUI（图形用户界面)两种管理方式，即：firewall-cmd（终端管理工具）和firewall-config（图形管理工具）。</p>
<p>firewalld的参数一般都是以“长格式”来提供的，但是在RHEL7系统里支持部分命令的参数补齐，其中就包括firewall-cmd命令，也就是说可以用Tab键来补齐长格式参数，很酷吧。</p>
<h2 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h2><p><strong>表2：firewall-cmd命令中使用的参数以及作用</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>–get-default-zone</td>
<td>查访默认的区域名称</td>
</tr>
<tr>
<td>–set-default-zone=&lt;区域名称&gt;</td>
<td>设置默认的区域，使其永久生效</td>
</tr>
<tr>
<td>–get-zones</td>
<td>显示可用的区域</td>
</tr>
<tr>
<td>–get-services</td>
<td>显示预定义的服务</td>
</tr>
<tr>
<td>–get-active-zones</td>
<td>显示当前正在使用的区域、来源地址和网卡名称</td>
</tr>
<tr>
<td>–add-source=</td>
<td>将源自此IP或子网的流量导向指定的区域</td>
</tr>
<tr>
<td>–remove-source=</td>
<td>不再将源自此IP或子网的流量导向这个区域</td>
</tr>
<tr>
<td>–add-interface=&lt;网卡名称&gt;</td>
<td>将源自该网卡的所有流量都导向某个指定区域</td>
</tr>
<tr>
<td>–change-interface=&lt;网卡名称&gt;</td>
<td>将某个网卡与区域进行关联</td>
</tr>
<tr>
<td>–list-all</td>
<td>显示当前区域的网卡配置参数、资源、端口以及服务等信息</td>
</tr>
<tr>
<td>–list-all-zones</td>
<td>显示所有区域的网卡配置参数、资源、端口以及服务等信息</td>
</tr>
<tr>
<td>–add-service=&lt;服务名&gt;</td>
<td>设置默认区域允许该服务的流量</td>
</tr>
<tr>
<td>–add-port=&lt;端口号/协议&gt;</td>
<td>设置默认区域允许该端口的流量</td>
</tr>
<tr>
<td>–remove-service=&lt;服务名&gt;</td>
<td>设置默认区域不再允许该服务的流量</td>
</tr>
<tr>
<td>–remove-port=&lt;端口号/协议&gt;</td>
<td>设置默认区域不再允许该端口的流量</td>
</tr>
<tr>
<td>–reload</td>
<td>让“永久生效”的配置规则立即生效，并覆盖当前的配置规则</td>
</tr>
<tr>
<td>–panic-on</td>
<td>开启应急状况模式</td>
</tr>
<tr>
<td>–panic-off</td>
<td>关闭应急状况模式</td>
</tr>
</tbody></table>
<p>firewalld配置的防火墙策略默认为运行时（Runtime）模式，又称为当前生效模式，而且随着系统的重启会失效。如果想让配置策略一直存在，就需要使用永久（Permanent）模式了，方法就是在firewall-cmd命令后面添加–permanent参数，这样配置的防火墙策略就可以永久生效了。但是，永久生效模式有一个“不近人情”的特点，就是使用它设置的策略只有在系统重启后才会生效。如果想让配置的永久策略立即生效，需要手动执行firewall-cmd –reload命令。</p>
<p><em>注：remove掉ssh服务或者ssh端口，当前远程登陆会话不会断开，退出后就无法远程连接了。</em></p>
<p>firewalld服务启动、重启、停止</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl start firewalld</span><br><span class="line">systemctl restart firewalld</span><br><span class="line">systemctl stop firewalld</span><br></pre></td></tr></table></figure>



<p>重新加载防火墙配置<br><code>firewall-cmd --reload</code></p>
<p>查看firewalld的运行状态<br><code>firewall-cmd --state</code></p>
<p>查看默认当前使用的区域<br><code>firewall-cmd --get-default-zone</code></p>
<p>查看系统默认活动区域名称、来源地址和关联的网卡<br><code>firewall-cmd --get-active-zones</code></p>
<p><img src="https://pic.islet.space/2021/05/777d5cabb7eb51fbb84c7058129368d9.png" alt="firewalld防火墙详解"></p>
<p>查看所有可用区域<br><code>firewall-cmd --get-zones</code></p>
<p>查看区域的所有设置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone&#x3D;internal --list-all   </span><br><span class="line">firewall-cmd --list-all   </span><br></pre></td></tr></table></figure>

<p><img src="https://pic.islet.space/2021/05/4d9b1b3e6c45a33748d4892e6dd2736d.png" alt="firewalld防火墙详解"></p>
<blockquote>
<p>Target：目标<br>icmp-block-inversion：ICMP协议类型黑白名单开关（yes/no）<br>Interfaces：关联的网卡接口<br>sources：来源，可以是IP地址，也可以是mac地址<br>services：允许的服务<br>ports：允许的目标端口，即本地开放的端口<br>protocols：允许通过的协议<br>masquerade：是否允许伪装（yes/no），可改写来源IP地址及mac地址<br>forward-ports：允许转发的端口<br>source-ports：允许的来源端口<br>icmp-blocks：可添加ICMP类型，当icmp-block-inversion为no时，这些ICMP类型被拒绝；当icmp-block-inversion为yes时，这些ICMP类型被允许。<br>rich rules：富规则，即更细致、更详细的防火墙规则策略，它的优先级在所有的防火墙策略中也是最高的。</p>
</blockquote>
<h3 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h3><p>查看所有预设的服务<br><code>firewall-cmd --get-services</code><br>此时将会列出/usr/lib/firewalld/services/目录中所有的服务名称。</p>
<p>查看所有区域的设置<br><code>firewall-cmd --list-all-zones</code></p>
<p>查看指定网卡所在的区域<br><code>firewall-cmd --get-zone-of-interface=ens32</code></p>
<p>把firewalld的当前默认区域设置为drop，此为永久设置<br><code>firewall-cmd --set-default-zone=drop</code></p>
<p>把ens32网卡关联的区域修改为drop</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --permanent --zone&#x3D;drop --change-interface&#x3D;ens32   # 永久设置</span><br><span class="line">firewall-cmd --zone&#x3D;drop --change-interface&#x3D;ens32   # 当前生效</span><br></pre></td></tr></table></figure>

<p><img src="https://pic.islet.space/2021/05/aafb80274a54961a3c0c1a50989b7fd3.png" alt="firewalld防火墙详解"></p>
<p>我们后面的设置命令将全部使用运行时模式，即当前生效模式。<br>将来自ens33网卡的流量都作用到默认的drop区域</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone&#x3D;drop -add-interface&#x3D;ens33   # 作用在指定区域</span><br><span class="line">firewall-cmd -add-interface&#x3D;ens33   # 作用在默认区域</span><br><span class="line">firewall-cmd -remove-interface&#x3D;ens33  # 禁止ens33网卡作用在drop区域</span><br></pre></td></tr></table></figure>

<p><em>注：不指定–zone参数的话，将会对默认区域进行设置</em><br>启动关闭firewalld防火墙服务的应急状况模式，远程连接服务器时请慎用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --panic-on  </span><br><span class="line">firewall-cmd --panic-off  </span><br><span class="line">firewall-cmd --query-panic  </span><br></pre></td></tr></table></figure>

<p>设置一个来源地址作用在drop区域上面</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone&#x3D;drop --add-source&#x3D;192.168.1.12  # 作用在指定区域</span><br><span class="line">firewall-cmd --add-source&#x3D;192.168.1.12  # 作用在默认区域</span><br><span class="line">firewall-cmd --remove-source&#x3D;192.168.1.12  # 取消源IP为192.168.1.12的包作用在drop区域</span><br></pre></td></tr></table></figure>

<p>说明：凡是IP为192.168.1.12发来包将会使用drop区域设置的规则</p>
<p>对于一个接收到的请求具体使用哪个zone，firewalld是通过三种方式来判断的：</p>
<p>1、source，来源地址<br>2、Interface，接收请求的网卡<br>3、firewalld配置的默认区域（zone）</p>
<p>这三个方式的优先级按顺序依次降低，也就是说如果按照source可以找到就不会再按interface去找，如果前两个都找不到才会使用第三个默认区域。<br>查询drop区域是否允许请求ssh和https服务的流量</p>
<h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><p>在drop区域开放https服务<br><code>firewall-cmd --zone=drop --add-service=https</code></p>
<p>取消开放https服务，即禁止https服务<br><code>firewall-cmd --zone=drop --remove-service=https</code></p>
<p>开放22端口<br><code>firewall-cmd --zone=drop --add-port=22/tcp</code></p>
<p>取消开放22端口<br><code>firewall-cmd --zone=drop --remove-port=22/tcp</code></p>
<p>开放8080和8081端口<br><code>firewall-cmd --zone=drop --add-port=8080-8081/tcp</code></p>
<p><strong>查询drop区域开放了哪些端口</strong><br><code>firewall-cmd --zone=drop --list-ports</code></p>
<p>允许icmp协议流量，即允许ping<br><code>firewall-cmd --zone=drop --add-protocol=icmp</code></p>
<p>取消允许icmp协议的流量，即禁ping<br><code>firewall-cmd --zone=drop --remove-protocol=icmp</code></p>
<p>查询drop区域开放了哪些协议<br><code>firewall-cmd --zone=drop --list-protocols</code></p>
<h3 id="端口转发"><a href="#端口转发" class="headerlink" title="端口转发"></a>端口转发</h3><p>将原本访问本机888端口的流量转发到本机22端口<br><code>firewall-cmd --zone=drop --add-forward-port=port=888:proto=tcp:toport=22</code></p>
<p>将原本访问本机888端口的流量转发到ip为192.168.2.208的主机的22端口，需要开启masquerade</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone&#x3D;drop --add-masquerade</span><br><span class="line">firewall-cmd --zone&#x3D;drop --add-forward-port&#x3D;port&#x3D;888:proto&#x3D;tcp:toport&#x3D;22:toaddr&#x3D;192.168.2.208</span><br></pre></td></tr></table></figure>

<p>测试端口转发功能是否生效<br>在客户端尝试访问192.168.2.210主机的888端口，连上去后发现实际连接的是192.168.2.208主机，测试OK。</p>
<p><img src="https://pic.islet.space/2021/05/34e156798d037e1dcc1e63d506fd2960.png" alt="firewalld防火墙详解"></p>
<p><img src="https://pic.islet.space/2021/05/fec17bffb6fb66b9c077d844956a7699.png" alt="firewalld防火墙详解"></p>
<h3 id="富规则"><a href="#富规则" class="headerlink" title="富规则"></a>富规则</h3><p>接下来我们来看富规则的设置，即 <em><strong>rich rules</strong></em></p>
<p>允许192.168.2.208主机的所有流量<br><code>firewall-cmd --zone=drop --add-rich-rule=&quot;rule family=&quot;ipv4&quot; source address=&quot;192.168.2.208&quot; accept&quot;</code></p>
<p>允许192.168.2.208主机的icmp协议，即允许192.168.2.208主机ping<br><code>firewall-cmd --add-rich-rule=&quot;rule family=&quot;ipv4&quot; source address=&quot;192.168.2.208&quot; protocol value=&quot;icmp&quot; accept&quot;</code></p>
<p>取消允许192.168.2.208主机的所有流量<br><code>firewall-cmd --zone=drop --remove-rich-rule=&quot;rule family=&quot;ipv4&quot; source address=&quot;192.168.2.208&quot; accept&quot;</code></p>
<p>允许192.168.2.208主机访问ssh服务<br><code>firewall-cmd --zone=drop --add-rich-rule=&quot;rule family=&quot;ipv4&quot; source address=&quot;192.168.2.208&quot; service name=&quot;ssh&quot; accept&quot;</code></p>
<p>禁止192.168.2.208访问https服务，并返回错误信息<br><code>firewall-cmd --zone=drop --add-rich-rule=&quot;rule family=&quot;ipv4&quot; source address=&quot;192.168.2.208&quot; service name=&quot;https&quot; reject&quot;</code><br><em>注：如果是drop的话是直接丢弃，会返回timeout（连接超时）</em></p>
<p>允许192.168.2.0/24网段的主机访问22端口<br><code>firewall-cmd --zone=drop --add-rich-rule=&quot;rule family=&quot;ipv4&quot; source address=&quot;192.168.2.0/24&quot; port protocol=&quot;tcp&quot; port=&quot;22&quot; accept&quot;</code></p>
<p>每分钟允许2个新连接访问ftp服务<br><code>firewall-cmd --add-rich-rule=&quot;rule service name=ftp limit value=2/m accept&quot;</code></p>
<p>允许新的ipv4和ipv6连接ftp，并使用日志和审核，每分钟允许访问一次<br><code>firewall-cmd --add-rich-rule=&quot;rule service name=ftp log limit value=&quot;1/m&quot; audit accept&quot;</code></p>
<p>拒绝来自192.168.2.0/24网段的连接，10秒后自动取消<br><code>firewall-cmd --add-rich-rule=&quot;rule family=ipv4 source address=192.168.2.0/24 reject&quot; --timeout=10</code></p>
<p>允许ipv6地址为2001:db8::/64子网的主机访问dns服务，并且每小时审核一次，300秒后自动取消<br><code>firewall-cmd --add-rich-rule=&quot;rule family=ipv6 source address=&quot;2001:db8::/64&quot; service name=&quot;dns&quot; audit limit value=&quot;1/h&quot; reject&quot; --timeout=300</code></p>
<p>将来自192.168.2.0/24网段访问本机80端口的流量转发到本机的22端口<br><code>firewall-cmd --zone=drop --add-rich-rule=&quot;rule family=ipv4 source address=192.168.2.0/24 forward-port port=80 protocol=tcp to-port=22&quot;</code></p>
<p>将来自192.168.2.0/24网段访问本地80端口的流量转发到192.168.2.208主机的22端口<br><code>firewall-cmd --zone=drop --add-rich-rule=&quot;rule family=ipv4 source address=192.168.2.0/24 forward-port port=80 protocol=tcp to-port=22 to-addr=192.168.2.208&quot;</code></p>
<p>伪装，将来自局域网192.168.2.0/24网段访问外网的流量映射为网络出口公网IP，即修改源IP地址</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone&#x3D;drop --add-masquerade</span><br><span class="line">firewall-cmd --zone&#x3D;drop --add-rich-rule&#x3D;&quot;rule family&#x3D;ipv4 source address&#x3D;192.168.2.0&#x2F;24 masquerade&quot;</span><br></pre></td></tr></table></figure>

<p>好了，写的差不多了，工作中基本上够用了</p>
<h2 id="GUI配置"><a href="#GUI配置" class="headerlink" title="GUI配置"></a>GUI配置</h2><p>在RHEL7之前的发行版本默认的防火墙中，几乎没有图形化的防火墙管理工具，但是firewalld却有，firewall-config是firewalld防火墙配置管理工具的GUI（图开用户界面）版本，几乎可以实现所有命令行执行的操作。即使没有扎实的Linux命令基础，也完合可以通过它来妥善配置firewalld防火墙策略。Firewall-config的界面如下图所示，功能具体如下：</p>
<p><img src="https://pic.islet.space/2021/05/cfe328ae0f110db0798a9d5edde8a2ba.png" alt="firewalld防火墙详解"></p>
<p>1、选择运行时（Runtime）模式或永久（Permanent）模式。<br>2、可选的策略集合区域列表。<br>3、常用的系统服务列表。<br>4、当前正在使用的区域。<br>5、管理当前被选中区域中的服务。<br>6、管理当前被选中区域中的端口。<br>7、开启或关闭SNAT（源地址转换协议）技术。<br>8、设置端口转发策略。<br>9、控制请求icmp服务的流量。<br>10、管理防火墙的富规则。<br>11、管理网卡设备。<br>12、被选中区域的服务，若勾选了相应服务前面的复选框，则表示允许与之相关的流量。<br>13、Firewall-config工具的运行状态。</p>
<p>对外开放http服务，如下图</p>
<p><img src="https://pic.islet.space/2021/05/fc3e7d116afe83c1bfe5980bfd928849.png" alt="firewalld防火墙详解"></p>
<p>添加一条防火墙规则，使其放行访问8080-8088端口（TCP协议）的流量，并且永久生效</p>
<p><img src="https://pic.islet.space/2021/05/b9719667bc933bd079c526d733de7646.png" alt="firewalld防火墙详解"></p>
<p>单击Options菜单中的Reload Firewalld选项，让上面配置的永久规则立即生效，这与在命令行中执行–reload参数的效果一样。</p>
<p><img src="https://pic.islet.space/2021/05/8bbca43ed6964afbbeeff8ff711dbcde.png" alt="firewalld防火墙详解"></p>
<p>SNAT技术相信很多人都知道，那现在我们来开启SNAT技术，其实就是命令行下的masquerade。</p>
<p><img src="https://pic.islet.space/2021/05/695086a6a2aaf59d79bfe99bb5a02d85.png" alt="firewalld防火墙详解"></p>
<p>下面我们来配置一个端口转发规则，将888端口的流量转发到其他主机的22端口上。<br><em>注：转发本机端口不需要开启masquerade，转发到别的主机才需要开启masquerade。</em></p>
<p><img src="https://pic.islet.space/2021/05/e66fb33793bf0ab48346c83b6a383d68.png" alt="firewalld防火墙详解"></p>
<p>配置富规则，允许192.168.2.206主机访问本机的1234端口号</p>
<p><img src="https://pic.islet.space/2021/05/5e75f674b7cbf921f7e2c0d3d13384e9.png" alt="firewalld防火墙详解"></p>
<p>最后来看一下区域和网卡的关联，增加网卡的话只需要输入网卡名称即可。</p>
<p><img src="https://pic.islet.space/2021/05/51e73b7f425667cd83cc981c26fea0a2.png" alt="firewalld防火墙详解"></p>
<p>下面是我自己写的一个简单的防火墙初始化脚本，5210是ssh端口号，192.168.2.208是<strong>保垒机</strong>，192.168.2.206是<strong>备用ssh机器</strong>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop firewalld</span><br><span class="line">\cp -p &#x2F;usr&#x2F;lib&#x2F;firewalld&#x2F;zones&#x2F;drop.xml &#x2F;etc&#x2F;firewalld&#x2F;zones&#x2F;</span><br><span class="line">systemctl start firewalld</span><br><span class="line">firewall-cmd --set-default-zone&#x3D;drop</span><br><span class="line">firewall-cmd --permanent --zone&#x3D;drop --change-interface&#x3D;ens32</span><br><span class="line">firewall-cmd --permanent --zone&#x3D;drop --add-service&#x3D;https</span><br><span class="line">firewall-cmd --permanent --zone&#x3D;drop --add-protocol&#x3D;icmp</span><br><span class="line">firewall-cmd --permanent --zone&#x3D;drop --add-masquerade</span><br><span class="line">firewall-cmd --permanent --zone&#x3D;drop --add-rich-rule&#x3D;&quot;rule family&#x3D;&quot;ipv4&quot; source address&#x3D;&quot;192.168.2.208&quot; port protocol&#x3D;&quot;tcp&quot; port&#x3D;&quot;5210&quot; accept&quot;</span><br><span class="line">firewall-cmd --permanent --zone&#x3D;drop --add-rich-rule&#x3D;&quot;rule family&#x3D;&quot;ipv4&quot; source address&#x3D;&quot;192.168.2.206&quot; port protocol&#x3D;&quot;tcp&quot; port&#x3D;&quot;5210&quot; accept&quot;</span><br><span class="line">firewall-cmd --permanent --zone&#x3D;drop --add-rich-rule&#x3D;&quot;rule family&#x3D;&quot;ipv4&quot; source address&#x3D;&quot;116.226.230.115&quot; port protocol&#x3D;&quot;tcp&quot; port&#x3D;&quot;8023&quot; accept&quot;</span><br><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure>

<p>​          </p>
<p>​    </p>
<p><a target="_blank" rel="noopener" href="https://firewalld.org/documentation/howto/enable-and-disable-firewalld.html">firewalld.org</a></p>
<h1 id="Enable-and-Disable-firewalld"><a href="#Enable-and-Disable-firewalld" class="headerlink" title="Enable and Disable firewalld"></a>Enable and Disable firewalld</h1><p>firewalld provides an init script for systems using classic  SysVinit and also a systemd service file. The following documentation is about the systemd service used in Fedora, RHEL and CentOS  distributions.</p>
<p>It is not recommended to use iptables directly while firewalld is  running as this could lead into some unexpected issues. If a user, for  example, is removing base rules or chains of the chain structure, then a firewalld reload might be needed to create them again.</p>
<h2 id="Install-and-enable-firewalld"><a href="#Install-and-enable-firewalld" class="headerlink" title="Install and enable firewalld"></a>Install and enable firewalld</h2><p>If the iptables, ip6tables, ebtables and ipset services are in use:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">systemctl disable --now iptables.service</span><br><span class="line">systemctl disable --now ip6tables.service</span><br><span class="line">systemctl disable --now etables.service</span><br><span class="line">systemctl disable --now ipset.service</span><br><span class="line">dnf install firewalld firewall-config firewall-applet</span><br><span class="line">systemctl unmask --now firewalld.service</span><br><span class="line">systemctl enable --now firewalld.service</span><br></pre></td></tr></table></figure>

<p>To check the firewall state you have different options. The fist option is to use <code>systemctl status firewalld</code> the other one is to use <code>firewall-cmd --state</code>.</p>
<p>The output of the systemctl command should look like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ systemctl status firewalld</span><br><span class="line">● firewalld.service - firewalld - dynamic firewall daemon</span><br><span class="line">   Loaded: loaded (&#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system&#x2F;firewalld.service; enabled; vendor pr</span><br><span class="line">   Active: active (running) since Wed 2016-06-29 14:28:51 CEST; 1 weeks 6 days a</span><br><span class="line">     Docs: man:firewalld(1)</span><br><span class="line"> Main PID: 24540 (firewalld)</span><br><span class="line">    Tasks: 2 (limit: 512)</span><br><span class="line">   CGroup: &#x2F;system.slice&#x2F;firewalld.service</span><br><span class="line">           └─24540 &#x2F;usr&#x2F;bin&#x2F;python3 -Es &#x2F;usr&#x2F;sbin&#x2F;firewalld --nofork --nopid</span><br></pre></td></tr></table></figure>

<p>The output of the firewall-cmd command should look like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ firewall-cmd --state</span><br><span class="line">running</span><br></pre></td></tr></table></figure>

<h2 id="Install-and-enable-iptables-ip6tables-ebtables-and-ipset-services"><a href="#Install-and-enable-iptables-ip6tables-ebtables-and-ipset-services" class="headerlink" title="Install and enable iptables, ip6tables, ebtables and ipset services"></a>Install and enable iptables, ip6tables, ebtables and ipset services</h2><p>If firewalld is enabled and you want to enable the iptables, ip6tables, ebtables and ipset services instead:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">dnf install iptables-services ebtables ipset-service</span><br><span class="line">systemctl mask --now firewalld.service</span><br><span class="line">systemctl enable --now iptables.service</span><br><span class="line">systemctl enable --now ip6tables.service</span><br><span class="line">systemctl enable --now etables.service</span><br><span class="line">systemctl enable --now ipset.service</span><br></pre></td></tr></table></figure>

<p>The use of the mask line is recommended as systemd will start  firewalld if there is another service requires it or if the D-Bus  interface of firewalld is used. If the service only gets disabled, then  it will not be auto started anymore.</p>
<p>​                          </p>
<p>​          </p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://islet.space/2021/05/13/Linux/SSH/%E4%BD%BF%E7%94%A8%20SSH-Key%20%E7%99%BB%E5%BD%95%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E5%99%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liewzheng">
      <meta itemprop="description" content="笔记分享的旮旯孤岛而已">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder的孤岛">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/05/13/Linux/SSH/%E4%BD%BF%E7%94%A8%20SSH-Key%20%E7%99%BB%E5%BD%95%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E5%99%A8/" class="post-title-link" itemprop="url">使用 SSH-Key 登录远程服务器</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-05-13 10:00:00" itemprop="dateCreated datePublished" datetime="2021-05-13T10:00:00+08:00">2021-05-13</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-05-14 19:50:08" itemprop="dateModified" datetime="2021-05-14T19:50:08+08:00">2021-05-14</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/fab3252b3192">jianshu.com</a></p>
<p>ssh 提供两种级别的安全认证：</p>
<ol>
<li>基于口令的安全认证</li>
<li>基于密钥的安全认证</li>
</ol>
<h2 id="基于口令的安全认证"><a href="#基于口令的安全认证" class="headerlink" title="基于口令的安全认证"></a>基于口令的安全认证</h2><p>需要知道用户名和密码即可登录，该连接是加密的，但客户端不能确认目标主机是否为“伪造的”，也不能保证口令安全。</p>
<p>远程主机的 /etc/ssh/sshd_config 需配置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PasswordAuthentication yes</span><br></pre></td></tr></table></figure>

<p>重启 sshd 使改动生效：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ &#x2F;etc&#x2F;init.d&#x2F;sshd reload</span><br></pre></td></tr></table></figure>

<h2 id="基于密钥的安全认证"><a href="#基于密钥的安全认证" class="headerlink" title="基于密钥的安全认证"></a>基于密钥的安全认证</h2><p>需要用户持有“公钥/私钥对”，远程服务器持有公钥，本地持有私钥。</p>
<p>客户端向服务器发出请求。服务器收到请求之后，先在用户的主目录下找到该用户的公钥，然后对比用户发送过来的公钥。如果一致，服务器用公钥加密“质询”并发送给客户端。客户端收到“质询”后用私钥解密，再发还给服务器。认证结束。</p>
<p>生成 ssh-key，选加密算法（rsa、dsa），给秘钥命名（可选）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen -t rsa -C &quot;name&quot;</span><br></pre></td></tr></table></figure>

<p>passphrase 是证书口令，以加强安全性，避免证书被恶意复制。</p>
<p>会在 <code>~.ssh</code> 下生成 <code>id_rsa</code>, <code>id_rsa.pub</code> 两个文件，分别是 私钥/公钥。</p>
<p><mark>公钥需保存到远程服务器 <code>~/.ssh/authorized_keys</code> 里，私钥由客户端本地留存。</mark></p>
<p>要保证 <code>.ssh</code> 和 <code>authorized_keys</code> 都只有用户自己有写权限。否则验证无效。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ chmod -R 700 ~&#x2F;.ssh&#x2F;</span><br><span class="line">$ chmod 600 ~&#x2F;.ssh&#x2F;authorized_keys</span><br></pre></td></tr></table></figure>

<h2 id="ssh-配置的一些实践"><a href="#ssh-配置的一些实践" class="headerlink" title="ssh 配置的一些实践"></a>ssh 配置的一些实践</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ vim &#x2F;etc&#x2F;ssh&#x2F;sshd_config</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PermitRootLogin no</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">StrictModes no</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">RSAAuthentication yes</span><br><span class="line">PubkeyAuthentication yes</span><br><span class="line">AuthorizedKeysFile %h&#x2F;.ssh&#x2F;authorized_keys</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PasswordAuthentication no</span><br></pre></td></tr></table></figure>

<h2 id="持有多个-ssh-key-时的使用方法"><a href="#持有多个-ssh-key-时的使用方法" class="headerlink" title="持有多个 ssh-key 时的使用方法"></a>持有多个 ssh-key 时的使用方法</h2><p>简单情况下，通过手动指定私钥文件登录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh username@hostname -i ~&#x2F;.ssh&#x2F;my_id_rsa</span><br></pre></td></tr></table></figure>

<p>觉得麻烦可以配置客户端的 <code>/etc/ssh/ssh_config</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">IdentityFile ~&#x2F;.ssh&#x2F;id_rsa</span><br><span class="line"></span><br><span class="line">IdentityFile ~&#x2F;.ssh&#x2F;my_id_rsa</span><br></pre></td></tr></table></figure>

<p>你也可以使用 SSH Agent，下面以使用 GitHub 为场景简单介绍。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen -t rsa -C &#39;second@mail.com&#39;</span><br><span class="line">$ ssh-add ～&#x2F;.ssh&#x2F;id_rsa_second</span><br></pre></td></tr></table></figure>

<p>创建 <code>~/.ssh/config</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Host github.com</span><br><span class="line">HostName github.com</span><br><span class="line">User git</span><br><span class="line">IdentityFile C:&#x2F;Users&#x2F;username&#x2F;.ssh&#x2F;id_rsa</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Host github-second</span><br><span class="line">HostName github.com</span><br><span class="line">User git</span><br><span class="line">IdentityFile C:&#x2F;Users&#x2F;username&#x2F;.ssh&#x2F;id_rsa_second</span><br></pre></td></tr></table></figure>

<p>配置完成后，在连接非默认账号的仓库时，远端地址要修改为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote add test git@github-second:second&#x2F;test.git</span><br></pre></td></tr></table></figure>

<p>​          </p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://islet.space/2021/05/11/Computer/2021-05-11-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liewzheng">
      <meta itemprop="description" content="笔记分享的旮旯孤岛而已">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder的孤岛">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/05/11/Computer/2021-05-11-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="post-title-link" itemprop="url">数据库学习笔记</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-05-11 19:11:00" itemprop="dateCreated datePublished" datetime="2021-05-11T19:11:00+08:00">2021-05-11</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-05-14 19:47:28" itemprop="dateModified" datetime="2021-05-14T19:47:28+08:00">2021-05-14</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/database/" itemprop="url" rel="index"><span itemprop="name">database</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="数据库入门"><a href="#数据库入门" class="headerlink" title="数据库入门"></a>数据库入门</h1><h4 id="数据库相关从业"><a href="#数据库相关从业" class="headerlink" title="数据库相关从业"></a>数据库相关从业</h4><p><strong>前面五种</strong>：重点是设计和应用，侧重于软件和数据逻辑层面。</p>
<p>数据库应用开发 (application development)</p>
<blockquote>
<p>除了基本的SQL方面的知识，还要对开发流程，软件工程，各种框架和开发工具等等<br>数据库应用开发这个方向上的机会最多，职位最多</p>
</blockquote>
<p>数据建模专家 (data modeler)</p>
<blockquote>
<p>除了基本的SQL方面的知识，非常熟悉数据库原理，数据建模<br>负责将用户对数据的需求转化为数据库物理设计和物理设计<br>这个方向上在大公司（金融，保险，研究，软件开发商等）有专门职位，<br>在中小公司则可能由程序员承担。</p>
</blockquote>
<p>商业智能专家 (business intelligence - BI)</p>
<blockquote>
<p>主要从商业应用，最终用户的角度去从数据中获得有用的信息，<br>涉及OLAP (online analytical processing)<br>需要使用SSRS, cognos, crystal report等报表工具，或者其他一些数据挖掘，统计方面的软件工具</p>
</blockquote>
<p>ETL开发 (ETL Developer)</p>
<blockquote>
<p>使用ETL工具或者自己编写程序在不同的数据源之间对数据进行导入，导出，转换，<br>所接触的数据库一般数据量非常大，要求进行的数据转换也比较复杂。<br>和数据仓库和商业智能的关系比较密切。</p>
</blockquote>
<blockquote>
<p>在一些数据库应用规模很大的公司里面有专门的职位，<br>中小公司里面则可能由程序员或者DBA负责这方面的工作。</p>
</blockquote>
<p>数据构架师 (Data Architect)</p>
<blockquote>
<p>主要从全局上制定和控制关于数据库在逻辑这一层的大方向，<br>也包括数据可用性，扩展性等长期性战略，<br>协调数据库的应用开发，建模，DBA之间的工作。<br>这个方向上在大公司（金融，保险，研究，软件开发商等）有专门职位，<br>在中小公司或者没有这个职位，或者由开发人员，DBA负责。</p>
</blockquote>
<p><strong>后面五种</strong>：重点是运营和维护，侧重与硬件和数据物理层面。</p>
<p>数据库管理员 (database administrator - DBA)</p>
<blockquote>
<p>数据库的安装，配置，调优，备份/恢复，监控，自动化等，<br>协助应用开发（有些职位还要求优化SQL，写存储过程和函数等）<br>这个方向上的职位相对少一些，但一般有点规模的公司还是会有这样的职位</p>
</blockquote>
<p>数据仓库专家 (data warehouse - DW)</p>
<blockquote>
<p>应付超大规模的数据，历史数据的存储，管理和使用，<br>和商业智能关系密切，很多时候BI和DW是放在一个大类里面的，<br>但是我觉得DW更侧重于硬件和物理层上的管理和优化。</p>
</blockquote>
<p>存储工程师 (storage engineer)</p>
<blockquote>
<p>专门负责提供数据存储方案，使用各种存储技术满足数据访问和存储需求，<br>和DBA的工作关系比较密切。<br>对高可用性有严格要求（比如通信，金融，数据中心等）的公司通常有这种职位，<br>这种职位也非常少。</p>
</blockquote>
<p>性能优化工程师 (performance engineer)</p>
<blockquote>
<p>专长数据库的性能调试和优化，为用户提供解决性能瓶颈方面的问题。<br>我知道至少IBM, 微软和Oracle都有专门的数据库性能实验室(database performance lab）,<br>也有专门的性能优化工程师，负责为其数据库产品和关键应用提供这方面的技术支持。<br>对数据库性能有严格要求的公司（比如金融行业）可能会有这种职位。<br>因为针对性很强，甚至要求对多种数据库非常熟悉，所以职位极少。</p>
</blockquote>
<p>高级数据库管理员 (senior DBA)</p>
<blockquote>
<p>在DBA的基础上，还涉及上面3种职位的部分工作，具体包括下面这些：<br>对应用系统的数据（布局，访问模式，增长模式，存储要求等）比较熟悉。<br>对性能优化非常熟悉，可以发现并优化从SQL到硬件I/O，网络等各个层面上的瓶颈<br>对于存储技术相对熟悉，可能代替存储工程师的一些工作，<br>对数据库的高可用性技术非常熟悉（比如MSSQL的集群，ORACLE RAC/FailSafe, IBM的DPF, HADR等）<br>对大规模数据库有效进行物理扩展（比如表分区）或者逻辑扩展（比如数据库分区，联合数据库等）<br>熟悉各种数据复制技术，比如单向，双向，点对点复制技术，以满足应用要求。<br>灾难数据恢复过程的建立，测试和执行<br>这种职位一般只在对数据库要求非常高并且规模非常大（比如金融，电信，数据中心等）的公司需要，<br>而且这种公司一般有一个专门独立负责数据库的部门或组。 </p>
</blockquote>
<h1 id="关系型数据库"><a href="#关系型数据库" class="headerlink" title="关系型数据库"></a>关系型数据库</h1><p>说到关系型数据库，不仅仅是涉及计算机概念，也涉及一些数学概念，例如表格的概念、包含关系、关系运算及关系代数等。</p>
<h2 id="关系模型术语"><a href="#关系模型术语" class="headerlink" title="关系模型术语"></a>关系模型术语</h2><img src="https://pic.islet.space/2021/05/image-20210512085059008.png" alt="image-20210512085059008" style="zoom:67%;" />

<ol>
<li><strong>表</strong>：关系型数据库由表集合而成，<strong>表是关系型数据库的一个基本组成</strong>，每个表具有唯一的名字。</li>
<li><strong>关系</strong>：在关系型数据库中，<strong>关系</strong> 指代 <strong>表</strong> 的概念，即一般可认为 <strong>关系 = 表</strong>。</li>
<li><strong>元组</strong>：在关系型数据库中，<strong>元组</strong> 指代 <strong>行</strong> 的概念，即一般可认为 <strong>元组 = 行</strong>。</li>
<li><strong>属性</strong>：在关系型数据库中，<strong>属性</strong> 指代 <strong>列</strong> 的概念，即一般可认为 <strong>属性 = 列</strong>。</li>
<li><strong>域</strong>：属性下所有元素的可取值范围或取值类型。</li>
<li><strong>原子域</strong>：域中的元素不可再分，则称为原子域。</li>
<li><strong>空值</strong>：属性下元素为空(NULL)。</li>
<li><strong>关系实例</strong>：即表实例，严谨说法是 “表示一个关系的特定实例，也就是所包含的一组特定的行”，就是不仅仅只有属性这一行，还具有特定的某些具体数据的表格。</li>
<li><strong>关系模式</strong>：即表模式，严谨说法是“关系模式由属性序列及各属性对应域组成”，通俗地说就是，没有具体数据，而仅定义了属性和域的表格。</li>
<li><strong>数据库模式</strong>：对数据库的逻辑设计。</li>
<li><strong>数据库实例</strong>：对数据库中数据的快照。</li>
<li><strong>超码</strong>：是一个或多个属性的集合，超码内的一个或多个属性组合可以唯一区分和标识一个元组。</li>
<li><strong>候选码</strong>：最小超码。</li>
<li><strong>主码</strong>：主码是候选码的一种，最重要的是，<strong>主码由设计者选中，具有人为性</strong>。</li>
<li><strong>外码</strong>：用于表示关系之间的引用和被引用关系。即关系A中的某项属性来自于关系B中的某项属性，则称该引用过来的属性为外码。<strong>但据课本，是被引用的主码称为外码。</strong></li>
<li><img src="https://pic.islet.space/2021/05/image-20210512134116409.png" alt="image-20210512134116409"></li>
</ol>
<h2 id="结构化查询语言SQL"><a href="#结构化查询语言SQL" class="headerlink" title="结构化查询语言SQL"></a>结构化查询语言SQL</h2><h3 id="发展历史"><a href="#发展历史" class="headerlink" title="发展历史"></a>发展历史</h3><img src="https://pic.islet.space/2021/05/image-20210512192241572.png" alt="image-20210512192241572" style="zoom:67%;" />



<blockquote>
<p><a target="_blank" rel="noopener" href="https://developer.aliyun.com/article/745815#:~:text=SQL%E6%A0%87%E5%87%86%E6%98%AF%E7%94%B1%E5%9B%BD%E9%99%85%E6%A0%87%E5%87%86%E5%8C%96%E7%BB%84%E7%BB%87%EF%BC%88ISO%EF%BC%89%E3%80%81%E7%BE%8E%E5%9B%BD%E5%9B%BD%E5%AE%B6%E6%A0%87%E5%87%86%E5%A7%94%E5%91%98%E4%BC%9AANSI%E7%AD%89%E5%88%B6%E5%AE%9A%E7%9A%84%EF%BC%8C%E5%AF%B9%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%BB%9F%E4%B8%80%E6%93%8D%E4%BD%9C%E6%96%B9%E5%BC%8F%E3%80%82%20SQL%20%E6%98%AF%20Structured%20Query%20Language%20%E7%9A%84%E7%BC%A9%E5%86%99%EF%BC%8C%E8%A7%84%E8%8C%83%E7%9A%84%E5%8F%91%E9%9F%B3%E6%98%AF%20%E2%80%9C%CB%8C%C9%9Bs%CB%8Ckju%CB%90%CB%88%C9%9Bl%E2%80%9D%E3%80%82,%E6%98%AF%20SQL%20Query%20Language%20%E7%9A%84%E7%BC%A9%E5%86%99%E3%80%82%20IBM%E5%AF%B9%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BB%A5%E5%8F%8ASQL%E8%AF%AD%E8%A8%80%E7%9A%84%E5%BD%A2%E6%88%90%E5%92%8C%E8%A7%84%E8%8C%83%E5%8C%96%E4%BA%A7%E7%94%9F%E4%BA%86%E9%87%8D%E5%A4%A7%E7%9A%84%E5%BD%B1%E5%93%8D%EF%BC%8C%E7%AC%AC%E4%B8%80%E4%B8%AA%E7%89%88%E6%9C%AC%E7%9A%84SQL%E6%A0%87%E5%87%86SQL86%E5%B0%B1%E6%98%AF%E5%9F%BA%E4%BA%8ESystem%20R%E7%9A%84%E6%89%8B%E5%86%8C%E8%80%8C%E6%9D%A5%E7%9A%84%E3%80%82%20Oracle%E5%9C%A81979%E5%B9%B4%E7%8E%87%E5%85%88%E6%8E%A8%E5%87%BA%E4%BA%86%E6%94%AF%E6%8C%81SQL%E7%9A%84%E5%95%86%E7%94%A8%E4%BA%A7%E5%93%81%E3%80%82">数据库必知词汇：SQL标准</a></p>
<p>SQL标准是由国际标准化组织（ISO）、美国国家标准委员会ANSI等制定的，对数据库管理系统的统一操作方式。</p>
<p>SQL 是  Structured Query Language 的缩写，规范的发音是 “ˌɛsˌkjuːˈɛl”。但是它的前身是著名的关系数据库原型系统  System R 所采用的 SEQUEL 语言，这也是为什么有很多人将其读作 “ˈsiːkwəl” 的来源。也有人类比 GNU  这个词的定义（GNU’s Not UNIX），认为 SQL 是 SQL Query Language 的缩写。</p>
<p>IBM对关系数据库以及SQL语言的形成和规范化产生了重大的影响，第一个版本的SQL标准SQL86就是基于System  R的手册而来的。Oracle在1979年率先推出了支持SQL的商用产品。随着数据库技术和应用的发展，为不同RDBMS提供一致的语言成了一种现实需要。</p>
<p>对SQL标准影响最大的机构自然是那些著名的数据库产商，而具体的制订者则是一些非营利机构，例如国际标准化组织ISO、美国国家标准委员会ANSI等。各国通常会按照ISO标准和ANSI标准制定自己的国家标准。</p>
<p>“美国国家标准化组织(ANSI)”是一个核准多种行业标准的组织。SQL作为关系型数据库所使用的标准语言，最初是基于IBM的实现在1986年被批准的。1987年，“国际标准化组织(ISO)”把ANSI SQL作为国际标准。</p>
<p>SQL发展的简要历史：<br>1986年，ANSI X3.135-1986，ISO/IEC 9075:1986，SQL-86<br>1989年，ANSI X3.135-1989，ISO/IEC 9075:1989，SQL-89<br>1992年，ANSI X3.135-1992，ISO/IEC 9075:1992，SQL-92（SQL2）<br>1999年，ISO/IEC 9075:1999，SQL:1999（SQL3）<br>2003年，ISO/IEC 9075:2003，SQL:2003<br>2008年，ISO/IEC 9075:2008，SQL:2008<br>2011年，ISO/IEC 9075:2011，SQL:2011<br>补充<br>1986 年，ANSI X3.135-1986，ISO/IEC 9075:1986，SQL-86。这是 ANSI 首次将 SQL 语言标准化的版本。<br>1989 年，ANSI X3.135-1989，ISO/IEC 9075:1989，SQL-89。增加了完整性约束。<br>1992 年，ANSI X3.135-1992，ISO/IEC 9075:1992，SQL-92（SQL2）。最重要的一个版本。 引入了标准的分级概念。<br>1999 年，ISO/IEC 9075:1999，SQL:1999（SQL3）。变动最大的一个版本。改变了标准符合程度的定义；增加了面向对象特性、正则表达式、存储过程、Java 等支持。<br>2003 年，ISO/IEC 9075:2003，SQL:2003。引入了 XML、Window 函数等。<br>2008 年，ISO/IEC 9075:2008，SQL:2008。引入了 TRUNCATE 等。<br>2011 年，ISO/IEC 9075:2011，SQL:2011。引入了时序数据等。<br>2016 年，ISO/IEC 9075:2016，SQL:2016。引入了 JSON 等。</p>
<p>绝大多数人提起SQL标准，涉及的内容其实是SQL92里头最基本或者说最核心的一部分。SQL92本身是分级的，包括入门级、过度级、中间级和完全级，推荐泛读SQL92，增量式式阅读其他标准。而随着SQL标准的发展，其包含的内容实在太多了，而且有很多特性对新的SQL产品而言也越来越不重要了。从SQL99之后，标准中符合程度的定义就不再分级，而是改成了核心兼容性和特性兼容性；也没有机构来推出权威的SQL标准符合程度的测试认证了。</p>
</blockquote>
<h3 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h3><ol>
<li>数据库查询</li>
<li>定义数据结构</li>
<li>修改数据</li>
<li>说明安全性约束条件</li>
</ol>
<h3 id="基本数据类型"><a href="#基本数据类型" class="headerlink" title="基本数据类型"></a>基本数据类型</h3><img src="https://pic.islet.space/2021/05/image-20210512192708528.png" alt="image-20210512192708528" style="zoom:67%;" />

<p><em><strong>以上所有类型都可能包含一个被称作空值的特殊值。NULL表示一个缺失的值，即表示该值可能存在但并不为人所知，或者可能根本不存在。</strong></em></p>
<h4 id="关于char-varchar-nvarchar的比较"><a href="#关于char-varchar-nvarchar的比较" class="headerlink" title="关于char / varchar / nvarchar的比较"></a>关于char / varchar / nvarchar的比较</h4><img src="https://pic.islet.space/2021/05/image-20210512193208247.png" alt="image-20210512193208247" style="zoom:67%;" />



<h3 id="SQL完整性约束"><a href="#SQL完整性约束" class="headerlink" title="SQL完整性约束"></a>SQL完整性约束</h3><img src="https://pic.islet.space/2021/05/image-20210512201050138.png" alt="image-20210512201050138" style="zoom:67%;" />

<p>例如，上方教员的名称为 “张三”， 我想删除后保存，会破坏 <code>instructor</code> 关系下 <code>name</code> 的非空约束，SQL不通过这种操作。</p>
<h3 id="数据库操作"><a href="#数据库操作" class="headerlink" title="数据库操作"></a>数据库操作</h3><h4 id="新建表格"><a href="#新建表格" class="headerlink" title="新建表格"></a>新建表格</h4><p>数据表格新建格式及样例如下：</p>
<p><img src="https://pic.islet.space/2021/05/image-20210512193506987.png" alt="image-20210512193506987"></p>
<blockquote>
<p>其中r是关系名，即表名；A<del>x</del>是属性名，即列名；D<del>x</del>是属性的域，即指定了A的类型及可选约束，用于限制所允许的A<del>x</del>取值的集合。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*部门关系*/</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> department(</span><br><span class="line">    dept_name <span class="type">varchar</span>(<span class="number">20</span>),</span><br><span class="line">    building <span class="type">varchar</span>(<span class="number">15</span>),</span><br><span class="line">    budget <span class="type">numeric</span>(<span class="number">12</span>,<span class="number">2</span>),</span><br><span class="line">    <span class="keyword">primary</span> key(dept_name)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*课程关系*/</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> course(</span><br><span class="line">    coourse_id <span class="type">varchar</span>(<span class="number">7</span>),</span><br><span class="line">    title <span class="type">varchar</span>(<span class="number">50</span>),</span><br><span class="line">    dept_name <span class="type">varchar</span>(<span class="number">20</span>),</span><br><span class="line">    credits <span class="type">numeric</span>(<span class="number">2</span>,<span class="number">0</span>),</span><br><span class="line">    <span class="keyword">primary</span> key(course_id),</span><br><span class="line">    <span class="keyword">foreign</span> key (dept_name) <span class="keyword">references</span> department</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*教员关系*/</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> instructor(</span><br><span class="line">	ID <span class="type">varchar</span>(<span class="number">5</span>),</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    dept_name <span class="type">varchar</span>(<span class="number">20</span>),</span><br><span class="line">    salary <span class="type">numeric</span>(<span class="number">8</span>,<span class="number">2</span>),</span><br><span class="line">    <span class="keyword">primary</span> key(ID),</span><br><span class="line">    <span class="keyword">foreign</span> key(dept_name) <span class="keyword">references</span> department</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*（课程）章节关系*/</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> section(</span><br><span class="line">	course_id <span class="type">varchar</span>(<span class="number">8</span>),</span><br><span class="line">    sec_id <span class="type">varchar</span>(<span class="number">8</span>),</span><br><span class="line">    semester <span class="type">varchar</span>(<span class="number">6</span>),</span><br><span class="line">    <span class="keyword">year</span> <span class="type">numeric</span>(<span class="number">4</span>,<span class="number">0</span>),</span><br><span class="line">    building <span class="type">varchar</span>(<span class="number">7</span>),</span><br><span class="line">    time_slot_id <span class="type">varchar</span>(<span class="number">4</span>),</span><br><span class="line">    <span class="keyword">primary</span> key(course_id, sec_id, semester, <span class="keyword">year</span>),</span><br><span class="line">    <span class="keyword">foreign</span> key(course_id) <span class="keyword">references</span> course</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*教师关系*/</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> teachers(</span><br><span class="line">	ID <span class="type">varchar</span>(<span class="number">5</span>),</span><br><span class="line">    course_id <span class="type">varchar</span>(<span class="number">8</span>),</span><br><span class="line">    sec_id <span class="type">varchar</span>(<span class="number">8</span>),</span><br><span class="line">    semester <span class="type">varchar</span>(<span class="number">6</span>),</span><br><span class="line">    <span class="keyword">year</span> <span class="type">numeric</span>(<span class="number">4</span>,<span class="number">0</span>),</span><br><span class="line">    <span class="keyword">primary</span> key(ID, course_id, sec_id, semester, <span class="keyword">year</span>),</span><br><span class="line">    <span class="keyword">foreign</span> key(course_id, sec_id, semester, <span class="keyword">year</span>) <span class="keyword">references</span> section,</span><br><span class="line">    <span class="keyword">foreign</span> key(ID) <span class="keyword">references</span> instructor</span><br><span class="line">);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<p>foreign key 可以拿来当 primary key，如章节关系中所示。</p>
<p><code>not null</code> 关键字约束表明 “在该属性上不允许空值” 。</p>
</blockquote>
<h4 id="插入"><a href="#插入" class="headerlink" title="插入"></a>插入</h4><p><img src="https://pic.islet.space/2021/05/image-20210512201338050.png" alt="image-20210512201338050"></p>
<p>插入值过程中，所给出的值的顺序应与关系模式中的属性顺序一致。</p>
<h4 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h4><p><code>delete</code> 命令可以用于删除元组。</p>
<ul>
<li>如果直接使用命令 <code>delete from student</code> ， 则将从 <em>student</em> 关系中删除所有元组。</li>
<li>使用其他语句可以执行特定删除，如：<ul>
<li>使用命令 <code>delete from instructor where salary between 13000 and 150000;</code> ，删除所有工资在13000到15000美元之间的教师</li>
<li>其他操作……</li>
</ul>
</li>
</ul>
<h4 id="丢弃表格"><a href="#丢弃表格" class="headerlink" title="丢弃表格"></a>丢弃表格</h4>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://islet.space/2021/05/11/Signal/2021-05-11-TRS%E7%AB%AF%E5%AD%90%E5%8F%8A%E5%85%B6%E4%BB%96%E9%9F%B3%E9%A2%91%E6%8E%A5%E5%8F%A3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liewzheng">
      <meta itemprop="description" content="笔记分享的旮旯孤岛而已">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder的孤岛">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/05/11/Signal/2021-05-11-TRS%E7%AB%AF%E5%AD%90%E5%8F%8A%E5%85%B6%E4%BB%96%E9%9F%B3%E9%A2%91%E6%8E%A5%E5%8F%A3/" class="post-title-link" itemprop="url">TRS端子及其他音频接口</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-05-11 16:00:00" itemprop="dateCreated datePublished" datetime="2021-05-11T16:00:00+08:00">2021-05-11</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-05-14 19:47:43" itemprop="dateModified" datetime="2021-05-14T19:47:43+08:00">2021-05-14</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Signal/" itemprop="url" rel="index"><span itemprop="name">Signal</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>接口其实包括对 “<strong>接口</strong>” （interface）和 “<strong>连接器</strong>” （connector）这两个方面的讨论，“连接器”我们通常也称之为“接头”或“插头”。 “接口”定义了电子设备之间连接的物理特性，包括传输的<strong>信号频率</strong>、<strong>强度</strong>，以及相应<strong>连线的类型</strong>、<strong>数量</strong>，还包括<strong>插头</strong>、<strong>插座</strong>的结构设计；而“连接器”则是在物理上实现设备之间连接的装置。</p>
<h1 id="TRS"><a href="#TRS" class="headerlink" title="TRS"></a>TRS</h1><p>TRS端子（TRS connector）是一种常用于连接音响设备，用以传递音频信号的连接器。该词是其三个组成部件的首字母缩写：<strong>Tip</strong>（尖）、<strong>Ring</strong>（环）、<strong>Sleeve</strong>（套）。</p>
<p>由于该种接头一般用于接插耳机和麦克风，因此也称 Phone Jack。虽然统称TRS，但也可依据具体的插头/插座的<strong>环（R）数</strong> 不同而分别称为<strong>TS</strong>（无环，即尖和套各提供一个接触点）、<strong>TRS</strong>（一环，三个接触点）、<strong>TRRS</strong>（两环，四个接触点）等等。</p>
<p>日常生活中我们见得最多的就是<strong>TRS</strong>接口，它的接头外观是圆柱体形状，通常有三种尺寸**1/4”<strong>（6.3mm）、</strong>1/8”<strong>（3.5mm）、</strong>3/32”**（2.5mm），最常见的是3.5mm尺寸的接头。</p>
<img src="https://pic.islet.space/2021/05/72f082025aafa40fc0dca129a764034f78f0192f" alt="img" style="zoom:50%;" />

<p><strong>TRS</strong> 的含义是Tip（signal）、Ring（signal）、Sleeve（ground），分别代表了这种接头的3个触点，我们看到的就是被两段绝缘材料隔离开的三段金属柱。因此，3.5mm接头和6.3mm接头也被人称为“小三芯”和“大三芯”。</p>
<img src="https://pic.islet.space/2021/05/Cg-4WlUQA2qIVD1QAAEWTBx9jskAAAGGAKz658AARZk513.jpg" alt=" " style="zoom: 150%;" />



<p>TRS接口就是一个圆孔，其内部与接头对应，也有三个触点，彼此之间也被绝缘材料隔开。</p>
<h2 id="常见设备"><a href="#常见设备" class="headerlink" title="常见设备"></a>常见设备</h2><p>通常，手机上的耳机插口都是TRRS，而电脑上通常是两个TRS，一个传声音的左右声道，一个传话筒的左右声道。</p>
<p>而为了使得双TRS的耳麦可以插到手机上，产生了转接头，也就是图中的第二个设备。不过我们考虑一下会发现，两个TRS都是3个信号，合并到一个TRRS接口上，信号变成了4个，减少了两个。除去一个共地的GND，还少了一个信号，去哪了呢？其实这是因为它会把LMIC和RMIC合并成一个MIC，而且TRRS本身就是只能传输一个MIC信号的，不存在左右声道。</p>
<p>当然了，也有反过来将TRRS转接成两个TRS接口的转接头。</p>
<p>此外，还有TS麦克风，如图中的第四个设备。如果话筒采用的这种接口，就默认了MIC只有一个声道，这种一般是用在小蜜蜂扩音器上。</p>
<p><img src="https://pic.islet.space/2021/05/41_2.jpg" alt="img"></p>
<p>当然，既然能加芯，那也可以减芯。二芯的TRS接头可以用来传送非平衡的单声道音频信号，比如电吉他用的线就是二芯的TRS线。所以，单从TRS接口外观来看，我们不会知道它是否支持平衡传输；单从芯数来看，我们也不能确定四芯及以上的TRS接头是否支持平衡传输，具体情况需要看设备。</p>
<p>尖和套是一定要有的，但环可以根据需要加，常见的有0-2个环的，也就是TS、TRS和TRRS。环越多，可以传输的信号数量越多。</p>
<p>因此，普通双声道耳机需要3个信号，即TRS；而如果是带麦克风的耳机，就需要4个信号了，即TRRS。注意，这里除了左声道(L)、右声道(R)以及带麦耳机所需的麦克风(MIC)信号，必须还要有地线(GND)，因为没有绝对电压而只有相对电压。</p>
<p>在3.5mm接口上传输的是模拟信号，使用电压模拟声波。</p>
<p>此外，还有一种用于耳机的四芯3.5mm插头则是用来传输平衡信号的。6.3mm的“大三芯”插头可用来传输平衡信号或非平衡立体声信号，也就是说它可以和XLR平衡接口一样，能够传输平衡信号，但因制作这样的平衡线成本比较高，所以一般只用在高档专业音频设备上。</p>
<img src="https://article-fd.zol-img.com.cn/t_s640x2000/g2/M00/01/08/Cg-4WlUQBM2IO7yBAAPH1zKABagAAAGHwBFP9AAA8fv952.jpg" alt="拒绝做小白 你应该知道的常见音频接口 " style="zoom:67%;" />

<div style="text-align: center; font-weight: 900;">二芯6.3mm TRS电吉他线</div>





<h2 id="TRS母头"><a href="#TRS母头" class="headerlink" title="TRS母头"></a>TRS母头</h2><p>ADI公司旗下的 ADAU1772 评估板采用的就是CUI公司旗下型号为 SJ-3523-SMT-TR 的TRS母头</p>
<p><img src="https://pic.islet.space/2021/05/2021-05-11_16-39.png"></p>
<p>说明书如：<a target="_blank" rel="noopener" href="https://www.cuidevices.com/product/resource/digikeypdf/sj-352x-smt.pdf">sj-352x-smt.pdf</a> ，其规格如下：</p>
<p><img src="https://pic.islet.space/2021/05/image-20210511164353982.png" alt="image-20210511164353982"></p>
<h1 id="RCA"><a href="#RCA" class="headerlink" title="RCA"></a>RCA</h1><p> RCA接口在我们日常生活中也非常常见，音箱、电视、功放、DVD机等设备上基本都有。它得名于美国无线电公司的英文缩写（Radio Corporation of America），上世纪40年代的时候，该公司将这种接口引入市场，用它来连接留声机和扬声器，也因此，它在欧州又称为PHONO接口。我们对它更熟悉的接头称呼则是“莲花头”。</p>
<img src="https://article-fd.zol-img.com.cn/t_s640x2000/g2/M00/01/08/Cg-4WlUQCFeITgCFAAaVRivfdawAAAGKwBI8wMABpVe851.jpg" alt="拒绝做小白 你应该知道的常见音频接口 " style="zoom:67%;" />

<div style="text-align: center; font-weight: 900;">RCA接口在我们日常生活中非常常见</div>

<img src="https://article-fd.zol-img.com.cn/t_s640x2000/g2/M00/01/08/Cg-4WVUQCFyIRm-6AAMW5z_mkQ8AAAGKwB5ZmQAAxb_659.jpg" alt="拒绝做小白 你应该知道的常见音频接口 " style="zoom:67%;" />

<div style="text-align: center; font-weight: 900;">被称为“莲花头”的RCA接头</div>



<p>RCA接口采用同轴传输信号的方式，中轴用来传输信号，外沿一圈的接触层用来接地。每一根RCA线缆负责传输一个声道的音频信号，因此，可以根据对声道的实际需要，使用与之数量相匹配的RCA线缆。比如要组双声道立体声就需要两根RCA线缆。</p>
<h1 id="XLR"><a href="#XLR" class="headerlink" title="XLR"></a>XLR</h1><p>XLR接口又被称为“卡农口”，这是因为James H. Cannon创立的Cannon Electric公司是它最初的生产商。它们最早的产品是“cannon X”系列，后来改进产品增加了一个锁定装置（Latch），于是在“X”后面增加了一个“L”；再后来又围绕着接头的金属触点增加了橡胶封口（Rubber compound），于是又在“L”后面增加了一个“R”。人们就把三个大写字母组合在一起，称这种接头为“XLR connector”。</p>
<p><img src="https://article-fd.zol-img.com.cn/t_s640x2000/g2/M00/01/08/Cg-4WVUQChyIbKeoAALaNHpTfMUAAAGMAMweHgAAtpM096.jpg"></p>
<div style="text-align: center; font-weight: 900;">比较常见的三芯XLR接口</div>

<p><img src="https://article-fd.zol-img.com.cn/t_s640x2000/g2/M00/01/08/Cg-4WlUQDLCIUqT0AAHcPS_ygasAAAGOQEvIJQAAdxV227.jpg" alt=" "></p>
<div style="text-align: center; font-weight: 900;">有的耳放上面会提供四芯平衡XLR接口</div>

<p>我们通常见到的XLR插头是3脚的，当然也有2脚、4脚、5脚、6脚的，比如在一些高档耳机线上，我们也会看到四芯XLR平衡接头。XLR接口与“大三芯”TRS接口一样，可以用来传输音频平衡信号。这里我们简单说一下平衡信号与非平衡信号。声波转换成电信号后，如果直接传送就是非平衡信号，如果把原始信号反相180度，然后同时传送原始信号和反相信号，这就是平衡信号。平衡传输就是利用相位抵消原理，将音频信号传输过程中受到的其他干扰降至最低。 当然，XLR接口也跟“大三芯”TRS接口一样，可以传输非平衡信号，因此光从接口看，我们是看不出来它到底传输的是哪种信号。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>
<script src="/js/comments.js"></script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">粤ICP备19004822号 </a>
  </div>

<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Liewzheng</span>
</div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  






  





</body>
</html>
