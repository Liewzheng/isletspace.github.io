<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://code.islet.space/font//css?family=/CascadiaCode/CascadiaCode:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"islet.space","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.7.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/db.json","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":true}}</script><script src="/js/config.js"></script>
<meta name="description" content="笔记分享的旮旯孤岛而已">
<meta property="og:type" content="website">
<meta property="og:title" content="Coder的孤岛">
<meta property="og:url" content="http://islet.space/page/2/index.html">
<meta property="og:site_name" content="Coder的孤岛">
<meta property="og:description" content="笔记分享的旮旯孤岛而已">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Liewzheng">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://islet.space/page/2/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/2/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Coder的孤岛</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Coder的孤岛</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">islet of the coder</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-首页"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-文章"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>文章</a></li>
        <li class="menu-item menu-item-目录"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>目录</a></li>
        <li class="menu-item menu-item-标签"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-简历"><a href="/resume/" rel="section"><i class="fa fa-address-card fa-fw"></i>简历</a></li>
        <li class="menu-item menu-item-友链"><a href="/friends/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>友链</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Liewzheng</p>
  <div class="site-description" itemprop="description">笔记分享的旮旯孤岛而已</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">125</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">13</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">230</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="mailto:liewzheng@foxmail.com" title="E-Mail → mailto:liewzheng@foxmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i></a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://islet.space/2022/05/25/Programming/Compiling/2022-05-25-armcc%E7%9A%84%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91%E5%92%8C%E6%8C%81%E7%BB%AD%E4%BA%A4%E4%BB%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liewzheng">
      <meta itemprop="description" content="笔记分享的旮旯孤岛而已">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder的孤岛">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/25/Programming/Compiling/2022-05-25-armcc%E7%9A%84%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91%E5%92%8C%E6%8C%81%E7%BB%AD%E4%BA%A4%E4%BB%98/" class="post-title-link" itemprop="url">armcc的交叉编译和持续交付</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">

    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-05-25 16:00:00" itemprop="dateCreated datePublished" datetime="2022-05-25T16:00:00+08:00">2022-05-25</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2022-06-09 21:53:25" itemprop="dateModified" datetime="2022-06-09T21:53:25+08:00">2022-06-09</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Programming/" itemprop="url" rel="index"><span itemprop="name">Programming</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>因为基本上没什么人直接使用 armcc
作为自动化编译、持续集成和交付的工具，更多是使用 UV4 软件读取
<code>.uvprojx</code> 文件来获取编译信息，进而驱动 armcc
进行编译过程。</p>
<p>通过自行编辑 <code>Makefile</code> 文件，使用 make 和 armcc
工具可以对代码文件进行编译，可以进行静态库的生成，也可以生成可烧录文件，但是就不要想着复杂的
<code>make test</code> 等测试功能了。</p>
<h1 id="diff-between-them">DIFF BETWEEN THEM</h1>
<p>下方详细描述一下使用 <code>arm-none-eabi-gcc</code>
、<code>make</code> 、<code>cmake</code> 与 <code>armcc</code>
、<code>make</code> 的不同。</p>
<ol type="1">
<li>使用 <code>arm-none-eabi-gcc</code> 和 <code>make</code> 编译的 SDK
过程属于 Unix Makefile 编译过程（详见 CMake 工具及官网对 <a
target="_blank" rel="noopener" href="https://cmake.org/cmake/help/latest/manual/cmake-generators.7.html">CMakefiles
Generators</a> 说明）。暂时不清楚使用 <code>armcc</code> 和
<code>cmake</code> 是如何生成 <code>Makefile</code>
的，因为尚不了解toolchain的绑定过程，导致一致检测到的是
windows平台本地的 <code>mingw</code> 工具。</li>
<li>启动文件不同。详见 <a href="##ABOUT%20STARTUP%20FILE">ABOUT STARTUP
FILE</a></li>
<li>工具链指定方式不同。详见 <a href="##TOOLCHAIN">TOOLCHAIN</a></li>
</ol>
<h1 id="keil-mdk-env">KEIL MDK ENV</h1>
<h2 id="mdk-softpack">MDK SOFTPACK</h2>
<p><a target="_blank" rel="noopener" href="https://www.keil.com/dd2/pack/">MDK5 Software Packs</a></p>
<h2 id="toolchain-downloads">TOOLCHAIN DOWNLOADS</h2>
<p>首先需要安装版本较新的 Keil MDK-ARM
开发软件。最好是在Windows上安装，方便破解。</p>
<p>可以从 <code>About uVision</code> 中查看版本信息。也可以直接在
PowerShell 中直接调用查看。</p>
<p>MDK 的版本为 <code>v5.22</code> 确实是比较老旧的，建议下载
<code>v5.27</code> 及以上版本。</p>
<p>下载链接：<a
target="_blank" rel="noopener" href="https://storage.islet.space/02_Softwares/06_Embedded/01_CrossCompiler/keil_mdk_armcc/MDK528.exe">MDKv5.28</a>、<a
target="_blank" rel="noopener" href="https://storage.islet.space/02_Softwares/06_Embedded/01_CrossCompiler/keil_mdk_armcc/MDK537.exe">MDKv5.37</a>、<a
target="_blank" rel="noopener" href="https://storage.islet.space/02_Softwares/06_Embedded/01_CrossCompiler/keil_mdk_armcc/keygen.exe">keygen</a></p>
<p>官网下载：<a
target="_blank" rel="noopener" href="https://developer.arm.com/tools-and-software/embedded/arm-compiler/arm-compiler-5/downloads">ARM
Compiler 5 Downloads</a></p>
<figure>
<img src="https://pic.islet.space/2022/06/image-20220608100300944.png"
alt="image-20220608100300944" />
<figcaption aria-hidden="true">image-20220608100300944</figcaption>
</figure>
<figure>
<img src="https://pic.islet.space/2022/06/image-20220608100748964.png"
alt="image-20220608100748964" />
<figcaption aria-hidden="true">image-20220608100748964</figcaption>
</figure>
<h1 id="toolchain">TOOLCHAIN</h1>
<p>下面的一些参数可以从 <a
target="_blank" rel="noopener" href="https://developer.arm.com/documentation/dui0375/g/Compiler-Command-line-Options/">ARM
Compiler v5.06 for uVision armcc User Guide</a> 获取帮助。</p>
<h2 id="fromelf">FROMELF</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">Options:</span><br><span class="line">       --<span class="built_in">help</span>         display this <span class="built_in">help</span> screen</span><br><span class="line">       --vsn          display version information</span><br><span class="line">       --output file  the output file. (defaults to stdout <span class="keyword">for</span> -text format)</span><br><span class="line">       --nodebug      <span class="keyword">do</span> not put debug areas <span class="keyword">in</span> the output image</span><br><span class="line">       --nolinkview   <span class="keyword">do</span> not put sections <span class="keyword">in</span> the output image</span><br><span class="line"></span><br><span class="line">Binary Output Formats:</span><br><span class="line">       --bin          Plain Binary</span><br><span class="line">       --m32          Motorola 32 bit Hex</span><br><span class="line">       --i32          Intel 32 bit Hex</span><br><span class="line">       --vhx          Byte Oriented Hex format</span><br><span class="line"></span><br><span class="line">       --base addr    Optionally <span class="built_in">set</span> base address <span class="keyword">for</span> m32,i32</span><br><span class="line"></span><br><span class="line">Output Formats Requiring Debug Information</span><br><span class="line">       --fieldoffsets Assembly Language Description of Structures/Classes</span><br><span class="line">       --expandarrays Arrays inside and outside structures are expanded</span><br><span class="line"></span><br><span class="line">Other Output Formats:</span><br><span class="line">       --elf         ELF</span><br><span class="line">       --text        Text Information</span><br><span class="line"></span><br><span class="line">                Flags <span class="keyword">for</span> Text Information</span><br><span class="line">                -v          verbose</span><br><span class="line">                -a          <span class="built_in">print</span> data addresses (For images built with debug)</span><br><span class="line">                -c          disassemble code</span><br><span class="line">                -d          <span class="built_in">print</span> contents of data section</span><br><span class="line">                -e          <span class="built_in">print</span> exception tables</span><br><span class="line">                -g          <span class="built_in">print</span> debug tables</span><br><span class="line">                -r          <span class="built_in">print</span> relocation information</span><br><span class="line">                -s          <span class="built_in">print</span> symbol table</span><br><span class="line">                -t          <span class="built_in">print</span> string table</span><br><span class="line">                -y          <span class="built_in">print</span> dynamic segment contents</span><br><span class="line">                -z          <span class="built_in">print</span> code and data size information</span><br></pre></td></tr></table></figure>
<h2 id="armlink">ARMLINK</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">Usage: armlink option-list input-file-list</span><br><span class="line"><span class="built_in">where</span></span><br><span class="line">    option-list      is a list of case-insensitive options.</span><br><span class="line">    input-file-list  is a list of input object and library files.</span><br><span class="line"></span><br><span class="line">General options (abbreviations shown capitalised):</span><br><span class="line">   --<span class="built_in">help</span>          Print this summary.</span><br><span class="line">   --output file   Specify the name of the output file.</span><br><span class="line">   --via file      Read further arguments from file.</span><br><span class="line"></span><br><span class="line">Options <span class="keyword">for</span> specifying memory map information:</span><br><span class="line">   --partial       Generate a partially linked object.</span><br><span class="line">   --scatter file  Create the memory map as described <span class="keyword">in</span> file.</span><br><span class="line">   --ro-base n     Set <span class="built_in">exec</span> addr of region containing RO sections.</span><br><span class="line">   --rw-base n     Set <span class="built_in">exec</span> addr of region containing RW/ZI sections.</span><br><span class="line"></span><br><span class="line">Options <span class="keyword">for</span> controlling image contents:</span><br><span class="line">   --bestdebug     Add debug information giving best debug view to image.</span><br><span class="line">   --datacompressor off</span><br><span class="line">                   Do not compress RW data sections.</span><br><span class="line">   --no_debug      Do not add debug information to image.</span><br><span class="line">   --entry         Specify entry sections and entry point.</span><br><span class="line">   --libpath       Specify path to find system libraries from.</span><br><span class="line">   --userlibpath   Specify path to find user libraries from.</span><br><span class="line">   --no_locals     Do not add <span class="built_in">local</span> symbols to image symbol table.</span><br><span class="line">   --no_remove     Do not remove unused sections from image.</span><br><span class="line"></span><br><span class="line">Options <span class="keyword">for</span> controlling image related information:</span><br><span class="line">   --callgraph     Create a static callgraph of <span class="built_in">functions</span>.</span><br><span class="line">   --feedback file Generate feedback that can be used by the compiler <span class="keyword">in</span> file.</span><br><span class="line">   --info topic    List misc. information about image.</span><br><span class="line">                    Available topics: (separate multiple topics with comma)</span><br><span class="line">                     common   List common sections eliminated from the image.</span><br><span class="line">                     debug    List eliminated input debug sections.</span><br><span class="line">                     sizes    List code and data sizes <span class="keyword">for</span> objects <span class="keyword">in</span> image.</span><br><span class="line">                     totals   List total sizes of all objects <span class="keyword">in</span> image.</span><br><span class="line">                     veneers  List veneers that have been generated.</span><br><span class="line">                     unused   List sections eliminated from the image.</span><br><span class="line">   --map           Display memory map of image.</span><br><span class="line">   --symbols       List symbols <span class="keyword">in</span> image.</span><br><span class="line">   --xref          List all cross-references between input sections.</span><br></pre></td></tr></table></figure>
<p><code>--summary_stderr</code></p>
<h2 id="armcc">ARMCC</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Usage:         armcc [options] file1 file2 ... filen</span><br><span class="line">Main options:</span><br><span class="line">        </span><br><span class="line">--arm          Generate ARM code</span><br><span class="line">--thumb        Generate Thumb code</span><br><span class="line">--c90          Switch to C mode (default <span class="keyword">for</span> .c files)</span><br><span class="line">--cpp          Switch to C++ mode (default <span class="keyword">for</span> .cpp files)</span><br><span class="line">-O0            Minimum optimization</span><br><span class="line">-O1            Restricted optimization <span class="keyword">for</span> debugging</span><br><span class="line">-O2            High optimization</span><br><span class="line">-O3            Maximum optimization</span><br><span class="line">-Ospace        Optimize <span class="keyword">for</span> codesize</span><br><span class="line">-Otime         Optimize <span class="keyword">for</span> maximum performance</span><br><span class="line">--cpu &lt;cpu&gt;    Select CPU to generate code <span class="keyword">for</span></span><br><span class="line">--cpu list     Output a list of all the selectable CPUs</span><br><span class="line">-o &lt;file&gt;      Name the final output file of the compilation</span><br><span class="line">-c             Compile only, <span class="keyword">do</span> not link</span><br><span class="line">--asm          Output assembly code as well as object code</span><br><span class="line">-S             Output assembly code instead of object code</span><br><span class="line">--interleave   Interleave <span class="built_in">source</span> with disassembly (use with --asm or -S)</span><br><span class="line">-E             Preprocess the C <span class="built_in">source</span> code only</span><br><span class="line">-D&lt;symbol&gt;     Define &lt;symbol&gt; on entry to the compiler</span><br><span class="line">-g             Generate tables <span class="keyword">for</span> high-level debugging</span><br><span class="line">-I&lt;directory&gt;  Include &lt;directory&gt; on the <span class="comment">#include search pat</span></span><br></pre></td></tr></table></figure>
<h1 id="makefile">MAKEFILE</h1>
<p>make 可以在任一路径下执行，只需要加入 <code>-C &lt;path&gt;</code>
即可，即告诉make工具在 <code>&lt;path&gt;</code>
路径下执行编译。方便了在 windows 命令行环境下的执行。</p>
<p>编写 Makefile
的时候，某些变量可以通过外部传递，而且方法也很简单，甚至内部甚至不需要声明，只需要在引用处写明变量名称即可。然后外部调用时以
<code>VARIABLE="value"</code> 的形式进行声明即可。如下：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make libmxs <span class="literal">-C</span> <span class="number">20220607</span> MANIFEST_PATH=<span class="string">&quot;F:\Workspace\20220511-galileo-manifest&quot;</span> TOOLCHAIN_PATH=<span class="string">&quot;D:\Keil_v528\ARM\ARMCC\bin&quot;</span></span><br></pre></td></tr></table></figure>
<h2 id="compiling-control-strings">COMPILING CONTROL STRINGS</h2>
<p>下面这些编译参数是复制自 KEIL IDE 的，对应的平台是 STM32L4R9。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">--c99</span><br><span class="line">-c </span><br><span class="line">--cpu Cortex-M4.fp</span><br><span class="line">-D__MICROLIB -g -O3 --apcs&#x3D;interwork --split_sections </span><br><span class="line"></span><br><span class="line">-I ..&#x2F;app </span><br><span class="line">-I ..&#x2F;M_BSP </span><br><span class="line">-I ..&#x2F;M_BSP&#x2F;BMM150 </span><br><span class="line">-I ..&#x2F;M_BSP&#x2F;Sensor_R1 </span><br><span class="line">-I ..&#x2F;M_BSP&#x2F;lps33k </span><br><span class="line">-I ..&#x2F;M_BSP&#x2F;lcd </span><br><span class="line">-I ..&#x2F;M_BSP&#x2F;PSRAM </span><br><span class="line">-I ..&#x2F;M_BSP&#x2F;OSPI_NOR </span><br><span class="line">-I ..&#x2F;Driver </span><br><span class="line">-I ..&#x2F;..&#x2F;..&#x2F;Drivers&#x2F;CMSIS&#x2F;Include </span><br><span class="line">-I ..&#x2F;..&#x2F;..&#x2F;Drivers&#x2F;CMSIS&#x2F;Device&#x2F;ST&#x2F;STM32L4xx&#x2F;Include </span><br><span class="line">-I ..&#x2F;..&#x2F;..&#x2F;Drivers&#x2F;STM32L4xx_HAL_Driver&#x2F;Inc </span><br><span class="line">-I ..&#x2F;..&#x2F;..&#x2F;Drivers&#x2F;BSP&#x2F;STM32L4R9I_EVAL </span><br><span class="line">-I ..&#x2F;..&#x2F;..&#x2F;Drivers&#x2F;BSP&#x2F;Components&#x2F;Common </span><br><span class="line"></span><br><span class="line">-I.&#x2F;RTE&#x2F;_Watch_EVAL</span><br><span class="line">-IC:&#x2F;Users&#x2F;mixo&#x2F;AppData&#x2F;Local&#x2F;Arm&#x2F;Packs&#x2F;ARM&#x2F;CMSIS&#x2F;5.5.1&#x2F;CMSIS&#x2F;Core&#x2F;Include</span><br><span class="line">-IDrivers&#x2F;CMSIS&#x2F;Device&#x2F;ST&#x2F;STM32L4xx&#x2F;Include</span><br><span class="line">-D__UVISION_VERSION&#x3D;&quot;528&quot; -D_RTE_ -DSTM32L4R9xx -DUSE_HAL_DRIVER -DUSE_GVO_390x390</span><br><span class="line">-o .\Watch\*.o --omf_browse .\Watch\*.crf --depend .\Watch\*.d</span><br></pre></td></tr></table></figure>
<h2 id="toolchain-1">TOOLCHAIN</h2>
<p>在 Makefile 文件中，往往为了互相兼容，默认编译器的名称就是
<code>gcc</code> ，只是前缀不同而已，而 <code>armcc</code>
编译器在使用时则需清晰指定名称。</p>
<p>下方为 <code>armcc</code> 工具链的指定方式：</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 工具链</span></span><br><span class="line">CC=<span class="variable">$(TOOLCHAIN_PATH)\&quot;</span>armcc.exe<span class="string">&quot;</span></span><br><span class="line"><span class="string">AS=<span class="variable">$(TOOLCHAIN_PATH)\&quot;</span>armasm.exe&quot;</span></span><br><span class="line">AR=<span class="variable">$(TOOLCHAIN_PATH)\&quot;</span>armar.exe<span class="string">&quot;</span></span><br><span class="line"><span class="string">LINK=<span class="variable">$(TOOLCHAIN_PATH)\&quot;</span>armlink.exe&quot;</span></span><br><span class="line">FROM_ELF=<span class="variable">$(TOOLCHAIN_PATH)\&quot;</span>fromelf.exe<span class="string">&quot;</span></span><br></pre></td></tr></table></figure>
<p>下方为 <code>arm-none-eabi-gcc</code> 工具链的指定（由 stm32 CubeMX
生成）。</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">PREFIX = arm-none-eabi-</span><br><span class="line"><span class="comment"># The gcc compiler bin path can be either defined in make command via GCC_PATH variable (&gt; make GCC_PATH=xxx)</span></span><br><span class="line"><span class="comment"># either it can be added to the PATH environment variable.</span></span><br><span class="line"><span class="keyword">ifdef</span> GCC_PATH</span><br><span class="line">CC = <span class="variable">$(GCC_PATH)</span>/<span class="variable">$(PREFIX)</span>gcc</span><br><span class="line">AS = <span class="variable">$(GCC_PATH)</span>/<span class="variable">$(PREFIX)</span>gcc -x assembler-with-cpp</span><br><span class="line">CP = <span class="variable">$(GCC_PATH)</span>/<span class="variable">$(PREFIX)</span>objcopy</span><br><span class="line">SZ = <span class="variable">$(GCC_PATH)</span>/<span class="variable">$(PREFIX)</span>size</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">CC = <span class="variable">$(PREFIX)</span>gcc</span><br><span class="line">AS = <span class="variable">$(PREFIX)</span>gcc -x assembler-with-cpp</span><br><span class="line">CP = <span class="variable">$(PREFIX)</span>objcopy</span><br><span class="line">SZ = <span class="variable">$(PREFIX)</span>size</span><br><span class="line"><span class="keyword">endif</span></span><br><span class="line">HEX = <span class="variable">$(CP)</span> -O ihex</span><br><span class="line">BIN = <span class="variable">$(CP)</span> -O binary -S</span><br></pre></td></tr></table></figure>
<h2 id="compiling-parameters">COMPILING PARAMETERS</h2>
<p>总结出常见的编译参数如下：</p>
<h3 id="macro-definitions">MACRO DEFINITIONS</h3>
<p>宏定义参数：<code>-DUSE_HAL_DRIVER</code> /
<code>-DSTM32L4R9xx</code> / <code>-D__MICROLIB</code> 。</p>
<p>其中，前两个还是要依具体芯片的硬件参数来看的</p>
<h3 id="cpu">CPU</h3>
<p>CPU 参数：<code>--cpu Cortex-M4.fp</code> /
<code>--cpu Cortex-M4</code> 等。</p>
<p>使用<code>armcc --cpu list</code>
命令可以查看所有可接受的芯片，如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">--cpu=<span class="number">4</span></span><br><span class="line">--cpu=<span class="number">4</span>T</span><br><span class="line">--cpu=<span class="number">5</span>T</span><br><span class="line">--cpu=<span class="number">5</span>TE</span><br><span class="line">--cpu=<span class="number">5</span>TEJ</span><br><span class="line">--cpu=<span class="number">6</span>-M</span><br><span class="line">--cpu=<span class="number">6</span>S-M</span><br><span class="line">--cpu=<span class="number">7</span>-A</span><br><span class="line">--cpu=<span class="number">7</span>-R</span><br><span class="line">--cpu=<span class="number">7</span>-M</span><br><span class="line">--cpu=<span class="number">7</span>E-M</span><br><span class="line">--cpu=<span class="number">7</span>-A.security</span><br><span class="line">--cpu=ARM7EJ-S</span><br><span class="line">--cpu=ARM7TDMI</span><br><span class="line">--cpu=ARM720T</span><br><span class="line">--cpu=ARM7TDMI-S</span><br><span class="line">--cpu=ARM9TDMI</span><br><span class="line">--cpu=ARM920T</span><br><span class="line">--cpu=ARM922T</span><br><span class="line">--cpu=ARM9E-S</span><br><span class="line">--cpu=ARM926EJ-S</span><br><span class="line">--cpu=ARM946E-S</span><br><span class="line">--cpu=ARM966E-S</span><br><span class="line">--cpu=Cortex-M0</span><br><span class="line">--cpu=Cortex-M0plus</span><br><span class="line">--cpu=SC000</span><br><span class="line">--cpu=Cortex-M1</span><br><span class="line">--cpu=Cortex-M1.os_extension</span><br><span class="line">--cpu=Cortex-M1.no_os_extension</span><br><span class="line">--cpu=Cortex-M3</span><br><span class="line">--cpu=Cortex-M3-rev0</span><br><span class="line">--cpu=SC300</span><br><span class="line">--cpu=Cortex-M4</span><br><span class="line">--cpu=Cortex-M4.fp.sp</span><br><span class="line">--cpu=Cortex-M7</span><br><span class="line">--cpu=Cortex-M7.fp.sp</span><br><span class="line">--cpu=Cortex-M7.fp.dp</span><br><span class="line">--cpu=Cortex-R4</span><br><span class="line">--cpu=Cortex-R4F</span><br><span class="line">--cpu=Cortex-A5</span><br><span class="line">--cpu=Cortex-A5.vfp</span><br><span class="line">--cpu=Cortex-A5.neon</span><br><span class="line">--cpu=Cortex-A7</span><br><span class="line">--cpu=Cortex-A7.no_neon</span><br><span class="line">--cpu=Cortex-A7.no_neon.no_vfp</span><br><span class="line">--cpu=Cortex-A8</span><br><span class="line">--cpu=Cortex-A8.no_neon</span><br><span class="line">--cpu=Cortex-A8NoNEON</span><br><span class="line">--cpu=Cortex-A9</span><br><span class="line">--cpu=Cortex-A9.no_neon</span><br><span class="line">--cpu=Cortex-A9.no_neon.no_vfp</span><br><span class="line">--cpu=Cortex-A12</span><br><span class="line">--cpu=Cortex-A12.no_neon.no_vfp</span><br><span class="line">--cpu=Cortex-A15</span><br><span class="line">--cpu=Cortex-A15.no_neon</span><br><span class="line">--cpu=Cortex-A15.no_neon.no_vfp</span><br><span class="line">--cpu=Cortex-A17</span><br><span class="line">--cpu=Cortex-A17.no_neon.no_vfp</span><br></pre></td></tr></table></figure>
<h2 id="about-startup-file">ABOUT STARTUP FILE</h2>
<p>CubeMX 针对不同的编译方式和平台生成对应的 <code>startup file</code>
。而使用 Unix Makefile 编译的 <code>startup_stm32l476xx.s</code> 和 使用
Keil MDK-ARM 的是不一样的。</p>
<p><code>startup_stm32xxxxxx.s</code>
是使用汇编语言写好的基本程序，当STM32
芯片上电启动的时候，会执行此处的汇编程序，从而建立 C
语言的运行环境，所以称之为启动文件。</p>
<p>由于编译器不一致，所以 <code>.s</code>
的启动文件也不能互相兼容，需要使用 CubeMX重新生成。</p>
<figure>
<img src="https://pic.islet.space/2022/06/image-20220609110616631.png"
alt="image-20220609110616631" />
<figcaption aria-hidden="true">image-20220609110616631</figcaption>
</figure>
<h1 id="debug">DEBUG</h1>
<h2 id="error">ERROR</h2>
<h3
id="error-35-please-select-first-the-target-stm32l4xx-device-used-in-your-application">ERROR
#35: PLEASE SELECT FIRST THE TARGET STM32L4XX DEVICE USED IN YOUR
APPLICATION</h3>
<figure>
<img src="https://pic.islet.space/2022/06/image-20220608105439447.png"
alt="image-20220608105439447" />
<figcaption aria-hidden="true">image-20220608105439447</figcaption>
</figure>
<p>没有添加宏定义，添加 <code>-DSTM32L476xx</code> 和
<code>-DUSE_HAL_DRIVER</code> 即可。</p>
<h3
id="error-l6050u-the-code-size-of-the-image-exceeds-the-maximum">ERROR
L6050U: THE CODE SIZE OF THE IMAGE EXCEEDS THE MAXIMUM</h3>
<figure>
<img src="https://pic.islet.space/2022/06/image-20220608110734097.png"
alt="image-20220608110734097" />
<figcaption aria-hidden="true">image-20220608110734097</figcaption>
</figure>
<blockquote>
<p>版权问题，当你在使用keil时，出现
<code>error: L6050U: The code size of this image (45178 bytes) exceeds the maximum allowed for this version of the linker.</code>
的时候，那就是 keil
没有被破解，软件本身的字节数有局限性，需要下载个MDK注册机进行破解！</p>
</blockquote>
<h3 id="error-a1854e-unknown-opcode-blx-maybe-wrong-target-cpu">Error:
A1854E: Unknown opcode 'BLX', maybe wrong target CPU?</h3>
<figure>
<img src="https://pic.islet.space/2022/06/image-20220608151900214.png"
alt="image-20220608151900214" />
<figcaption aria-hidden="true">image-20220608151900214</figcaption>
</figure>
<h2 id="warning">WARNING</h2>
<h3
id="warning-1295-d-deprecated-declaration-two_wired_resync---give-arg-types">Warning:
#1295-D: Deprecated declaration two_wired_resync - give arg types</h3>
<figure>
<img src="https://pic.islet.space/2022/06/image-20220608135309057.png"
alt="image-20220608135309057" />
<figcaption aria-hidden="true">image-20220608135309057</figcaption>
</figure>
<p>在传递参数为空的函数中，必须写 <code>void</code>
，armcc要求比较严格，<code>arm-none-eabi</code> 的要求比较宽松。</p>
<h1 id="reference">REFERENCE</h1>
<ol type="1">
<li><a
target="_blank" rel="noopener" href="https://www.cnblogs.com/zhangsx/p/zhangsx_keil_tools_usage.html">keil编译链接过程以及ARMCC、ARMASM、FROMELF、ARMLINK、ARMAR的使用</a></li>
<li><a
target="_blank" rel="noopener" href="https://developer.arm.com/documentation/dui0375/g/Compiler-Command-line-Options/">ARM
Compiler v5.06 for uVision armcc User Guide</a></li>
<li>《<a
target="_blank" rel="noopener" href="https://documentation-service.arm.com/static/5f721c6c1b758617cd950f6f?token=">ARM®
Compiler v5.06 for μVision®</a>》</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://islet.space/2022/05/24/Computer/2022-05-24-%E5%B5%8C%E5%85%A5%E5%BC%8F%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B%E5%B8%88%E7%9A%84%E7%94%9F%E4%BA%A7%E5%8A%9B%E5%B7%A5%E5%85%B7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liewzheng">
      <meta itemprop="description" content="笔记分享的旮旯孤岛而已">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder的孤岛">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/24/Computer/2022-05-24-%E5%B5%8C%E5%85%A5%E5%BC%8F%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B%E5%B8%88%E7%9A%84%E7%94%9F%E4%BA%A7%E5%8A%9B%E5%B7%A5%E5%85%B7/" class="post-title-link" itemprop="url">嵌入式软件工程师的生产力工具</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">

    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-05-24 10:45:00" itemprop="dateCreated datePublished" datetime="2022-05-24T10:45:00+08:00">2022-05-24</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2022-06-11 14:47:56" itemprop="dateModified" datetime="2022-06-11T14:47:56+08:00">2022-06-11</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Computer/" itemprop="url" rel="index"><span itemprop="name">Computer</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="common-tools">Common Tools</h1>
<p>软件启动：utools / alfred</p>
<p>小插件合集：utools</p>
<p>文件搜索：everything(windows)</p>
<p>MD：Typora（插件Pandoc）</p>
<p>图床：picgo</p>
<p>自由：V2Ray-Core / ClashX</p>
<p>网站视频下载：Downie4</p>
<p>截图：Snipaste</p>
<p>解压：Bandizip</p>
<p>思维导图：Xmind</p>
<p>翻译：deepl /</p>
<h1 id="engineer">Engineer</h1>
<p>BASH：zsh（Oh-my-zsh）</p>
<p>终端插件：<a href="fig.io">fig</a></p>
<p>zsh皮肤：powerlevel10k</p>
<h1 id="python">Python</h1>
<p>代码编辑器：Jupyter Lab（比Notebook更好用）</p>
<p>Python环境管理工具：Miniconda</p>
<p>Python常用库：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pandas xlrd openpyxl xlsxwriter requests lxml html5lib BeautifulSoup4 matplotlib seaborn plotly bokeh scipy statsmodels python-frontmatter opencv-python</span><br></pre></td></tr></table></figure>
<h1 id="embedded">Embedded</h1>
<h2 id="vs-code-插件">VS code 插件</h2>
<p>git痕迹查看：GitLens</p>
<p>代码注释：Doxygen</p>
<p>Keil开发代替IDE：EIDE</p>
<h2 id="compiling">Compiling</h2>
<p>交叉编译：cmake / make</p>
<p>单元测试：valgrind lcov</p>
<h1 id="jenkins">Jenkins</h1>
<p>environment Injector</p>
<p>Publish Over FTP</p>
<p>CMake</p>
<p>xUnit</p>
<h1 id="linux">Linux</h1>
<ul>
<li><code>rsync</code> ：同步文件。</li>
<li><code>tree</code> ：目录树</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://islet.space/2022/05/22/Programming/Python/2022-05-22-python-%E8%B0%83%E8%AF%95%E6%97%A5%E5%BF%97/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liewzheng">
      <meta itemprop="description" content="笔记分享的旮旯孤岛而已">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder的孤岛">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/22/Programming/Python/2022-05-22-python-%E8%B0%83%E8%AF%95%E6%97%A5%E5%BF%97/" class="post-title-link" itemprop="url">python 调试日志</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">

    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-05-22 01:25:00" itemprop="dateCreated datePublished" datetime="2022-05-22T01:25:00+08:00">2022-05-22</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2022-06-09 21:57:55" itemprop="dateModified" datetime="2022-06-09T21:57:55+08:00">2022-06-09</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Programming/" itemprop="url" rel="index"><span itemprop="name">Programming</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="奇淫巧技">奇淫巧技</h1>
<h2 id="文本替换">文本替换</h2>
<h3 id="object-类型文本替换">object 类型文本替换</h3>
<p>object 目前还没有找到替换方法，可以将 <code>object</code> 类型转换成
<code>string</code> 数据类型，再用 <code>str.replace()</code>
方法进行文本替换。</p>
<ol type="1">
<li>用 <code>.astype('string')</code> 方法将 <code>object</code>
类型转换成 <code>string</code> 类型。</li>
<li>使用
<code>.str.replace(&lt;old-string&gt;,&lt;new-string&gt;)</code>
方法对文本进行替换。并使用 <code>tmp</code> 变量进行保存。</li>
<li>将 <code>tmp</code> 变量重新赋值给原来的变量。</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pdata[<span class="string">&#x27;timestamp&#x27;</span>] = pdata.timestamp.astype(<span class="string">&#x27;string&#x27;</span>)  <span class="comment"># 将 object 类型转换成 string类型</span></span><br><span class="line">tmp = pdata[<span class="string">&#x27;timestamp&#x27;</span>].<span class="built_in">str</span>.replace(<span class="string">&#x27;BIN3-&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">pdata[<span class="string">&#x27;timestamp&#x27;</span>] = tmp</span><br></pre></td></tr></table></figure>
<h1 id="debug-record">DEBUG RECORD</h1>
<h2 id="nonetype-object-is-not-subscriptable">nonetype object is not
subscriptable</h2>
<p>大概意思就是，这个 <code>timestamp</code> 是 <code>object</code>
数据类型，替换了之后这个不能显示了估计。</p>
<figure>
<img src="https://pic.islet.space/2022/06/image-20220522012451872.png"
alt="image-20220522012451872" />
<figcaption aria-hidden="true">image-20220522012451872</figcaption>
</figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://islet.space/2022/05/11/Programming/Compiling/2022-05-11-wsl%E4%B8%8B%E7%BC%96%E8%AF%91stm32%E5%B9%B3%E5%8F%B0%E7%9A%84%E8%BD%AF%E4%BB%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liewzheng">
      <meta itemprop="description" content="笔记分享的旮旯孤岛而已">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder的孤岛">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/11/Programming/Compiling/2022-05-11-wsl%E4%B8%8B%E7%BC%96%E8%AF%91stm32%E5%B9%B3%E5%8F%B0%E7%9A%84%E8%BD%AF%E4%BB%B6/" class="post-title-link" itemprop="url">wsl下编译stm32平台的软件</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">

    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-05-11 15:19:00" itemprop="dateCreated datePublished" datetime="2022-05-11T15:19:00+08:00">2022-05-11</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2022-06-09 21:53:32" itemprop="dateModified" datetime="2022-06-09T21:53:32+08:00">2022-06-09</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Programming/" itemprop="url" rel="index"><span itemprop="name">Programming</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>本文是介绍嵌入式工程师的CLI编译工具部署方法，所用编译器是 ARM GCC，即
<code>gcc-arm-none-eabi</code> ，案例也是使用 STM32 CubeMX
生成的文件。中间涉及到一些 <strong>单元测试</strong>
相关的插件安装可以视情况选择或弃用。</p>
<p>下方的操作需要提前安装好
Windows子系统Linux（<strong>WSL</strong>，Windows Subsystem Linux）或者
<strong>虚拟机</strong>，且确保使用的是 shell 是
<code>zsh</code>，否则下方的一些配置文件（如 <code>~/.zshrc</code>
）需要手动改成对应 shell 的配置文件。</p>
<h1 id="安装软件">安装软件</h1>
<figure>
<img src="https://pic.islet.space/2022/05/image-20220507181341683.png"
alt="image-20220507181341683" />
<figcaption aria-hidden="true">image-20220507181341683</figcaption>
</figure>
<h2 id="安装git">安装git</h2>
<p>仅实例安装，配置 用户名 和 邮箱 那些的操作请自行搜索。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install git</span><br></pre></td></tr></table></figure>
<h2 id="安装工具链编译器">安装工具链/编译器</h2>
<ol type="1">
<li>到 <a target="_blank" rel="noopener" href="https://developer.arm.com/downloads/-/gnu-rm">官网</a>
去下载自己需要的编译器。</li>
<li>然后进行解压到与 repo 相同位置的 <code>~/bin</code>
（放其他位置也可以）。</li>
<li>设置系统变量</li>
</ol>
<p>下方以 <code>gcc-arm-none-eabi-5_4-2016q3</code> 为例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/Downloads</span><br><span class="line">wget https://storage.islet.space/02_Softwares/06_Embedded/01_CrossCompiler/gcc-arm-none-eabi/gcc-arm-none-eabi-5_4-2016q3.tar.gz</span><br><span class="line">tar -zxvf gcc-arm-none-eabi-5_4-2016q3.tar.gz</span><br><span class="line">cp -r ~/Downloads/gcc-arm-none-eabi-5_4-2016q3 ~/bin/</span><br></pre></td></tr></table></figure>
<h2 id="安装编译工具">安装编译工具</h2>
<p>下方这些操作默认安装不指定版本的cmake和make。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install cmake make</span><br></pre></td></tr></table></figure>
<h2 id="安装单元测试工具">安装单元测试工具</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install lcov valgrind</span><br></pre></td></tr></table></figure>
<h2 id="安装repo">安装repo</h2>
<p><code>git</code> 和 <code>python2</code> 是 <code>repo</code>
的依赖，记得先安装。</p>
<ol type="1">
<li>创建 <code>~/bin</code> 路径。</li>
<li>选择国内源安装repo。</li>
<li>赋予 <code>~/bin/repo</code> 执行权限。</li>
<li>使 <code>REPO_URL</code> 变成系统变量。</li>
<li>将 <code>~/bin</code> 放到 <code>PATH</code> 环境变量中。</li>
<li>使配置生效。。</li>
</ol>
<p>这一步简化成下面这些操作，对照着执行即可。（千万不要直接用
<code>apt install repo</code> 进行安装，国内大部分情况用不了）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mkdir ~/bin</span><br><span class="line">curl https://mirrors.tuna.tsinghua.edu.cn/git/git-repo &gt; ~/bin/repo</span><br><span class="line">chmod a+x ~/bin/repo</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;export REPO_URL=&#x27;https://mirrors.tuna.tsinghua.edu.cn/git/git-repo&#x27;&quot;</span> &gt;&gt; ~/.zshrc</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;export PATH=~/bin:<span class="variable">$PATH</span>&quot;</span> &gt;&gt; ~/.zshrc</span><br><span class="line"><span class="built_in">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure>
<h1 id="拉代码">拉代码</h1>
<p>下方仅实例 repo 工具的代码拉取指令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">repo init -u git@github.com:xxx/xxxxxx.git -b dev</span><br><span class="line">repo sync -j8</span><br></pre></td></tr></table></figure>
<p>拉下来之后会有下面这些文件，其中 <code>out</code> 、 <code>tmp</code>
是之后才生成的。</p>
<figure>
<img src="https://pic.islet.space/2022/05/image-20220511154414265.png"
alt="image-20220511154414265" />
<figcaption aria-hidden="true">image-20220511154414265</figcaption>
</figure>
<h1 id="编译命令">编译命令</h1>
<p>使用编写的脚本进行单元测试、编译和其他操作：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./sdk/build/build.sh --board stm32l476rg --compiler <span class="variable">$ARM_GCC_PATH</span> --debug</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://islet.space/2022/04/13/Programming/Windows/2022-04-13-EIDE-with-VS-Code/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liewzheng">
      <meta itemprop="description" content="笔记分享的旮旯孤岛而已">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder的孤岛">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/04/13/Programming/Windows/2022-04-13-EIDE-with-VS-Code/" class="post-title-link" itemprop="url">EIDE with VS Code</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">

    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-04-13 18:00:00" itemprop="dateCreated datePublished" datetime="2022-04-13T18:00:00+08:00">2022-04-13</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2022-04-15 22:57:36" itemprop="dateModified" datetime="2022-04-15T22:57:36+08:00">2022-04-15</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Programming/" itemprop="url" rel="index"><span itemprop="name">Programming</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>本文主要是将 在KEIL上能够成功编译的 STM32F103VE 芯片项目转移到 VS
Code 的 <strong>EIDE</strong> 插件中，主要是针对 Keil MDK-ARM 中的
Option 进行参数复制，即 EIDE 的配置。</p>
<p>需要以下两个工具：</p>
<ul>
<li>Keil MDK-ARM</li>
<li>Keil.STM32F1xx_DFP.2.4.0.pack</li>
</ul>
<p>其实还是依托于 Keil MDK-ARM ，只是换了 VS Code 的皮。</p>
<h1 id="eide-install">EIDE INSTALL</h1>
<p>首先需要在 VS Code 中安装 Embedded IDE（如下），官方手册：<a
target="_blank" rel="noopener" href="https://docs.em-ide.com/">EIDE在线文档</a> 。</p>
<figure>
<img src="https://pic.islet.space/2022/04/image-20220414214014581.png"
alt="image-20220414214014581" />
<figcaption aria-hidden="true">image-20220414214014581</figcaption>
</figure>
<h1 id="eide-configuration">EIDE CONFIGURATION</h1>
<p>对 EIDE 的配置主要包括 <a href="##扩展设置">扩展设置</a> 、<a
href="##芯片支持包安装">芯片支持包安装</a> 、<a
href="##构建参数设置">构建参数设置</a> 和 <a
href="##项目属性设置">项目属性设置</a>。</p>
<figure>
<img src="https://pic.islet.space/2022/04/image-20220414211312253.png"
alt="image-20220414211312253" />
<figcaption aria-hidden="true">image-20220414211312253</figcaption>
</figure>
<h2 id="扩展设置">扩展设置</h2>
<p>可以在 VS Code 的插件中选中 <code>Embedded IDE</code>
，在齿轮状设置图标菜单里选择
<code>扩展设置</code>，在里面配置好编译工具链的路径还有一些可设置选项。</p>
<p><img src="https://pic.islet.space/2022/04/image-20220414203531929.png" alt="image-20220414203531929" style="zoom:50%;" /></p>
<p>STM32 可以用 ARM CC 和 ARM GCC 进行编译，具体需要看芯片要求，Keil
的话用的是 ARM CC 5版本或者 ARM CC 6 版本。</p>
<p>可以到 Keil MDK-ARM 的安装路径下进行查看，例如 在
<code>D:\Keil_v5\ARM\ARMCC\bin</code> 中，选择右键
<code>用 Powershell 打开</code>，然后输入 <code>./armcc.exe</code>
即可查看版本号。</p>
<p><img src="https://pic.islet.space/2022/04/image-20220414183859215.png" alt="image-20220414183859215" style="zoom:50%;" /></p>
<p>主要配置六个参数即可，需要根据本地的 Keil
安装路径来进行设置（不要盲目复制粘贴）。</p>
<p><img src="https://pic.islet.space/2022/04/image-20220414203709473.png" alt="image-20220414203709473" style="zoom:50%;" /></p>
<p><img src="https://pic.islet.space/2022/04/image-20220414203744037.png" alt="image-20220414203744037" style="zoom:50%;" /></p>
<h2 id="芯片支持包安装">芯片支持包安装</h2>
<p>Keil 的芯片支持包主要看 <code>Option</code> -&gt; <code>Target</code>
下的 <code>STM32F103xx.svd</code> 。</p>
<p><img src="https://pic.islet.space/2022/04/image-20220414194711199.png" alt="image-20220414194711199" style="zoom:50%;" /></p>
<p>通过本地搜索可以看到这个文件需要通过安装 <code>.pack</code>
扩展包得到。</p>
<figure>
<img src="https://pic.islet.space/2022/04/image-20220414190916865.png"
alt="image-20220414190916865" />
<figcaption aria-hidden="true">image-20220414190916865</figcaption>
</figure>
<p>到 <a target="_blank" rel="noopener" href="https://www.keil.com/dd2/Pack/">MDK5 Software Packs
(keil.com)</a> 中搜索对应芯片的扩展包，如 <a
target="_blank" rel="noopener" href="https://keilpack.azureedge.net/pack/Keil.STM32F1xx_DFP.2.4.0.pack"><code>Keil.STM32F1xx_DFP.2.4.0.pack</code></a>
。</p>
<p><img src="https://pic.islet.space/2022/04/image-20220414193428926.png" alt="image-20220414193428926" style="zoom:33%;" /></p>
<p>点击 芯片支持包 右侧的 加号，即可选择通过
<strong>在线安装</strong>（From Repo） 或者
<strong>离线安装</strong>（From Disk）。</p>
<figure>
<img src="https://pic.islet.space/2022/04/image-20220414212238565.png"
alt="image-20220414212238565" />
<figcaption aria-hidden="true">image-20220414212238565</figcaption>
</figure>
<figure>
<img src="https://pic.islet.space/2022/04/image-20220414212220319.png"
alt="image-20220414212220319" />
<figcaption aria-hidden="true">image-20220414212220319</figcaption>
</figure>
<p>安装完扩展包之后 再点击下图中的加号，输入芯片型号进行进一步选择。</p>
<p><img src="https://pic.islet.space/2022/04/image-20220414191124478.png" alt="image-20220414191124478" style="zoom: 33%;" /></p>
<p>即可查看芯片的大致信息：</p>
<p><img src="https://pic.islet.space/2022/04/image-20220414190706840.png" alt="image-20220414190706840" style="zoom:33%;" /></p>
<h2 id="构建参数设置">构建参数设置</h2>
<p>构建参数的依据是 Keil 中的这几个参数选项卡：</p>
<p><img src="https://pic.islet.space/2022/04/image-20220414212732414.png" alt="image-20220414212732414" style="zoom:50%;" /></p>
<p>方法：</p>
<ol type="1">
<li>提取 Keil 中的构建参数 （如下 C/C++ 参数设置）</li>
<li>提取 EIDE 中的构建参数</li>
<li>对比差异，以 Keil 为准对 EIDE 进行增删</li>
</ol>
<h3 id="cc-参数设置">C/C++ 参数设置</h3>
<p>下方是 Keil 中对 C/C++ 的构建参数管理页面：</p>
<p><img src="https://pic.islet.space/2022/04/image-20220414200627162.png" alt="image-20220414200627162" style="zoom: 50%;" /></p>
<p>以下是从 Keil MD5 的 <code>Option</code>
中扒下来的编译参数，即最后一行的 <code>Compiler Control String</code>
：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-c --cpu Cortex-M3 -D__MICROLIB -g -O3 --apcs=interwork --split_sections -I include -I ../ -I ../../../Libraries/CMSIS/CM3/CoreSupport -I ../../../Libraries/CMSIS/CM3/DeviceSupport/ST/STM32F10x -I ../../../Libraries/STM32F10x_StdPeriph_Driver/inc -I ../../../Utilities/STM32_EVAL -I ../../../Utilities/STM32_EVAL/STM3210B_EVAL -I ../../../Utilities/STM32_EVAL/Common -I ../../STM32F10x_StdPeriph_Template -I ../MDK-ARM</span><br><span class="line">-IF:/Workspace/xiwang_production_test_embedded/Project/STM32F10x_StdPeriph_Template/MDK-ARM/RTE/_STM3210B-EVAL</span><br><span class="line">-ID:/Keil_v5/ARM/PACK/ARM/CMSIS/5.0.0/CMSIS/Include</span><br><span class="line">-ID:/Keil_v5/ARM/PACK/Keil/STM32F1xx_DFP/2.4.0/Device/Include</span><br><span class="line">-D__UVISION_VERSION=<span class="string">&quot;522&quot;</span> -D_RTE_ -DSTM32F10X_HD -DUSE_STDPERIPH_DRIVER -DSTM32F10X_HD -DUSE_STM3210B_EVAL</span><br><span class="line">-o .\build\STM3210B-EVAL\*.o --omf_browse .\build\STM3210B-EVAL\*.crf --depend .\build\STM3210B-EVAL\*.d</span><br></pre></td></tr></table></figure>
<p>以下是从 EIDE 中扒下来的编译命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">......</span><br><span class="line"></span><br><span class="line">C <span class="built_in">command</span> line (armcc): </span><br><span class="line"></span><br><span class="line">-c --apcs=interwork --cpu Cortex-M3 --li --c99 -D__MICROLIB -O0 --split_sections --diag_suppress=1 --diag_suppress=1295 -g -I.\.. -I.\..\..\..\Libraries\CMSIS\CM3\CoreSupport -I.\..\..\..\Libraries\CMSIS\CM3\DeviceSupport\ST\STM32F10x -I.\..\..\..\Libraries\STM32F10x_StdPeriph_Driver\inc -I.\..\..\..\Utilities\STM32_EVAL -I.\..\..\..\Utilities\STM32_EVAL\STM32100E_EVAL -I.\..\..\..\Utilities\STM32_EVAL\Common -I.\.cmsis\dsp_lib -I.\.cmsis\include -I.\RTE\_STM32100E-EVAL -I.\.eide\deps -I.\include -I.\.eide\deps -DUSE_STDPERIPH_DRIVER -DSTM32F10X_HD_VL -DUSE_STM32100E_EVAL -DGD32F10X_HD</span><br><span class="line"></span><br><span class="line">CPP <span class="built_in">command</span> line (armcc): </span><br><span class="line"></span><br><span class="line">-c --cpp --apcs=interwork --cpu Cortex-M3 --li -D__MICROLIB -O0 --split_sections --diag_suppress=1 --diag_suppress=1295 -g -I.\.. -I.\..\..\..\Libraries\CMSIS\CM3\CoreSupport -I.\..\..\..\Libraries\CMSIS\CM3\DeviceSupport\ST\STM32F10x -I.\..\..\..\Libraries\STM32F10x_StdPeriph_Driver\inc -I.\..\..\..\Utilities\STM32_EVAL -I.\..\..\..\Utilities\STM32_EVAL\STM32100E_EVAL -I.\..\..\..\Utilities\STM32_EVAL\Common -I.\.cmsis\dsp_lib -I.\.cmsis\include -I.\RTE\_STM32100E-EVAL -I.\.eide\deps -I.\include -I.\.eide\deps -DUSE_STDPERIPH_DRIVER -DSTM32F10X_HD_VL -DUSE_STM32100E_EVAL -DGD32F10X_HD</span><br><span class="line"></span><br><span class="line">......</span><br></pre></td></tr></table></figure>
<p><strong>EIDE 中查看编译命令的方法</strong>：项目名称右键点击
<code>查看生成的编译器命令行</code> 即可。</p>
<p><img src="https://pic.islet.space/2022/04/image-20220414194229852.png" alt="image-20220414194229852" style="zoom:33%;" /></p>
<p>互相比对二者之间的编译参数差异，发现以下差异：</p>
<ol type="1">
<li>Keil 中的代码优化等级为 <code>3</code> 即参数 <code>-O3</code> ，而
EIDE 中为 <code>0</code> 即参数 <code>-O0</code> 。</li>
<li>EIDE 比 Kei多了几个参数
<code>--diag_suppress=1 --diag_suppress=1295</code> ，需要删除。</li>
</ol>
<h3 id="asm-和-linker-参数设置">ASM 和 Linker 参数设置</h3>
<p>对比过 Keil 的参数之后，保持如下设置：</p>
<figure>
<img src="https://pic.islet.space/2022/04/image-20220414213239217.png"
alt="image-20220414213239217" />
<figcaption aria-hidden="true">image-20220414213239217</figcaption>
</figure>
<figure>
<img src="https://pic.islet.space/2022/04/image-20220414213257541.png"
alt="image-20220414213257541" />
<figcaption aria-hidden="true">image-20220414213257541</figcaption>
</figure>
<h2 id="项目属性设置">项目属性设置</h2>
<h3 id="包含路径设置">包含路径设置</h3>
<p>这个就不多说了。</p>
<p>需要注意的是，RTE路径下的 <code>STM32xxx-EVAL</code>
一定要是正确的，可以多，不要少。</p>
<figure>
<img src="https://pic.islet.space/2022/04/image-20220414213503962.png"
alt="image-20220414213503962" />
<figcaption aria-hidden="true">image-20220414213503962</figcaption>
</figure>
<h3 id="预处理定义">预处理定义</h3>
<p>从 EIDE 导入 Keil 项目时，可能回设置很多不需要或者错误的
<strong>预处理定义</strong>（宏定义），需要跟 Keil 保持一致。</p>
<p><img src="https://pic.islet.space/2022/04/image-20220414213732758.png" alt="image-20220414213732758" style="zoom:50%;" /></p>
<p><img src="https://pic.islet.space/2022/04/image-20220414195358900.png" alt="image-20220414195358900" style="zoom:33%;" /></p>
<h1 id="debug-records">DEBUG RECORDS</h1>
<h2 id="expected-a">EXPECTED A }</h2>
<p>提示 少了 <code>&#125;</code>
，该文件是官方文件，应该不会错。经过检查，发现是宏定义过多导致的错误，修改过
<a href="###预处理定义">预处理定义</a> 中的宏定义设置就解决了。</p>
<p><img src="https://pic.islet.space/2022/04/image-20220414190748098.png" alt="image-20220414190748098" style="zoom:33%;" /></p>
<p>如下，<code>STM32F10X_HD</code> 和 <code>STM32F10X_HD_VL</code>
冲突了。</p>
<p><img src="https://pic.islet.space/2022/04/image-20220414194044509.png" alt="image-20220414194044509" style="zoom:50%;" /></p>
<p>最后，编译结果：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">[ INFO ] start building at 2022-04-14 20:22:39</span><br><span class="line"></span><br><span class="line">[ TOOL ] ARM Compiler 5.06 update 4 (build 422)</span><br><span class="line"></span><br><span class="line">[ INFO ] file statistics (rebuild mode)</span><br><span class="line"></span><br><span class="line">+---------+-----------+-----------+-----------+--------+</span><br><span class="line">| C Files | Cpp Files | Asm Files | Lib Files | Totals |</span><br><span class="line">+---------+-----------+-----------+-----------+--------+</span><br><span class="line">| 46      | 0         | 1         | 0         | 47     |</span><br><span class="line">+---------+-----------+-----------+-----------+--------+</span><br><span class="line"></span><br><span class="line">[ INFO ] start compilation (<span class="built_in">jobs</span>: 4) ...</span><br><span class="line"></span><br><span class="line">&gt;&gt; [  2%] CC <span class="string">&#x27;../../../Libraries/CMSIS/CM3/CoreSupport/core_cm3.c&#x27;</span></span><br><span class="line">&gt;&gt; [  4%] CC <span class="string">&#x27;main.c&#x27;</span></span><br><span class="line">&gt;&gt; [  6%] CC <span class="string">&#x27;../../../Libraries/STM32F10x_StdPeriph_Driver/src/stm32f10x_flash.c&#x27;</span></span><br><span class="line">&gt;&gt; [  8%] CC <span class="string">&#x27;../../../Libraries/STM32F10x_StdPeriph_Driver/src/stm32f10x_usart.c&#x27;</span></span><br><span class="line">......</span><br><span class="line">&gt;&gt; [ 89%] CC <span class="string">&#x27;source/stm32f10x_it.c&#x27;</span></span><br><span class="line">&gt;&gt; [ 91%] CC <span class="string">&#x27;../../../Utilities/STM32_EVAL/STM32100E_EVAL/stm32100e_eval_lcd.c&#x27;</span></span><br><span class="line">&gt;&gt; [ 93%] CC <span class="string">&#x27;source/system_stm32f10x.c&#x27;</span></span><br><span class="line">&gt;&gt; [ 95%] CC <span class="string">&#x27;../../../Utilities/STM32_EVAL/stm32_eval.c&#x27;</span></span><br><span class="line">&gt;&gt; [ 97%] CC <span class="string">&#x27;source/write.c&#x27;</span></span><br><span class="line">&gt;&gt; [100%] AS <span class="string">&#x27;../../../Libraries/CMSIS/CM3/DeviceSupport/ST/STM32F10x/startup/arm/startup_stm32f10x_hd_vl.s&#x27;</span></span><br><span class="line"></span><br><span class="line">[ INFO ] start linking ...</span><br><span class="line"></span><br><span class="line">Program Size: Code=9028 RO-data=340 RW-data=156 ZI-data=1412  </span><br><span class="line"></span><br><span class="line">Total RO  Size (Code + RO Data)                 9368 (   9.15kB)</span><br><span class="line">Total RW  Size (RW Data + ZI Data)              1568 (   1.53kB)</span><br><span class="line">Total ROM Size (Code + RO Data + RW Data)       9524 (   9.30kB)</span><br><span class="line"></span><br><span class="line">RAM  : [          ] 2.4%        1.5KB/64.0KB</span><br><span class="line">FLASH: [          ] 1.8%        9.3KB/512.0KB</span><br><span class="line"></span><br><span class="line">[ INFO ] start outputting file ...</span><br><span class="line"></span><br><span class="line">&gt;&gt; output hex file              [<span class="keyword">done</span>]</span><br><span class="line"></span><br><span class="line">file path: <span class="string">&quot;build/STM32100E-EVAL/FT_Test.hex&quot;</span></span><br><span class="line"></span><br><span class="line">&gt;&gt; output s19 file              [<span class="keyword">done</span>]</span><br><span class="line"></span><br><span class="line">file path: <span class="string">&quot;build/STM32100E-EVAL/FT_Test.s19&quot;</span></span><br><span class="line"></span><br><span class="line">&gt;&gt; output bin file              [<span class="keyword">done</span>]</span><br><span class="line"></span><br><span class="line">file path: <span class="string">&quot;build/STM32100E-EVAL/FT_Test.bin&quot;</span></span><br><span class="line"></span><br><span class="line">[ DONE ] build successfully !, elapsed time 0:0:9</span><br><span class="line"></span><br><span class="line">[ INFO ] run tasks after build ...</span><br><span class="line"></span><br><span class="line">&gt;&gt; axf to elf           [<span class="keyword">done</span>]</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://islet.space/2022/03/26/Programming/Python/2022-03-26-matplotlib%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liewzheng">
      <meta itemprop="description" content="笔记分享的旮旯孤岛而已">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder的孤岛">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/03/26/Programming/Python/2022-03-26-matplotlib%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/" class="post-title-link" itemprop="url">matplotlib图形绘制</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">

    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-03-26 15:00:00" itemprop="dateCreated datePublished" datetime="2022-03-26T15:00:00+08:00">2022-03-26</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2022-04-15 22:57:36" itemprop="dateModified" datetime="2022-04-15T22:57:36+08:00">2022-04-15</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Programming/" itemprop="url" rel="index"><span itemprop="name">Programming</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>类似于 gnuplot ， matplotlib 也是开源的图形绘制软件。</p>
<p>需要使用到的工具如下：</p>
<ul>
<li>Jupyter：python 分布调试 和 Markdown 笔记记录一体化工具。</li>
<li>Python3.10</li>
<li>Python3 插件： matplotlib / pandas</li>
<li>VS code 所需插件： pylance</li>
</ul>
<p>其中， matplotlib 是绘图所用的开源工具库，而 pandas 是文档管理的
“瑞士军刀”。</p>
<h1 id="环境安装">环境安装</h1>
<h2 id="jupyter-安装">JUPYTER 安装</h2>
<p>Jupyter可以支持在线和离线使用，在线即以网页形式支持使用，可以在服务器上进行部署。离线即在
Visual Studio Code 中以插件形式提供安装和使用。</p>
<h3 id="在线安装">在线安装</h3>
<p>以 Ubuntu 系统为例，可以用 <code>apt</code> 进行安装，也可以用
<code>pip</code> （或 <code>pip3</code> ）进行安装。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install jupyter</span><br></pre></td></tr></table></figure>
<p>在线版 Jupyter 还需要安装一个 <code>ipyparallel</code> 的类：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip3 install ipyparallel</span><br><span class="line">ipcluster start</span><br></pre></td></tr></table></figure>
<h4 id="远程访问配置项">远程访问配置项</h4>
<p>参考 《<a
target="_blank" rel="noopener" href="https://www.cnblogs.com/wu-chao/p/8419889.html">ubuntu
安装Juypter并设置远程访问</a>》对 服务器端
Jupyter进行设置和访问测试。</p>
<p>相关防火墙设置 / 证书 / 域名 不再赘述。</p>
<h4 id="自启动配置">自启动配置</h4>
<p>另外，Linux 服务器端 Jupyter 用 <code>jupyter notebook</code>
命令启动，无法开机自启，需要参考 《<a
target="_blank" rel="noopener" href="https://blog.csdn.net/initiallht/article/details/122029888">Linux下Jupyter开机启动设置</a>》
进行设置。</p>
<p>设置好后 在线版 Jupyter 编辑器的页面如下：</p>
<figure>
<img src="https://pic.islet.space/2022/03/image-20220327165129680.png"
alt="在线使用界面" />
<figcaption aria-hidden="true">在线使用界面</figcaption>
</figure>
<h3 id="离线安装">离线安装</h3>
<p>在 VS code 插件中搜索并安装第一个 <code>Jupyter</code>
即可，插件系统会自动安装下面附带的 <code>Jupyter Keymap</code> 和
<code>Jupyter Notebook Renderers</code> 两个插件。</p>
<figure>
<img src="https://pic.islet.space/2022/03/image-20220327163752153.png"
alt="image-20220327163752153" />
<figcaption aria-hidden="true">image-20220327163752153</figcaption>
</figure>
<p>安装完之后，需要新建一个 <code>.ipynb</code> 格式的文件，即可自动打开
<code>Jupyter</code> 插件进行使用。</p>
<figure>
<img src="https://pic.islet.space/2022/03/image-20220327165214773.png"
alt="离线使用界面" />
<figcaption aria-hidden="true">离线使用界面</figcaption>
</figure>
<h2 id="pip-依赖库安装">PIP 依赖库安装</h2>
<p>在线版和离线版都需要使用 terminal
打开并输入命令进行安装下方的依赖库：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install matplotlib pandas</span><br></pre></td></tr></table></figure>
<h1 id="图形生成代码">图形生成代码</h1>
<p>下方利用 pandas 类对 <code>.csv</code>
文件中的相关列进行数据提取，然后利用 matplotlib 类对 数据进行绘图。</p>
<p>因功能比较简单，不再赘述。</p>
<p>具体需要注意的事项已在代码注释中写明。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入依赖库</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入工具</span></span><br><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series,DataFrame</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> matplotlib.font_manager <span class="keyword">import</span> FontProperties</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置csv表格中的行信息</span></span><br><span class="line">column=[<span class="string">&quot;ts&quot;</span>,<span class="string">&quot;dx&quot;</span>,<span class="string">&quot;dy&quot;</span>,<span class="string">&quot;motion&quot;</span>,<span class="string">&quot;iqc&quot;</span>,<span class="string">&quot;shutter&quot;</span>,<span class="string">&quot;frame_avg&quot;</span>,<span class="string">&quot;status&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置文件路径</span></span><br><span class="line">csv_file_path = <span class="string">&#x27;../data/&#x27;</span></span><br><span class="line">pic_file_path = <span class="string">&#x27;../pic/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输入和输出文件名</span></span><br><span class="line">file = <span class="string">&#x27;20220327_135012&#x27;</span></span><br><span class="line">csv_file_name = file + <span class="string">&#x27;.csv&#x27;</span></span><br><span class="line">pic_file_name = file + <span class="string">&#x27;.jpg&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置各轴及标题标签</span></span><br><span class="line">chart_title = <span class="string">&#x27;A4 data collection in stm32l476rg&#x27;</span></span><br><span class="line">x_label = <span class="string">&#x27;time(ms)&#x27;</span></span><br><span class="line">y_label = <span class="string">&#x27;data collected&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置各线段标签</span></span><br><span class="line">line_1_label = <span class="string">&#x27;dx&#x27;</span></span><br><span class="line">line_2_label = <span class="string">&#x27;dy&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置线段透明度</span></span><br><span class="line">line_1_alpha = <span class="number">0.5</span></span><br><span class="line">line_2_alpha = <span class="number">0.5</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置线段类型</span></span><br><span class="line"><span class="comment"># 可选 scatter 和 line</span></span><br><span class="line">plot_type = <span class="string">&#x27;scatter&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 用于正常显示中文标签</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>]=[<span class="string">&#x27;YAHEI&#x27;</span>]</span><br><span class="line"><span class="comment"># 用于正常显示正负号</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>]=<span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义空列表存放xy轴数据点</span></span><br><span class="line">x = []</span><br><span class="line">y = []</span><br><span class="line">z = []</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"># 可以使用open()方法对csv文件进行读取</span></span><br><span class="line"><span class="string"># 但是暂时没有找到可以避免读取到头部信息的方法，即不能跳过部分数据进行读取</span></span><br><span class="line"><span class="string">with open( csv_file_path + csv_file_name, &#x27;r&#x27;, encoding=&#x27;utf8&#x27;) as csv_file:</span></span><br><span class="line"><span class="string">    plots = csv.reader(csv_file, delimiter=&#x27;,&#x27;)</span></span><br><span class="line"><span class="string">    for row in plots:</span></span><br><span class="line"><span class="string">        x.append(int(row[0]))</span></span><br><span class="line"><span class="string">        y.append(int(row[1]))</span></span><br><span class="line"><span class="string">        z.append(int(row[2]))</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用panda的read_csv()方法可以设置跳过部分数据进行处理</span></span><br><span class="line">csv_file = pd.read_csv(csv_file_path + csv_file_name, </span><br><span class="line">                       skiprows=<span class="number">21</span>,</span><br><span class="line">                       delimiter=<span class="string">&#x27;,&#x27;</span>, </span><br><span class="line">                       names=column) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 将对应列数据放入变量中</span></span><br><span class="line">x = csv_file[<span class="string">&#x27;ts&#x27;</span>]</span><br><span class="line">y = csv_file[<span class="string">&#x27;dx&#x27;</span>]</span><br><span class="line">z = csv_file[<span class="string">&#x27;dy&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置线段标签</span></span><br><span class="line"><span class="keyword">if</span>( plot_type==<span class="string">&#x27;line&#x27;</span>):</span><br><span class="line">    plt.plot(x,y, label=line_1_label, alpha=line_1_alpha, lw=<span class="number">1</span>)</span><br><span class="line">    plt.plot(x,z, label=line_2_label, alpha=line_2_alpha, lw=<span class="number">1</span>)</span><br><span class="line"><span class="keyword">elif</span>( plot_type == <span class="string">&#x27;scatter&#x27;</span>):</span><br><span class="line">    plt.scatter(x,y, label=line_1_label, alpha=line_1_alpha, s=<span class="number">1</span>)</span><br><span class="line">    plt.scatter(x,z, label=line_2_label, alpha=line_2_alpha, s=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置x轴、y轴和标题标签</span></span><br><span class="line">plt.xlabel(x_label)</span><br><span class="line">plt.ylabel(y_label)</span><br><span class="line">plt.title(chart_title)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 展示图像</span></span><br><span class="line">plt.legend()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 图像保存</span></span><br><span class="line">plt.savefig( pic_file_path + pic_file_name , dpi=<span class="number">400</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<h1 id="使用方法">使用方法</h1>
<ol type="1">
<li>生成一个文件夹，下面包含三个并行子路径。</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">├── data</span><br><span class="line">├── pic</span><br><span class="line">└── src</span><br></pre></td></tr></table></figure>
<p>网页版：</p>
<figure>
<img src="https://pic.islet.space/2022/03/image-20220327164922369.png"
alt="网页版文件结构示意" />
<figcaption aria-hidden="true">网页版文件结构示意</figcaption>
</figure>
<ol start="2" type="1">
<li>将代码放到 <code>src/</code> 中，在将代码第19行中的
<code>file = '20220327_135012'</code> 文件名进行修改，确保其与
<code>data/</code> 路径下的 <code>.csv</code> 文件名成可以对上。</li>
<li>执行整段代码，即可在 <code>pic/</code>
文件夹下找到对应的图像文件。</li>
</ol>
<h1 id="reference">REFERENCE</h1>
<ol type="1">
<li><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/378378346">vscode写jupyter
notebook</a></p></li>
<li><p><a
target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/129004421">Pandas将csv数据拆分成多列并保存</a></p></li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://islet.space/2022/02/24/Hardware/STM32/2022-02-22-%E5%9C%A8mac%E4%B8%8A%E5%AE%89%E8%A3%85stm32CubeMX/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liewzheng">
      <meta itemprop="description" content="笔记分享的旮旯孤岛而已">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder的孤岛">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/02/24/Hardware/STM32/2022-02-22-%E5%9C%A8mac%E4%B8%8A%E5%AE%89%E8%A3%85stm32CubeMX/" class="post-title-link" itemprop="url">在mac上安装stm32CubeMX</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">

    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-02-24 02:00:00" itemprop="dateCreated datePublished" datetime="2022-02-24T02:00:00+08:00">2022-02-24</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2022-02-23 00:06:22" itemprop="dateModified" datetime="2022-02-23T00:06:22+08:00">2022-02-23</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Programming/" itemprop="url" rel="index"><span itemprop="name">Programming</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="tools-download-and-setup">TOOLS DOWNLOAD AND SETUP</h1>
<p>在 ST 官网下载了 CubeMX 的 Mac
版软件，然后会发现关闭安全相关的限制也没办法打开该软件包。</p>
<figure>
<img src="https://pic.islet.space/2022/02/image-20220222205346872.png"
alt="image-20220222205346872" />
<figcaption aria-hidden="true">image-20220222205346872</figcaption>
</figure>
<p>通过 <code>tree</code> 命令查看目录可以找到一个叫
<code>SetupSTM32CubeMX-6_3_0</code>
的应用程序，运行该文件即可进行安装。</p>
<figure>
<img src="https://pic.islet.space/2022/02/image-20220222205452868.png"
alt="image-20220222205452868" />
<figcaption aria-hidden="true">image-20220222205452868</figcaption>
</figure>
<p>Mac 系统上可运行的程序都是 <code>.App</code>
结尾的文件夹，直接点击右键的 <code>显示包内容</code> 即可进入查看。</p>
<figure>
<img src="https://pic.islet.space/2022/02/image-20220222205524560.png"
alt="image-20220222205524560" />
<figcaption aria-hidden="true">image-20220222205524560</figcaption>
</figure>
<p>双击 <code>SetupSTM32CubeMX-6_3_0</code> 即可运行安装程序。</p>
<figure>
<img src="https://pic.islet.space/2022/02/image-20220222205545346.png"
alt="image-20220222205545346" />
<figcaption aria-hidden="true">image-20220222205545346</figcaption>
</figure>
<h1 id="new-project">NEW PROJECT</h1>
<p>在 CubeMX 的 Home 界面，可以
<strong>根据芯片型号新建项目</strong>，也可以
<strong>根据ST板子型号新建项目</strong>。</p>
<figure>
<img src="https://pic.islet.space/2022/02/image-20220222213510204.png"
alt="image-20220222213510204" />
<figcaption aria-hidden="true">image-20220222213510204</figcaption>
</figure>
<p>只需要在对应需要的 MCU 或者 板子上双击即可。</p>
<figure>
<img src="https://pic.islet.space/2022/02/image-20220222213140557.png"
alt="image-20220222213140557" />
<figcaption aria-hidden="true">image-20220222213140557</figcaption>
</figure>
<p>如果使用ST自家的评估板，新建项目时建议直接选择
<code>ACCESS TO BOARD SELECTOR</code> 。</p>
<figure>
<img src="https://pic.islet.space/2022/02/image-20220222212802407.png"
alt="image-20220222212802407" />
<figcaption aria-hidden="true">image-20220222212802407</figcaption>
</figure>
<p>它会帮助默认设置一些板子上的外设（它会提示
<code>Initialize all peripherals with their default Mode?</code>
），就不用用户自己去设置，否则选择 <code>ACCESS TO MCU SELECTOR</code>
就会在某些地方上产生默认配置差异，如 GPIO。</p>
<figure>
<img src="https://pic.islet.space/2022/02/image-20220222213201459.png"
alt="image-20220222213201459" />
<figcaption aria-hidden="true">image-20220222213201459</figcaption>
</figure>
<p>下图为根据 ST
板子型号生成项目时默认配置的一些外设引脚。当然，还需要自行设置各个需要使用到的引脚的具体配置，如输入/输出、拉高/拉低等等。</p>
<p><img src="https://pic.islet.space/2022/02/image-20220222213417943.png" alt="image-20220222213417943" style="zoom:33%;" /></p>
<p>下图为根据 ST 芯片信号生成项目时默认不配置任何引脚：</p>
<p><img src="https://pic.islet.space/2022/02/image-20220222213744404.png" alt="image-20220222213744404" style="zoom:33%;" /></p>
<h1 id="debug-records">DEBUG RECORDS</h1>
<h2
id="attempt-to-rename-spec-link-to-already-defined-spec-nano_link">ATTEMPT
TO RENAME SPEC 'LINK' TO ALREADY DEFINED SPEC 'NANO_LINK'</h2>
<p><code>cmake .. ; make</code> 时发现 <code>cmake</code> 无误，而
<code>make</code> 报错，提示
<code>attempt to rename sepc 'link' to already defined spec 'nano_link'</code>。</p>
<figure>
<img src="https://pic.islet.space/2022/02/image-20220222224906371.png"
alt="image-20220222224906371" />
<figcaption aria-hidden="true">image-20220222224906371</figcaption>
</figure>
<p>具体报错信息如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fatal error: &#x2F;Users&#x2F;liewzheng&#x2F;bin&#x2F;gcc-arm-none-eabi-5_4-2016q3&#x2F;bin&#x2F;..&#x2F;lib&#x2F;gcc&#x2F;arm-none-eabi&#x2F;5.4.1&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;arm-none-eabi&#x2F;lib&#x2F;nano.specs: attempt to rename spec &#39;link&#39; to already defined spec &#39;nano_link&#39;</span><br><span class="line">compilation terminated.</span><br><span class="line">make[2]: *** [led_blink.elf] Error 1</span><br><span class="line">make[1]: *** [CMakeFiles&#x2F;led_blink.elf.dir&#x2F;all] Error 2</span><br><span class="line">make: *** [all] Error 2</span><br></pre></td></tr></table></figure>
<p>而 <code>CMakeLists.txt</code> 文件中只有以下此句设计
<code>spec</code> 和 <code>nano</code>
关键字（下方注释是后来加上去的），此配置在 linux
平台上是运行正常的。</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如果提示 linker 相关的错误，请删除  `-specs=nosys.specs` 和 `-specs=nano.specs` 这两个标志及所在临时文件夹并再次 `cmake .. ; make` 进行尝试</span></span><br><span class="line"><span class="keyword">SET</span>(CPU <span class="string">&quot;-mcpu=cortex-m4&quot;</span>)</span><br><span class="line"><span class="keyword">SET</span>(FPU <span class="string">&quot;-mfpu=fpv4-sp-d16&quot;</span>)</span><br><span class="line"><span class="keyword">SET</span>(FLOAT_ABI <span class="string">&quot;-mfloat-abi=hard&quot;</span>)</span><br><span class="line"><span class="keyword">SET</span>(MCU <span class="string">&quot;$&#123;CPU&#125; -mthumb $&#123;FPU&#125; $&#123;FLOAT_ABI&#125;&quot;</span> --specs=nosys.specs -specs=nano.specs)</span><br></pre></td></tr></table></figure>
<h3 id="解决方法">解决方法</h3>
<p>根据 <a
target="_blank" rel="noopener" href="https://community.st.com/s/question/0D50X00009XkWJiSAN/building-error-from-imported-stm32cubemx-project">Building
Error from imported STM32CubeMX project</a> 的解决方法，删除
<code>-specs=nosys.specs</code> 和 <code>-specs=nano.specs</code>
这两个连接器的标志即可编译通过。</p>
<figure>
<img src="https://pic.islet.space/2022/02/image-20220222230947465.png"
alt="image-20220222230947465" />
<figcaption aria-hidden="true">image-20220222230947465</figcaption>
</figure>
<p>删除该两个标志后，<code>MCU</code> 变量为
<code>SET(MCU "$&#123;CPU&#125; -mthumb $&#123;FPU&#125; $&#123;FLOAT_ABI&#125;"</code>。</p>
<h2 id="warning-cannot-find-entry-symbol-arch_paths_first">WARNING:
CANNOT FIND ENTRY SYMBOL ARCH_PATHS_FIRST</h2>
<figure>
<img src="https://pic.islet.space/2022/02/image-20220222235232398.png"
alt="image-20220222235232398" />
<figcaption aria-hidden="true">image-20220222235232398</figcaption>
</figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://islet.space/2022/02/24/Linux/Server/2022-02-24-Jenkins%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liewzheng">
      <meta itemprop="description" content="笔记分享的旮旯孤岛而已">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder的孤岛">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/02/24/Linux/Server/2022-02-24-Jenkins%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2/" class="post-title-link" itemprop="url">Jenkins服务器部署</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">

    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2022-02-24 00:30:00 / Modified: 19:32:16" itemprop="dateCreated datePublished" datetime="2022-02-24T00:30:00+08:00">2022-02-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>本文只涉及 Jenkins 在 Debian Linux (Kali)
下的相关安装，不涉及使用教程，关于Jenkins的相关科普请自行搜。</p>
<h1 id="jenkins安装">Jenkins安装</h1>
<p>Jenkins 可以通过两种方式运行：</p>
<ul>
<li>通过官网下载
<code>http://mirrors.jenkins.io/war-stable/latest/jenkins.war</code>
程序，并确保安装了 <code>openjdk-8</code> 即可。此种方式是直接运行
<code>.war</code> 的软件的，免安装，但基于 <code>ssh</code>
远程连接的用户断开连接之后可能会导致无法运行。即，如果不知道如何正确操作shell以便在后台运行该免安装程序，就不推荐使用。</li>
<li>另一种是安装版本，仍然需要用户提前先安装好 <code>openjdk-8</code>
，然后通过 <a target="_blank" rel="noopener" href="https://pkg.jenkins.io/debian/">官网教程</a>
来添加源和使用 <code>apt</code> 命令进行安装。这种方式可以使用
<code>systemctl</code> 命令确保 Jenkins 开机自启动并在后台运行。</li>
</ul>
<h2 id="java-setup">JAVA SETUP</h2>
<p>需要注意的是，jre有 oracle 版本和 openjdk 版本，需要安装后者。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update ; sudo apt upgrade ; sudo apt install openjdk-8-jre</span><br></pre></td></tr></table></figure>
<p>将 <code>JAVA_HOME</code> 写到你对应的 shell 配置文件中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME&#x3D;&#x2F;usr&#x2F;lib&#x2F;jvm&#x2F;java-1.8.0-openjdk-amd64</span><br><span class="line">export CLASSPATH&#x3D;$JAVA_HOME&#x2F;jre&#x2F;lib&#x2F;rt.jar:$JAVA_HOME&#x2F;lib&#x2F;dt.jar:$JAVA_HOME&#x2F;lib&#x2F;tools.jar</span><br><span class="line">export PATH&#x3D;$JAVA_HOME&#x2F;bin:$PATH</span><br></pre></td></tr></table></figure>
<h2 id="免安装运行">免安装运行</h2>
<p>下面就是使用 <code>java -jar jenkins.war --httpPort=8080</code>
命令来免安装运行的。</p>
<figure>
<img src="https://pic.islet.space/2022/02/image-20220224003818560.png"
alt="image-20220224003818560" />
<figcaption aria-hidden="true">image-20220224003818560</figcaption>
</figure>
<h2 id="安装运行">安装运行</h2>
<p>实际上，直接运行下面的 <code>sudo apt install openjdk-11-jre</code>
可能会导致无法运行，原因不明，还是推荐自行使用
<code>sudo apt install openjdk-8-jre</code> 进行安装。</p>
<figure>
<img src="https://pic.islet.space/2022/02/image-20220224191828341.png"
alt="image-20220224191828341" />
<figcaption aria-hidden="true">image-20220224191828341</figcaption>
</figure>
<h2 id="防火墙配置">防火墙配置</h2>
<p>这一点就不再赘述了。</p>
<ol type="1">
<li><strong>开启系统内端口</strong>：用 <code>iptables</code> 参考 《<a
href="https://islet.space/2019/03/05/Linux/SSH/CentOS7%E5%AE%89%E8%A3%85iptables%E9%98%B2%E7%81%AB%E5%A2%99/">CentOS7安装iptables防火墙</a>》，注意看后面评论内容。</li>
<li><strong>开启控制台端口</strong>：配置为云服务器的要去网页界面的控制台将对应端口打开。</li>
</ol>
<h1 id="jenkins配置">Jenkins配置</h1>
<p>安装完毕之后，在浏览器中输入 对应网址的 <code>8080</code>
端口，进入页面后输入管理员密码。</p>
<figure>
<img src="https://pic.islet.space/2022/02/image-20220224003852043.png"
alt="image-20220224003852043" />
<figcaption aria-hidden="true">image-20220224003852043</figcaption>
</figure>
<p>选择新手入门配置安装插件。</p>
<figure>
<img src="https://pic.islet.space/2022/02/image-20220224003716199.png"
alt="image-20220224003716199" />
<figcaption aria-hidden="true">image-20220224003716199</figcaption>
</figure>
<p>安装完毕之后就会让你设置管理员账户。</p>
<p>虽然，java11是推荐安装，可我就是运行失败。</p>
<figure>
<img src="https://pic.islet.space/2022/02/image-20220224004120934.png"
alt="image-20220224004120934" />
<figcaption aria-hidden="true">image-20220224004120934</figcaption>
</figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://islet.space/2022/02/23/Linux/2022-02-23-%E8%87%AA%E5%BB%BAgit%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liewzheng">
      <meta itemprop="description" content="笔记分享的旮旯孤岛而已">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder的孤岛">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/02/23/Linux/2022-02-23-%E8%87%AA%E5%BB%BAgit%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93/" class="post-title-link" itemprop="url">自建git远程仓库</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">

    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2022-02-23 01:45:00 / Modified: 21:18:15" itemprop="dateCreated datePublished" datetime="2022-02-23T01:45:00+08:00">2022-02-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>基本上也就只参考了廖雪峰这篇 《 <a
target="_blank" rel="noopener" href="https://www.liaoxuefeng.com/wiki/896043488029600/899998870925664">搭建Git服务器</a>
》 的文章。</p>
<h1 id="部署git服务器">部署git服务器</h1>
<h2 id="确保已安装git">确保已安装git</h2>
<p>for debian linux:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install git </span><br></pre></td></tr></table></figure>
<p>and check the version of it:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git --version</span><br></pre></td></tr></table></figure>
<h2 id="创建git账户">创建git账户</h2>
<p>Add a account name <code>git</code> in linux :</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo adduser git</span><br></pre></td></tr></table></figure>
<h2 id="设置使用者的ssh配置">设置使用者的SSH配置</h2>
<p>Copy the SSH keys of your client computers to save to the file in
<code>/home/git/.ssh/authorized_keys</code> .</p>
<h2 id="禁用shell登录">禁用shell登录</h2>
<p>For the safety of your server, you should ban the shell login for
<code>git</code> account.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/passwd</span><br></pre></td></tr></table></figure>
<p>Find something like
<code>git:x:1001:1001:,,,:/home/git:/bin/bash</code> , and modify it
to:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git:x:1001:1001:,,,:/home/git:/usr/bin/git-shell</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>git</code>用户可以正常通过ssh使用git，但无法登录shell，因为已经为<code>git</code>用户指定的<code>git-shell</code>每次一登录就自动退出。</p>
</blockquote>
<h1 id="新建仓库">新建仓库</h1>
<ul>
<li>Build a directory named <code>srv</code> to store the repositories.
(Of course you can name it the way you like.)</li>
<li>Initializa a new bare repository name <code>xxx</code>.</li>
<li>Change its owner as the user <code>git</code> which is just created
before.</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /srv/</span><br><span class="line">sudo git init --bare /srv/xxxx.git</span><br><span class="line">sudo chown -R git:git /srv/xxxx.git</span><br></pre></td></tr></table></figure>
<p>And you can copy the script below TO CREATE YOUR NEW REPOSITY.
Remember to save it as <code>.sh</code> file and use
<code>chmod +x</code> command to make it executable.</p>
<blockquote>
<p>By default, this script is stored as <code>gitInit.sh</code> in the
diretory <code>/srv</code>.</p>
<p>If you change the script execute diretory, remember to modify the
script below.</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GIT_REPOSITORY=<span class="variable">$1</span></span><br><span class="line">sudo git init --bare <span class="variable">$GIT_REPOSITORY</span>.git</span><br><span class="line">sudo chown -R git:git <span class="variable">$GIT_REPOSITORY</span>.git</span><br></pre></td></tr></table></figure>
<p>USAGE:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./gitInit.sh &lt;newRepository&gt;</span><br></pre></td></tr></table></figure>
<h1 id="使用仓库">使用仓库</h1>
<p>到这一步为止，已经可以使用
<code>git pull git@&lt;yourServer&gt;:/srv/xxx.git</code>
进行仓库拉取了。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> git@&lt;yourServer&gt;:/srv/sample.git</span><br></pre></td></tr></table></figure>
<p>And you will see:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Cloning into <span class="string">&#x27;sample&#x27;</span>...</span><br><span class="line">warning: You appear to have cloned an empty repository.</span><br></pre></td></tr></table></figure>
<p>如果需要添加一个固定的远程仓库，需要使用到 <code>url</code>
，即需要开启了 <code>443</code> 端口的服务器。</p>
<h1 id="其他服务器管理">其他服务器管理</h1>
<h2 id="证书颁发">证书颁发</h2>
<p>如下所示，下面的子域名已经签审了 SSL 证书了，可以正常使用
<code>443</code> 端口不被拒绝。</p>
<figure>
<img src="https://pic.islet.space/2022/02/image-20220223015715136.png"
alt="image-20220223015715136" />
<figcaption aria-hidden="true">image-20220223015715136</figcaption>
</figure>
<h2 id="防火墙设置">防火墙设置</h2>
<p>确保腾讯云服务器管理页面下的防火墙设置中已开启 <code>443</code>
端口。</p>
<figure>
<img src="https://pic.islet.space/2022/02/image-20220223015852398.png"
alt="image-20220223015852398" />
<figcaption aria-hidden="true">image-20220223015852398</figcaption>
</figure>
<p>使用 ubuntu 和 centos 系统的可以参考 《<a
href="https://islet.space/2019/03/05/Linux/SSH/CentOS7%E5%AE%89%E8%A3%85iptables%E9%98%B2%E7%81%AB%E5%A2%99/#%E4%B8%89-%E8%AE%BE%E7%BD%AE%E7%8E%B0%E6%9C%89%E8%A7%84%E5%88%99">CentOS7安装iptables防火墙</a>》
开启 <code>443</code> 端口，直接运行下面命令即可：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo iptables -A INPUT -p tcp --dport 443 -j ACCEPT</span><br></pre></td></tr></table></figure>
<h2 id="克隆远程仓库">克隆远程仓库</h2>
<p>如果本地已有仓库，可能会与远程服务器的 <code>master</code>
分支冲突，需要自行使用 <code>git fetch</code> 管理，然后使用
<code>git push --set-upstream master</code> 进行上传。</p>
<figure>
<img src="https://pic.islet.space/2022/02/image-20220223014741138.png"
alt="image-20220223014741138" />
<figcaption aria-hidden="true">image-20220223014741138</figcaption>
</figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://islet.space/2022/02/22/Macintosh/2022-02-22-%E6%9B%B4%E6%94%B9mac%E7%9A%84%E9%BB%98%E8%AE%A4shell%E4%B8%BAfish/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liewzheng">
      <meta itemprop="description" content="笔记分享的旮旯孤岛而已">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder的孤岛">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/02/22/Macintosh/2022-02-22-%E6%9B%B4%E6%94%B9mac%E7%9A%84%E9%BB%98%E8%AE%A4shell%E4%B8%BAfish/" class="post-title-link" itemprop="url">更改Mac的默认shell为fish</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">

    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-02-22 20:50:00" itemprop="dateCreated datePublished" datetime="2022-02-22T20:50:00+08:00">2022-02-22</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2022-02-23 00:17:11" itemprop="dateModified" datetime="2022-02-23T00:17:11+08:00">2022-02-23</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Macintosh/" itemprop="url" rel="index"><span itemprop="name">Macintosh</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Mac 平台自带的 zsh 真的极不好用，同样是 unix-like 平台，跟 kali
平台上的 zsh 体验相差甚远。
一直都是黑白配色，而且修改中断和配置的动手能力确实没有那么强。偶然适用了一下
<code>fish</code> ，发现在 Mac
平台使用效果挺好的，就决定进行更换。切换成黑色背景后更为舒适了，之前一直使用瞎眼的白色。</p>
<figure>
<img src="https://pic.islet.space/2022/02/image-20220223001619177.png"
alt="image-20220223001619177" />
<figcaption aria-hidden="true">image-20220223001619177</figcaption>
</figure>
<h1 id="fish-setup">FISH SETUP</h1>
<p>我安装了 MacPorts 包管理工具，直接用 <code>port</code> 命令即可安装
<code>fish</code> 。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo port install fish</span><br></pre></td></tr></table></figure>
<h1 id="add-fish-to-etcshells">ADD FISH TO /etc/shells</h1>
<p>使用 <code>which fish</code> 可以调出 <code>fish</code>
的安装路径（用 <code>port</code> 安装的话默认路径是
<code>/opt/local/bin/fish</code> ），复制该路径，然后粘贴到
<code>/etc/shells</code> 文件末尾。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/shells</span><br></pre></td></tr></table></figure>
<p><strong>NOTE</strong>：千万不要用 <code>sudo vim /etc/shells</code>
这样会修改到 <code>root</code> 管理员角色的 shell
（如果出问题就会很麻烦），用户自己折腾自己的 shell 就好了。</p>
<p>通过 <code>cat /etc/shells</code> 可以查看所有可供使用的 shell 。</p>
<h1 id="change-default-shell">CHANGE DEFAULT SHELL</h1>
<p>使用 <code>chsh</code> 语句即可将 <code>fish</code> 设置为默认 shell
。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chsh -s /opt/<span class="built_in">local</span>/bin/fish</span><br></pre></td></tr></table></figure>
<h1 id="note">NOTE</h1>
<p><code>fish</code> 所使用的配置文件并非 <code>~/.fish</code> 而是
<code>~/.bash_profile</code> ，在里面修改完内容可以 <code>source</code>
该文件进行立即更新。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>


</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">粤ICP备19004822号 </a>
  </div>

<div class="copyright">
  &copy; 2019 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">liewzheng</span>
</div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>


  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdn.jsdelivr.net/npm/mermaid@8.12.0/dist/mermaid.min.js","integrity":"sha256-0dD7vUjUCTGJjeLnPotQQJIcSzug5fO6WDMYYyNIX4c="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>


  <script src="/js/third-party/pace.js"></script>

  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":"enable","tags":"all","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
